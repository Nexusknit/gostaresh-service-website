import{b as C,j as l,aM as h,k as i,o as r,C as m,l as c,y as f,s as g,D as v,A as b,ak as A,aj as $}from"./vp8MPyNN.js";const N={class:"space-y-2"},j={key:0,class:"flex items-center gap-3"},U=["src"],B={class:"flex items-center gap-3"},D={key:1,class:"text-xs text-rose-600"},I=C({__name:"AdminImageUploader",props:{modelValue:{},scope:{}},emits:["update:modelValue"],setup(o,{emit:y}){const _=o,k=y,u=l(null),s=l(!1),n=l(null);function w(){u.value?.click()}function V(a){if(!a)return"";const e=A().public.apiOrigin||(typeof window<"u"?window.location.origin:"");return`${String(e).replace(/\/$/,"")}/uploads/${a.replace(/^\/+/,"")}`}async function x(a){const t=a.target?.files?.[0];if(t){s.value=!0,n.value=null;try{const e=new FormData;e.append("scope",_.scope),e.append("file",t);const{$apiFetch:d}=$(),p=await d("files/upload",{method:"POST",body:e});if(!p?.path)throw new Error("آپلود ناموفق بود");k("update:modelValue",p.path),a.target.value=""}catch(e){n.value=e?.data?.message||e?.message||"خطای آپلود"}finally{s.value=!1}}}return(a,t)=>{const e=h("n-button");return r(),i("div",N,[o.modelValue?(r(),i("div",j,[c("img",{src:V(o.modelValue),alt:"",class:"h-14 w-14 rounded-lg object-cover ring-1 ring-slate-200"},null,8,U),f(e,{size:"small",tertiary:"",type:"warning",onClick:t[0]||(t[0]=d=>a.$emit("update:modelValue",""))},{default:g(()=>[...t[1]||(t[1]=[v("حذف تصویر",-1)])]),_:1})])):m("",!0),c("div",B,[c("input",{ref_key:"inp",ref:u,type:"file",accept:"image/*",onChange:x},null,544),f(e,{loading:s.value,size:"small",onClick:w},{default:g(()=>[...t[2]||(t[2]=[v("انتخاب",-1)])]),_:1},8,["loading"])]),n.value?(r(),i("div",D,b(n.value),1)):m("",!0)])}}}),S=Object.assign(I,{__name:"AdminImageUploader"});export{S as A};
