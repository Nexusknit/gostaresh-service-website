import V from"./QLnPFQ3u.js";import{_ as j}from"./Bno8S_cx.js";import{c as E,a as T}from"./DWH2qXdP.js";import{u as L}from"./wRpwCGT5.js";import{b as M,j as n,g as r,H as $,k as q,l as o,y as u,q as G,C as H,s as x,B as _,A as I,h as y,W as c,o as h,D as g,as as P}from"./vp8MPyNN.js";import{u as S}from"./ybW-YjLz.js";import{N as W}from"./BdE0Vslz.js";import"./mYRyJGGe.js";import"./Bw_fySTz.js";import"./DTlRyxep.js";import"./mfReoYN0.js";import"./uD4T5QrJ.js";import"./CXuCsgek.js";import"./Bk_rJcZu.js";const F={class:"container mx-auto px-4 py-8",dir:"rtl"},J={class:"mb-5 flex items-center justify-between gap-3"},K={class:"mt-4 flex items-center justify-between"},O={class:"text-sm text-slate-600"},Q={class:"flex items-center gap-2"},ce=M({__name:"index",setup(R){const{hasPerm:m}=L(),k=S(),a=n(10),s=n(0),d=n([]),i=n(0),f=n(!1),C=r(()=>m("user.create")),p=r(()=>m("user.update")),v=r(()=>m("user.delete"));async function b(){f.value=!0;try{const t=await T("/users",{params:{limit:a.value,offset:s.value}});d.value=Array.isArray(t?.items)?t.items:[],i.value=typeof t?.total=="number"?t.total:d.value.length}finally{f.value=!1}}function N(){s.value=Math.max(0,s.value-a.value)}function w(){s.value+a.value<i.value&&(s.value+=a.value)}$([a,s],b,{immediate:!0});function A(t){p.value&&P(`/admin/users/${t.id}`)}async function B(t){if(v.value&&confirm("حذف کاربر؟"))try{await E(`/users/${t.id}`),k.success("حذف شد"),b()}catch(e){k.error(e?.data?.message||"حذف انجام نشد")}}const D=r(()=>{const t=[{title:"نام",key:"firstName"},{title:"نام خانوادگی",key:"lastName"},{title:"نام کاربری",key:"userName"},{title:"ایمیل",key:"email"},{title:"وضعیت",key:"isActive",render:e=>e.isActive?"فعال":"غیرفعال"}];return(p.value||v.value)&&t.push({title:"اقدامات",key:"actions",render(e){const l=[];return p.value&&l.push(y(c,{size:"small",onClick:()=>A(e)},{default:()=>"ویرایش"})),v.value&&l.push(y(c,{size:"small",type:"error",secondary:!0,onClick:()=>B(e)},{default:()=>"حذف"})),l.length?y("div",{class:"flex items-center gap-2"},l):null}}),t});return(t,e)=>{const l=V,z=j;return h(),q("section",F,[o("div",J,[e[1]||(e[1]=o("h1",{class:"text-xl font-bold"},"کاربران",-1)),C.value?(h(),G(z,{key:0,to:"/admin/users/create",class:"inline-flex items-center gap-2 rounded-xl bg-sky-600 text-white px-3 py-2 text-sm"},{default:x(()=>[u(l,{name:"ph:plus"}),e[0]||(e[0]=g(" افزودن کاربر ",-1))]),_:1})):H("",!0)]),u(_(W),{columns:D.value,data:d.value,loading:f.value,bordered:!1,class:"rounded-2xl ring-1 ring-slate-200 overflow-hidden"},null,8,["columns","data","loading"]),o("div",K,[o("div",O,"تعداد کل: "+I(i.value),1),o("div",Q,[u(_(c),{size:"small",disabled:s.value===0,onClick:N},{default:x(()=>[...e[2]||(e[2]=[g("قبلی",-1)])]),_:1},8,["disabled"]),u(_(c),{size:"small",disabled:s.value+a.value>=i.value,onClick:w},{default:x(()=>[...e[3]||(e[3]=[g("بعدی",-1)])]),_:1},8,["disabled"])])])])}}});export{ce as default};
