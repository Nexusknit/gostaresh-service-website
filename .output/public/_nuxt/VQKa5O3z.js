import{_ as N}from"./Bno8S_cx.js";import{a as _,d as w}from"./DWH2qXdP.js";import{b as h,j as r,G as T,g as I,k,l as d,y as l,s,B as a,o as D,D as c,W as B,N as U,as as A}from"./vp8MPyNN.js";import{u as S}from"./ybW-YjLz.js";import{N as F,a as u}from"./DToeYN_d.js";import{N as i}from"./Bw_fySTz.js";import{N as V}from"./uD4T5QrJ.js";import{N as j}from"./r23Yv2v_.js";import"./CXuCsgek.js";const G={class:"container mx-auto px-4 py-8",dir:"rtl"},M={class:"mb-5 flex items-center justify-between gap-3"},O={class:"pt-2"},K=h({__name:"create",setup(P){const p=S(),m=r(null),e=r({title:"",slug:"",articleTypeID:"",shortContent:"",longContent:"",isActive:!0}),v=r(!1),f=r([]);T(async()=>{try{f.value=await _("articles/types")}catch{}});const g=I(()=>f.value.map(n=>({label:n.name||n.id,value:n.id}))),y={title:{required:!0,message:"عنوان الزامی است",trigger:"blur"}};async function b(){if(!(!e.value.title||e.value.slug))try{const{slug:n}=await $apiFetch("/utils/slug/preview",{method:"POST",body:{model:"article",source:e.value.title}});n&&(e.value.slug=n)}catch{}}async function x(){try{await m.value?.validate()}catch{return}v.value=!0;try{await w("articles",{title:e.value.title,articleTypeID:e.value.articleTypeID||void 0,shortContent:e.value.shortContent||void 0,longContent:e.value.longContent||void 0,slug:e.value.slug||void 0,isActive:e.value.isActive}),p.success("مقاله افزوده شد"),A("/admin/articles")}catch(n){p.error(n?.data?.message||"خطا در ثبت")}finally{v.value=!1}}return(n,t)=>{const C=N;return D(),k("section",G,[d("div",M,[t[7]||(t[7]=d("h1",{class:"text-xl font-bold"},"افزودن مقاله",-1)),l(C,{to:"/admin/articles",class:"text-sky-600 hover:underline text-sm"},{default:s(()=>[...t[6]||(t[6]=[c("بازگشت",-1)])]),_:1})]),l(a(U),{class:"rounded-2xl ring-1 ring-slate-200/80 shadow-sm",bordered:!1},{default:s(()=>[l(a(F),{model:e.value,rules:y,ref_key:"formRef",ref:m,"label-placement":"left","label-width":"140"},{default:s(()=>[l(a(u),{label:"عنوان",path:"title"},{default:s(()=>[l(a(i),{value:e.value.title,"onUpdate:value":t[0]||(t[0]=o=>e.value.title=o),onBlur:b},null,8,["value"])]),_:1}),l(a(u),{label:"اسلاگ",path:"slug"},{default:s(()=>[l(a(i),{value:e.value.slug,"onUpdate:value":t[1]||(t[1]=o=>e.value.slug=o)},null,8,["value"])]),_:1}),l(a(u),{label:"نوع",path:"articleTypeID"},{default:s(()=>[l(a(V),{value:e.value.articleTypeID,"onUpdate:value":t[2]||(t[2]=o=>e.value.articleTypeID=o),options:g.value,filterable:"",clearable:""},null,8,["value","options"])]),_:1}),l(a(u),{label:"خلاصه",path:"shortContent"},{default:s(()=>[l(a(i),{value:e.value.shortContent,"onUpdate:value":t[3]||(t[3]=o=>e.value.shortContent=o),type:"textarea"},null,8,["value"])]),_:1}),l(a(u),{label:"متن کامل",path:"longContent"},{default:s(()=>[l(a(i),{value:e.value.longContent,"onUpdate:value":t[4]||(t[4]=o=>e.value.longContent=o),type:"textarea"},null,8,["value"])]),_:1}),l(a(u),{label:"فعال"},{default:s(()=>[l(a(j),{value:e.value.isActive,"onUpdate:value":t[5]||(t[5]=o=>e.value.isActive=o)},null,8,["value"])]),_:1}),d("div",O,[l(a(B),{type:"primary",loading:v.value,onClick:x},{default:s(()=>[...t[8]||(t[8]=[c("ثبت",-1)])]),_:1},8,["loading"])])]),_:1},8,["model"])]),_:1})])}}});export{K as default};
