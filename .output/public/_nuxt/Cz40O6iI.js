import{_ as h}from"./Bno8S_cx.js";import{b as B,S as U,j as m,G as V,k as C,l as i,y as t,s,B as l,o as j,D as c,W as b,A as D,N as I,as as y}from"./vp8MPyNN.js";import{A as F}from"./DKL51_I7.js";import{a as R,u as T,b as $,c as G}from"./DWH2qXdP.js";import{N as M}from"./r23Yv2v_.js";import{u as O}from"./ybW-YjLz.js";import{N as P,a as r}from"./DToeYN_d.js";import{N as p}from"./Bw_fySTz.js";const q={class:"container mx-auto px-4 py-8",dir:"rtl"},E={class:"mb-5 flex items-center justify-between gap-3"},L={class:"flex items-center justify-between"},W={class:"text-slate-700"},z={class:"pt-2"},te=B({__name:"[id]",setup(H){const x=U(),d=String(x.params.id),u=O(),g=m(null),e=m({name:"",slug:"",description:"",image:"",isActive:!0}),v=m(!1),f=m(!1),_={name:{required:!0,message:"نام الزامی است",trigger:"blur"}};V(N);async function N(){try{const n=await R(`/brands/${d}`);Object.assign(e.value,n||{})}catch{u.error("خواندن اطلاعات ناموفق بود")}}async function w(){if(!(!e.value.name||e.value.slug))try{const{slug:n}=await T()("utils/slug/preview",{method:"POST",body:{model:"brand",source:e.value.name,excludeId:d}});n&&(e.value.slug=n)}catch{}}async function A(){try{await g.value?.validate()}catch{return}v.value=!0;try{await $(`/brands/${d}`,{name:e.value.name,description:e.value.description||void 0,image:e.value.image||void 0,slug:e.value.slug||void 0,isActive:e.value.isActive}),u.success("ذخیره شد"),y("/admin/brands")}catch(n){u.error(n?.data?.message||"خطا در ذخیره")}finally{v.value=!1}}async function k(){if(confirm("حذف برند?")){f.value=!0;try{await G(`/brands/${d}`),u.success("حذف شد"),y("/admin/brands")}catch(n){u.error(n?.data?.message||"خطا در حذف")}finally{f.value=!1}}}return(n,a)=>{const S=h;return j(),C("section",q,[i("div",E,[a[6]||(a[6]=i("h1",{class:"text-xl font-bold"},"ویرایش برند",-1)),t(S,{to:"/admin/brands",class:"text-sky-600 hover:underline text-sm"},{default:s(()=>[...a[5]||(a[5]=[c("بازگشت",-1)])]),_:1})]),t(l(I),{class:"rounded-2xl ring-1 ring-slate-200/80 shadow-sm",bordered:!1},{header:s(()=>[i("div",L,[i("div",W,D(e.value.name||"—"),1),t(l(b),{type:"error",secondary:"",onClick:k,loading:f.value},{default:s(()=>[...a[7]||(a[7]=[c("حذف",-1)])]),_:1},8,["loading"])])]),default:s(()=>[t(l(P),{model:e.value,rules:_,ref_key:"formRef",ref:g,"label-placement":"left","label-width":"120"},{default:s(()=>[t(l(r),{label:"نام",path:"name"},{default:s(()=>[t(l(p),{value:e.value.name,"onUpdate:value":a[0]||(a[0]=o=>e.value.name=o),onBlur:w},null,8,["value"])]),_:1}),t(l(r),{label:"اسلاگ",path:"slug"},{default:s(()=>[t(l(p),{value:e.value.slug,"onUpdate:value":a[1]||(a[1]=o=>e.value.slug=o)},null,8,["value"])]),_:1}),t(l(r),{label:"توضیحات",path:"description"},{default:s(()=>[t(l(p),{value:e.value.description,"onUpdate:value":a[2]||(a[2]=o=>e.value.description=o),type:"textarea"},null,8,["value"])]),_:1}),t(l(r),{label:"تصویر",path:"image"},{default:s(()=>[t(F,{modelValue:e.value.image,"onUpdate:modelValue":a[3]||(a[3]=o=>e.value.image=o),scope:"brands"},null,8,["modelValue"])]),_:1}),t(l(r),{label:"فعال"},{default:s(()=>[t(l(M),{value:e.value.isActive,"onUpdate:value":a[4]||(a[4]=o=>e.value.isActive=o)},null,8,["value"])]),_:1}),i("div",z,[t(l(b),{type:"primary",loading:v.value,onClick:A},{default:s(()=>[...a[8]||(a[8]=[c("ذخیره",-1)])]),_:1},8,["loading"])])]),_:1},8,["model"])]),_:1})])}}});export{te as default};
