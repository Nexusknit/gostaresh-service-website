import{co as o,cp as l,au as y}from"./vp8MPyNN.js";import{u}from"./wRpwCGT5.js";import"./mYRyJGGe.js";function d(a){return Array.isArray(a)?{any:[],all:a}:{any:Array.isArray(a?.any)?a.any:[],all:Array.isArray(a?.all)?a.all:[]}}const m=o(a=>{const r=a.meta?.permissions;if(!r||Array.isArray(r)&&r.length===0)return;const{hasAll:n,hasAny:e}=u(),{any:t,all:i}=d(r);let s=!0;if(i.length&&(s=n(i)),s&&t.length&&(s=e(t)),!s)return l(y({statusCode:403,statusMessage:"Forbidden",data:{reason:"missing-permission",required:r}}))});export{m as default};
