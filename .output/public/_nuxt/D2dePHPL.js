import K from"./QLnPFQ3u.js";import{_ as Q}from"./Bno8S_cx.js";import{a as b,c as R}from"./DWH2qXdP.js";import{b as X,j as a,g as x,H as Y,k as Z,l as d,y as s,s as r,B as i,A as ee,h as N,W as _,o as te,D as c,N as ae,as as se}from"./vp8MPyNN.js";import{u as le}from"./CJvN12oy.js";import{N as oe}from"./Bw_fySTz.js";import{N as D}from"./uD4T5QrJ.js";import{N as ne}from"./r23Yv2v_.js";import{N as ie}from"./BdE0Vslz.js";import"./CXuCsgek.js";import"./DTlRyxep.js";import"./mfReoYN0.js";import"./Bk_rJcZu.js";const re={class:"container mx-auto px-4 py-8",dir:"rtl"},ue={class:"mb-5 flex items-center justify-between gap-3"},de={class:"flex flex-wrap items-center gap-3"},ce={class:"mt-4 flex items-center justify-between"},ve={class:"text-sm text-slate-600"},me={class:"flex items-center gap-2"},Se=X({__name:"index",setup(pe){const v=a(""),m=a(null),p=a(null),f=a(null),y=a(!1),u=a(10),o=a(0),k=a([]),g=a(0),w=a(!1),h=a([]),C=a([]),I=a([]),z=le(async()=>{w.value=!0;try{const e=await b("/products",{params:{q:v.value||void 0,brandID:m.value||void 0,categoryID:p.value||void 0,statusID:f.value||void 0,isActive:y.value?!0:void 0,limit:u.value,offset:o.value}});k.value=Array.isArray(e?.items)?e.items:[],g.value=typeof e?.total=="number"?e.total:k.value.length}catch{}finally{w.value=!1}},200);async function B(){try{const[e,t,n]=await Promise.all([b("/brands",{params:{limit:100,offset:0}}),b("/categories",{params:{limit:100,offset:0}}),b("/product-statuses")]);h.value=Array.isArray(e?.items)?e.items:[],C.value=Array.isArray(t?.items)?t.items:[],I.value=Array.isArray(n)?n:Array.isArray(n?.items)?n.items:[]}catch{}}const S=x(()=>h.value.map(e=>({label:e.name||e.slug||e.id,value:e.id}))),U=x(()=>C.value.map(e=>({label:e.name||e.slug||e.id,value:e.id}))),q=x(()=>I.value.map(e=>({label:e.name||e.title||e.id||String(e),value:e.id||e.value||String(e)})));function j(){o.value=Math.max(0,o.value-u.value)}function O(){o.value+u.value<g.value&&(o.value+=u.value)}Y([v,m,p,f,y,u,o],(e,t)=>{if(t){const[n,A,l,L,V,$,fe]=t,[G,H,M,P,W,J,ye]=e;if((G!==n||H!==A||M!==l||P!==L||W!==V||J!==$)&&o.value!==0){o.value=0;return}}z()},{immediate:!0}),B();function T(e){se(`/admin/products/${e.id}`)}async function E(e){confirm("حذف محصول؟")&&(await R(`/products/${e.id}`),z())}const F=x(()=>[{title:"نام",key:"name"},{title:"اسلاگ",key:"slug"},{title:"قیمت",key:"price"},{title:"فعال",key:"isActive",render:e=>e.isActive?"بله":"خیر"},{title:"عملیات",key:"actions",render(e){return N("div",{class:"flex items-center gap-2"},[N(_,{size:"small",onClick:()=>T(e)},{default:()=>"ویرایش"}),N(_,{size:"small",type:"error",secondary:!0,onClick:()=>E(e)},{default:()=>"حذف"})])}}]);return(e,t)=>{const n=K,A=Q;return te(),Z("section",re,[d("div",ue,[t[6]||(t[6]=d("h1",{class:"text-xl font-bold"},"محصولات",-1)),s(A,{to:"/admin/products/create",class:"inline-flex items-center gap-2 rounded-xl bg-sky-600 text-white px-3 py-2 text-sm"},{default:r(()=>[s(n,{name:"ph:plus"}),t[5]||(t[5]=c(" افزودن محصول ",-1))]),_:1})]),s(i(ae),{class:"rounded-2xl ring-1 ring-slate-200/80 shadow-sm mb-4",bordered:!1},{default:r(()=>[d("div",de,[s(i(oe),{value:v.value,"onUpdate:value":t[0]||(t[0]=l=>v.value=l),placeholder:"جستجو...",class:"w-64",clearable:"",size:"large"},{prefix:r(()=>[s(n,{name:"ph:magnifying-glass-duotone"})]),_:1},8,["value"]),s(i(D),{value:m.value,"onUpdate:value":t[1]||(t[1]=l=>m.value=l),options:S.value,placeholder:"برند",class:"w-52",clearable:""},null,8,["value","options"]),s(i(D),{value:p.value,"onUpdate:value":t[2]||(t[2]=l=>p.value=l),options:U.value,placeholder:"دسته‌بندی",class:"w-52",clearable:""},null,8,["value","options"]),s(i(D),{value:f.value,"onUpdate:value":t[3]||(t[3]=l=>f.value=l),options:q.value,placeholder:"وضعیت",class:"w-52",clearable:""},null,8,["value","options"]),s(i(ne),{value:y.value,"onUpdate:value":t[4]||(t[4]=l=>y.value=l)},{checked:r(()=>[...t[7]||(t[7]=[c("فقط فعال",-1)])]),unchecked:r(()=>[...t[8]||(t[8]=[c("همه",-1)])]),_:1},8,["value"])])]),_:1}),s(i(ie),{columns:F.value,data:k.value,loading:w.value,bordered:!1,class:"rounded-2xl ring-1 ring-slate-200 overflow-hidden"},null,8,["columns","data","loading"]),d("div",ce,[d("div",ve,"مجموع: "+ee(g.value),1),d("div",me,[s(i(_),{size:"small",disabled:o.value===0,onClick:j},{default:r(()=>[...t[9]||(t[9]=[c("قبلی",-1)])]),_:1},8,["disabled"]),s(i(_),{size:"small",disabled:o.value+u.value>=g.value,onClick:O},{default:r(()=>[...t[10]||(t[10]=[c("بعدی",-1)])]),_:1},8,["disabled"])])])])}}});export{Se as default};
