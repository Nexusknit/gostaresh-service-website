import L from"./QLnPFQ3u.js";import{_ as U}from"./Bno8S_cx.js";import{c as V,a as q}from"./DWH2qXdP.js";import{b as E,j as i,H as R,g as S,k as T,l as r,y as l,q as $,C as I,B as u,s as m,A as M,h as p,W as g,ak as G,o as k,D as _,N as H,as as P}from"./vp8MPyNN.js";import{u as W}from"./wRpwCGT5.js";import{u as F}from"./ybW-YjLz.js";import{N as J}from"./Bw_fySTz.js";import{N as K}from"./BdE0Vslz.js";import"./mYRyJGGe.js";import"./DTlRyxep.js";import"./mfReoYN0.js";import"./uD4T5QrJ.js";import"./CXuCsgek.js";import"./Bk_rJcZu.js";const O={class:"container mx-auto px-4 py-8",dir:"rtl"},Q={class:"mb-5 flex items-center justify-between gap-3"},X={class:"flex flex-wrap items-center gap-3"},Y={class:"mt-4 flex items-center justify-between"},Z={class:"text-sm text-slate-600"},ee={class:"flex items-center gap-2"},ge=E({__name:"index",setup(te){const y=F(),{hasPerm:d}=W(),f=i(""),o=i(10),s=i(0),x=i([]),v=i(0),b=i(!1);async function h(){b.value=!0;try{const t=await q("/brands",{params:{q:f.value||void 0,limit:o.value,offset:s.value}});x.value=Array.isArray(t?.items)?t.items:[],v.value=typeof t?.total=="number"?t.total:x.value.length}finally{b.value=!1}}function w(){s.value=Math.max(0,s.value-o.value)}function C(){s.value+o.value<v.value&&(s.value+=o.value)}R([f,o,s],h,{immediate:!0});function N(t){d("brand.update")&&P(`/admin/brands/${t.id}`)}async function B(t){if(d("brand.delete"))try{await V(`/brands/${t.id}`),y.success("حذف شد"),h()}catch(e){y.error(e?.data?.message||"حذف انجام نشد")}}const A=S(()=>{const t=d("brand.update"),e=d("brand.delete"),c=[{title:"نام",key:"name"},{title:"نامک",key:"slug"},{title:"تصویر",key:"image",render(a){if(!a.image)return p("span",{class:"text-slate-400"},"-");const n=G().public?.apiBase||"/api/v1",D=typeof window<"u"?window.location.origin:"",z=new URL(n,D),j=new URL(`/uploads/${String(a.image).replace(/^\/+/,"")}`,z).toString();return p("img",{src:j,class:"h-10 w-10 object-cover rounded-lg ring-1 ring-slate-200"})}},{title:"وضعیت",key:"isActive",render:a=>a.isActive?"فعال":"غیرفعال"}];return(t||e)&&c.push({title:"اقدامات",key:"actions",render(a){const n=[];return t&&n.push(p(g,{size:"small",onClick:()=>N(a)},{default:()=>"ویرایش"})),e&&n.push(p(g,{size:"small",type:"error",secondary:!0,onClick:()=>B(a)},{default:()=>"حذف"})),n.length?p("div",{class:"flex items-center gap-2"},n):null}}),c});return(t,e)=>{const c=L,a=U;return k(),T("section",O,[r("div",Q,[e[2]||(e[2]=r("h1",{class:"text-xl font-bold"},"برندها",-1)),u(d)("brand.create")?(k(),$(a,{key:0,to:"/admin/brands/create",class:"inline-flex items-center gap-2 rounded-xl bg-sky-600 text-white px-3 py-2 text-sm"},{default:m(()=>[l(c,{name:"ph:plus"}),e[1]||(e[1]=_(" افزودن برند ",-1))]),_:1})):I("",!0)]),l(u(H),{class:"rounded-2xl ring-1 ring-slate-200/80 shadow-sm mb-4",bordered:!1},{default:m(()=>[r("div",X,[l(u(J),{value:f.value,"onUpdate:value":e[0]||(e[0]=n=>f.value=n),placeholder:"جستجو...",class:"w-64",clearable:"",size:"large"},{prefix:m(()=>[l(c,{name:"ph:magnifying-glass-duotone"})]),_:1},8,["value"])])]),_:1}),l(u(K),{columns:A.value,data:x.value,loading:b.value,bordered:!1,class:"rounded-2xl ring-1 ring-slate-200 overflow-hidden"},null,8,["columns","data","loading"]),r("div",Y,[r("div",Z,"تعداد کل: "+M(v.value),1),r("div",ee,[l(u(g),{size:"small",disabled:s.value===0,onClick:w},{default:m(()=>[...e[3]||(e[3]=[_("قبلی",-1)])]),_:1},8,["disabled"]),l(u(g),{size:"small",disabled:s.value+o.value>=v.value,onClick:C},{default:m(()=>[...e[4]||(e[4]=[_("بعدی",-1)])]),_:1},8,["disabled"])])])])}}});export{ge as default};
