import{_ as C}from"./Bno8S_cx.js";import{a as p}from"./DWH2qXdP.js";import{u as B}from"./wRpwCGT5.js";import{N as P}from"./CXuCsgek.js";import{b as j,E as x,j as D,g as F,G,k as i,l as a,y as b,s as l,B as f,F as h,m as I,o as r,D as _,A as y,q as k,N as O}from"./vp8MPyNN.js";import{N as V}from"./CvQFKVU5.js";import"./mYRyJGGe.js";const E={class:"container mx-auto px-4 py-8",dir:"rtl"},L={class:"mb-6 flex items-center justify-between gap-3"},S={key:0,class:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3"},T={class:"flex items-center justify-between"},q={class:"text-slate-700 font-medium"},z={class:"text-3xl font-bold text-slate-800"},H={key:1,class:"text-center text-sm text-slate-500 mt-6"},X=j({__name:"index",setup(M){const n=x({}),c=x({}),d=D(!0),{hasPerm:u}=B(),g=[{key:"products",title:"محصولات",to:"/admin/products",perm:"product.read"},{key:"brands",title:"برندها",to:"/admin/brands",perm:"brand.read"},{key:"categories",title:"دسته‌بندی‌ها",to:"/admin/categories",perm:"category.read"},{key:"articles",title:"مقالات",to:"/admin/articles",perm:"article.read"},{key:"users",title:"کاربران",to:"/admin/users",perm:"user.read"},{key:"website-settings",title:"تنظیمات سایت",to:"/admin/website-settings",perm:"website_setting.read"}],m=F(()=>g.filter(t=>u(t.perm)));G(async()=>{d.value=await w();const t=m.value;await Promise.all(t.map(s=>v(s.key)))});async function w(){const s=[{perm:"product_status.read",url:"/product-statuses"},{perm:"product.read",url:"/products"},{perm:"website_setting.read",url:"/website-settings"}].find(o=>u(o.perm));if(!s)return!0;try{return s.url==="/product-statuses"?await p(s.url):await p(s.url,{params:{limit:1,offset:0}}),!0}catch{return!1}}async function v(t){c[t]=!0;try{const s=g.find(A=>A.key===t)??{key:"products",perm:"product.read",to:"/admin/products"};if(!u(s.perm)){n[t]=0;return}const o=t==="website-settings"?"/website-settings":t==="users"?"/users":t==="articles"?"/articles":`/${t}`,e=await p(o,{params:{limit:1,offset:0}}),N=typeof e?.total=="number"?e.total:typeof e?.count=="number"?e.count:typeof e?.metadata?.total=="number"?e.metadata.total:Array.isArray(e?.items)?e.items.length:0;n[t]=N}catch{n[t]=0}finally{c[t]=!1}}return(t,s)=>{const o=C;return r(),i("section",E,[a("div",L,[s[0]||(s[0]=a("div",null,[a("h1",{class:"text-2xl font-bold"},"داشبورد مدیریت"),a("p",{class:"text-slate-500 text-sm mt-1"},"مرور سریع وضعیت بخش‌های مختلف")],-1)),b(f(P),{type:d.value?"success":"error",round:""},{default:l(()=>[_(y(d.value?"API Online":"API Offline"),1)]),_:1},8,["type"])]),m.value.length?(r(),i("div",S,[(r(!0),i(h,null,I(m.value,e=>(r(),k(f(O),{key:e.key,size:"small",class:"rounded-2xl ring-1 ring-slate-200/80 shadow-sm"},{header:l(()=>[a("div",T,[a("div",q,y(e.title),1),b(o,{to:e.to,class:"text-xs text-sky-600 hover:underline"},{default:l(()=>[...s[1]||(s[1]=[_("مشاهده",-1)])]),_:1},8,["to"])])]),default:l(()=>[a("div",z,[c[e.key]?(r(),k(f(V),{key:0,text:"",style:{width:"60%"}})):(r(),i(h,{key:1},[_(y(n[e.key]??0),1)],64))])]),_:2},1024))),128))])):(r(),i("div",H,"دسترسی برای مشاهده هیچ بخشی فعال نیست."))])}}});export{X as default};
