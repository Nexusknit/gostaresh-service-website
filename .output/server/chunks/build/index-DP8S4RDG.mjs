import{_ as e}from"./nuxt-link-DlD_4d-2.mjs";import a from"./index-AgLHWp8z.mjs";import{defineComponent as l,ref as t,computed as i,watch as r,h as s,mergeProps as o,withCtx as u,createVNode as n,createTextVNode as v,unref as m,useSSRContext as d}from"vue";import{ssrRenderAttrs as p,ssrRenderComponent as c,ssrInterpolate as f}from"vue/server-renderer";import{c as g,b as y}from"./api-qvnChiK5.mjs";import{C as h,N as b,F as x}from"./server.mjs";import{u as w}from"./index-CnRzh9fC.mjs";import{N as j}from"./Input-DBNoyZOz.mjs";import{N as U}from"./Select-C0U9uRTf.mjs";import{N as k}from"./Switch-DTUH-ntq.mjs";import{N as _}from"./DataTable-BeR9LhSC.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:url";import"@iconify/utils";import"node:crypto";import"consola";import"node:path";import"@iconify/vue";import"@iconify/utils/lib/css/icon";import"pinia";import"vue-router";import"@css-render/vue3-ssr";import"seemly";import"@css-render/plugin-bem";import"css-render";import"lodash-es";import"evtd";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/plugins";import"unhead/utils";import"date-fns/locale";import"treemate";import"./Tag-BJGgCXYj.mjs";import"@juggle/resize-observer";import"./Checkbox-uGza85BZ.mjs";import"./Ellipsis-DDM1ZdJ1.mjs";import"./get-slot-BIpdyb5h.mjs";const A=l({__name:"index",__ssrInlineRender:!0,setup(l){const d=t(""),A=t(null),C=t(null),z=t(null),D=t(!1),I=t(10),N=t(0),S=t([]),B=t(0),$=t(!1),R=t([]),T=t([]),q=t([]),Z=w(async()=>{$.value=!0;try{const e=await g("/products",{params:{q:d.value||void 0,brandID:A.value||void 0,categoryID:C.value||void 0,statusID:z.value||void 0,isActive:!!D.value||void 0,limit:I.value,offset:N.value}});S.value=Array.isArray(e?.items)?e.items:[],B.value="number"==typeof e?.total?e.total:S.value.length}catch{}finally{$.value=!1}},200);const G=i(()=>R.value.map(e=>({label:e.name||e.slug||e.id,value:e.id}))),H=i(()=>T.value.map(e=>({label:e.name||e.slug||e.id,value:e.id}))),J=i(()=>q.value.map(e=>({label:e.name||e.title||e.id||String(e),value:e.id||e.value||String(e)})));function prev(){N.value=Math.max(0,N.value-I.value)}function next(){N.value+I.value<B.value&&(N.value+=I.value)}r([d,A,C,z,D,I,N],(e,a)=>{if(a){const[l,t,i,r,s,o,u]=a,[n,v,m,d,p,c,f]=e;if((n!==l||v!==t||m!==i||d!==r||p!==s||c!==o)&&0!==N.value)return void(N.value=0)}Z()},{immediate:!0}),async function(){try{const[e,a,l]=await Promise.all([g("/brands",{params:{limit:100,offset:0}}),g("/categories",{params:{limit:100,offset:0}}),g("/product-statuses")]);R.value=Array.isArray(e?.items)?e.items:[],T.value=Array.isArray(a?.items)?a.items:[],q.value=Array.isArray(l)?l:Array.isArray(l?.items)?l.items:[]}catch{}}();const L=i(()=>[{title:"نام",key:"name"},{title:"اسلاگ",key:"slug"},{title:"قیمت",key:"price"},{title:"فعال",key:"isActive",render:e=>e.isActive?"بله":"خیر"},{title:"عملیات",key:"actions",render:e=>s("div",{class:"flex items-center gap-2"},[s(h,{size:"small",onClick:()=>function(e){x(`/admin/products/${e.id}`)}(e)},{default:()=>"ویرایش"}),s(h,{size:"small",type:"error",secondary:!0,onClick:()=>async function(e){confirm("حذف محصول؟")&&(await y(`/products/${e.id}`),Z())}(e)},{default:()=>"حذف"})])}]);return(l,t,i,r)=>{const s=e,g=a;t(`<section${p(o({class:"container mx-auto px-4 py-8",dir:"rtl"},r))}><div class="mb-5 flex items-center justify-between gap-3"><h1 class="text-xl font-bold">محصولات</h1>`),t(c(s,{to:"/admin/products/create",class:"inline-flex items-center gap-2 rounded-xl bg-sky-600 text-white px-3 py-2 text-sm"},{default:u((e,a,l,t)=>{if(!a)return[n(g,{name:"ph:plus"}),v(" افزودن محصول ")];a(c(g,{name:"ph:plus"},null,l,t)),a(" افزودن محصول ")}),_:1},i)),t("</div>"),t(c(m(b),{class:"rounded-2xl ring-1 ring-slate-200/80 shadow-sm mb-4",bordered:!1},{default:u((e,a,l,t)=>{if(!a)return[n("div",{class:"flex flex-wrap items-center gap-3"},[n(m(j),{value:d.value,"onUpdate:value":e=>d.value=e,placeholder:"جستجو...",class:"w-64",clearable:"",size:"large"},{prefix:u(()=>[n(g,{name:"ph:magnifying-glass-duotone"})]),_:1},8,["value","onUpdate:value"]),n(m(U),{value:A.value,"onUpdate:value":e=>A.value=e,options:G.value,placeholder:"برند",class:"w-52",clearable:""},null,8,["value","onUpdate:value","options"]),n(m(U),{value:C.value,"onUpdate:value":e=>C.value=e,options:H.value,placeholder:"دسته‌بندی",class:"w-52",clearable:""},null,8,["value","onUpdate:value","options"]),n(m(U),{value:z.value,"onUpdate:value":e=>z.value=e,options:J.value,placeholder:"وضعیت",class:"w-52",clearable:""},null,8,["value","onUpdate:value","options"]),n(m(k),{value:D.value,"onUpdate:value":e=>D.value=e},{checked:u(()=>[v("فقط فعال")]),unchecked:u(()=>[v("همه")]),_:1},8,["value","onUpdate:value"])])];a(`<div class="flex flex-wrap items-center gap-3"${t}>`),a(c(m(j),{value:d.value,"onUpdate:value":e=>d.value=e,placeholder:"جستجو...",class:"w-64",clearable:"",size:"large"},{prefix:u((e,a,l,t)=>{if(!a)return[n(g,{name:"ph:magnifying-glass-duotone"})];a(c(g,{name:"ph:magnifying-glass-duotone"},null,l,t))}),_:1},l,t)),a(c(m(U),{value:A.value,"onUpdate:value":e=>A.value=e,options:G.value,placeholder:"برند",class:"w-52",clearable:""},null,l,t)),a(c(m(U),{value:C.value,"onUpdate:value":e=>C.value=e,options:H.value,placeholder:"دسته‌بندی",class:"w-52",clearable:""},null,l,t)),a(c(m(U),{value:z.value,"onUpdate:value":e=>z.value=e,options:J.value,placeholder:"وضعیت",class:"w-52",clearable:""},null,l,t)),a(c(m(k),{value:D.value,"onUpdate:value":e=>D.value=e},{checked:u((e,a,l,t)=>{if(!a)return[v("فقط فعال")];a("فقط فعال")}),unchecked:u((e,a,l,t)=>{if(!a)return[v("همه")];a("همه")}),_:1},l,t)),a("</div>")}),_:1},i)),t(c(m(_),{columns:L.value,data:S.value,loading:$.value,bordered:!1,class:"rounded-2xl ring-1 ring-slate-200 overflow-hidden"},null,i)),t(`<div class="mt-4 flex items-center justify-between"><div class="text-sm text-slate-600">مجموع: ${f(B.value)}</div><div class="flex items-center gap-2">`),t(c(m(h),{size:"small",disabled:0===N.value,onClick:prev},{default:u((e,a,l,t)=>{if(!a)return[v("قبلی")];a("قبلی")}),_:1},i)),t(c(m(h),{size:"small",disabled:N.value+I.value>=B.value,onClick:next},{default:u((e,a,l,t)=>{if(!a)return[v("بعدی")];a("بعدی")}),_:1},i)),t("</div></div></section>")}}}),C=A.setup;A.setup=(e,a)=>{const l=d();return(l.modules||(l.modules=new Set)).add("pages/admin/products/index.vue"),C?C(e,a):void 0};export{A as default};
//# sourceMappingURL=index-DP8S4RDG.mjs.map
