import{_ as e}from"./nuxt-link-DlD_4d-2.mjs";import{defineComponent as a,ref as l,mergeProps as u,withCtx as t,createTextVNode as n,unref as i,createVNode as r,toDisplayString as o,useSSRContext as s}from"vue";import{ssrRenderAttrs as d,ssrRenderComponent as v,ssrInterpolate as m}from"vue/server-renderer";import{useRoute as p}from"vue-router";import{A as c}from"./AdminImageUploader-_F4OgyLb.mjs";import{u as f,a as g,b}from"./api-qvnChiK5.mjs";import{N as y,C as U,F as _}from"./server.mjs";import{N as h}from"./Switch-DTUH-ntq.mjs";import{u as x}from"./use-message-DH0YWJK4.mjs";import{N as A,a as V}from"./FormItem-Ds_MAETL.mjs";import{N as j}from"./Input-DBNoyZOz.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:url";import"@iconify/utils";import"node:crypto";import"consola";import"node:path";import"pinia";import"@iconify/vue";import"@css-render/vue3-ssr";import"seemly";import"@css-render/plugin-bem";import"css-render";import"lodash-es";import"evtd";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/plugins";import"unhead/utils";import"async-validator";import"date-fns/locale";const w=a({__name:"[id]",__ssrInlineRender:!0,setup(a){const s=p(),w=String(s.params.id),S=x(),k=l(null),D=l({name:"",slug:"",description:"",image:"",isActive:!0}),C=l(!1),$=l(!1),B={name:{required:!0,message:"نام الزامی است",trigger:"blur"}};async function ensureSlug(){if(D.value.name&&!D.value.slug)try{const{slug:e}=await f()("utils/slug/preview",{method:"POST",body:{model:"brand",source:D.value.name,excludeId:w}});e&&(D.value.slug=e)}catch{}}async function onSubmit(){try{await(k.value?.validate())}catch{return}C.value=!0;try{await g(`/brands/${w}`,{name:D.value.name,description:D.value.description||void 0,image:D.value.image||void 0,slug:D.value.slug||void 0,isActive:D.value.isActive}),S.success("ذخیره شد"),_("/admin/brands")}catch(e){S.error(e?.data?.message||"خطا در ذخیره")}finally{C.value=!1}}async function onDelete(){if(confirm("حذف برند?")){$.value=!0;try{await b(`/brands/${w}`),S.success("حذف شد"),_("/admin/brands")}catch(e){S.error(e?.data?.message||"خطا در حذف")}finally{$.value=!1}}}return(a,l,s,p)=>{const f=e;l(`<section${d(u({class:"container mx-auto px-4 py-8",dir:"rtl"},p))}><div class="mb-5 flex items-center justify-between gap-3"><h1 class="text-xl font-bold">ویرایش برند</h1>`),l(v(f,{to:"/admin/brands",class:"text-sky-600 hover:underline text-sm"},{default:t((e,a,l,u)=>{if(!a)return[n("بازگشت")];a("بازگشت")}),_:1},s)),l("</div>"),l(v(i(y),{class:"rounded-2xl ring-1 ring-slate-200/80 shadow-sm",bordered:!1},{header:t((e,a,l,u)=>{if(!a)return[r("div",{class:"flex items-center justify-between"},[r("div",{class:"text-slate-700"},o(D.value.name||"—"),1),r(i(U),{type:"error",secondary:"",onClick:onDelete,loading:$.value},{default:t(()=>[n("حذف")]),_:1},8,["loading"])])];a(`<div class="flex items-center justify-between"${u}><div class="text-slate-700"${u}>${m(D.value.name||"—")}</div>`),a(v(i(U),{type:"error",secondary:"",onClick:onDelete,loading:$.value},{default:t((e,a,l,u)=>{if(!a)return[n("حذف")];a("حذف")}),_:1},l,u)),a("</div>")}),default:t((e,a,l,u)=>{if(!a)return[r(i(A),{model:D.value,rules:B,ref_key:"formRef",ref:k,"label-placement":"left","label-width":"120"},{default:t(()=>[r(i(V),{label:"نام",path:"name"},{default:t(()=>[r(i(j),{value:D.value.name,"onUpdate:value":e=>D.value.name=e,onBlur:ensureSlug},null,8,["value","onUpdate:value"])]),_:1}),r(i(V),{label:"اسلاگ",path:"slug"},{default:t(()=>[r(i(j),{value:D.value.slug,"onUpdate:value":e=>D.value.slug=e},null,8,["value","onUpdate:value"])]),_:1}),r(i(V),{label:"توضیحات",path:"description"},{default:t(()=>[r(i(j),{value:D.value.description,"onUpdate:value":e=>D.value.description=e,type:"textarea"},null,8,["value","onUpdate:value"])]),_:1}),r(i(V),{label:"تصویر",path:"image"},{default:t(()=>[r(c,{modelValue:D.value.image,"onUpdate:modelValue":e=>D.value.image=e,scope:"brands"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),r(i(V),{label:"فعال"},{default:t(()=>[r(i(h),{value:D.value.isActive,"onUpdate:value":e=>D.value.isActive=e},null,8,["value","onUpdate:value"])]),_:1}),r("div",{class:"pt-2"},[r(i(U),{type:"primary",loading:C.value,onClick:onSubmit},{default:t(()=>[n("ذخیره")]),_:1},8,["loading"])])]),_:1},8,["model"])];a(v(i(A),{model:D.value,rules:B,ref_key:"formRef",ref:k,"label-placement":"left","label-width":"120"},{default:t((e,a,l,u)=>{if(!a)return[r(i(V),{label:"نام",path:"name"},{default:t(()=>[r(i(j),{value:D.value.name,"onUpdate:value":e=>D.value.name=e,onBlur:ensureSlug},null,8,["value","onUpdate:value"])]),_:1}),r(i(V),{label:"اسلاگ",path:"slug"},{default:t(()=>[r(i(j),{value:D.value.slug,"onUpdate:value":e=>D.value.slug=e},null,8,["value","onUpdate:value"])]),_:1}),r(i(V),{label:"توضیحات",path:"description"},{default:t(()=>[r(i(j),{value:D.value.description,"onUpdate:value":e=>D.value.description=e,type:"textarea"},null,8,["value","onUpdate:value"])]),_:1}),r(i(V),{label:"تصویر",path:"image"},{default:t(()=>[r(c,{modelValue:D.value.image,"onUpdate:modelValue":e=>D.value.image=e,scope:"brands"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),r(i(V),{label:"فعال"},{default:t(()=>[r(i(h),{value:D.value.isActive,"onUpdate:value":e=>D.value.isActive=e},null,8,["value","onUpdate:value"])]),_:1}),r("div",{class:"pt-2"},[r(i(U),{type:"primary",loading:C.value,onClick:onSubmit},{default:t(()=>[n("ذخیره")]),_:1},8,["loading"])])];a(v(i(V),{label:"نام",path:"name"},{default:t((e,a,l,u)=>{if(!a)return[r(i(j),{value:D.value.name,"onUpdate:value":e=>D.value.name=e,onBlur:ensureSlug},null,8,["value","onUpdate:value"])];a(v(i(j),{value:D.value.name,"onUpdate:value":e=>D.value.name=e,onBlur:ensureSlug},null,l,u))}),_:1},l,u)),a(v(i(V),{label:"اسلاگ",path:"slug"},{default:t((e,a,l,u)=>{if(!a)return[r(i(j),{value:D.value.slug,"onUpdate:value":e=>D.value.slug=e},null,8,["value","onUpdate:value"])];a(v(i(j),{value:D.value.slug,"onUpdate:value":e=>D.value.slug=e},null,l,u))}),_:1},l,u)),a(v(i(V),{label:"توضیحات",path:"description"},{default:t((e,a,l,u)=>{if(!a)return[r(i(j),{value:D.value.description,"onUpdate:value":e=>D.value.description=e,type:"textarea"},null,8,["value","onUpdate:value"])];a(v(i(j),{value:D.value.description,"onUpdate:value":e=>D.value.description=e,type:"textarea"},null,l,u))}),_:1},l,u)),a(v(i(V),{label:"تصویر",path:"image"},{default:t((e,a,l,u)=>{if(!a)return[r(c,{modelValue:D.value.image,"onUpdate:modelValue":e=>D.value.image=e,scope:"brands"},null,8,["modelValue","onUpdate:modelValue"])];a(v(c,{modelValue:D.value.image,"onUpdate:modelValue":e=>D.value.image=e,scope:"brands"},null,l,u))}),_:1},l,u)),a(v(i(V),{label:"فعال"},{default:t((e,a,l,u)=>{if(!a)return[r(i(h),{value:D.value.isActive,"onUpdate:value":e=>D.value.isActive=e},null,8,["value","onUpdate:value"])];a(v(i(h),{value:D.value.isActive,"onUpdate:value":e=>D.value.isActive=e},null,l,u))}),_:1},l,u)),a(`<div class="pt-2"${u}>`),a(v(i(U),{type:"primary",loading:C.value,onClick:onSubmit},{default:t((e,a,l,u)=>{if(!a)return[n("ذخیره")];a("ذخیره")}),_:1},l,u)),a("</div>")}),_:1},l,u))}),_:1},s)),l("</section>")}}}),S=w.setup;w.setup=(e,a)=>{const l=s();return(l.modules||(l.modules=new Set)).add("pages/admin/brands/[id].vue"),S?S(e,a):void 0};export{w as default};
//# sourceMappingURL=_id_-DOF80Hw4.mjs.map
