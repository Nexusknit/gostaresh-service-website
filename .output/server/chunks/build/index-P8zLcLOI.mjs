import{_ as e}from"./nuxt-link-DlD_4d-2.mjs";import t from"./index-AgLHWp8z.mjs";import{defineComponent as r,ref as s,watch as a,computed as i,h as l,mergeProps as n,unref as o,withCtx as m,createVNode as u,createTextVNode as d,useSSRContext as p}from"vue";import{ssrRenderAttrs as c,ssrRenderComponent as v,ssrInterpolate as f}from"vue/server-renderer";import{c as g,b as h}from"./api-qvnChiK5.mjs";import{C as b,N as x,B as y,F as j}from"./server.mjs";import{u as w}from"./useAccess-BGBQvVbm.mjs";import{u as _}from"./use-message-DH0YWJK4.mjs";import{N as k}from"./Input-DBNoyZOz.mjs";import{N as C}from"./DataTable-BeR9LhSC.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:url";import"@iconify/utils";import"node:crypto";import"consola";import"node:path";import"@iconify/vue";import"@iconify/utils/lib/css/icon";import"pinia";import"vue-router";import"@css-render/vue3-ssr";import"seemly";import"@css-render/plugin-bem";import"css-render";import"lodash-es";import"evtd";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/plugins";import"unhead/utils";import"./useAuth-BCA76F4T.mjs";import"date-fns/locale";import"./Checkbox-uGza85BZ.mjs";import"./Ellipsis-DDM1ZdJ1.mjs";import"./Select-C0U9uRTf.mjs";import"treemate";import"./Tag-BJGgCXYj.mjs";import"@juggle/resize-observer";import"./get-slot-BIpdyb5h.mjs";const z=r({__name:"index",__ssrInlineRender:!0,setup(r){const p=_(),{hasPerm:z}=w(),B=s(""),A=s(10),D=s(0),L=s([]),U=s(0),$=s(!1);async function fetchList(){$.value=!0;try{const e=await g("/brands",{params:{q:B.value||void 0,limit:A.value,offset:D.value}});L.value=Array.isArray(e?.items)?e.items:[],U.value="number"==typeof e?.total?e.total:L.value.length}finally{$.value=!1}}function prev(){D.value=Math.max(0,D.value-A.value)}function next(){D.value+A.value<U.value&&(D.value+=A.value)}a([B,A,D],fetchList,{immediate:!0});const R=i(()=>{const e=z("brand.update"),t=z("brand.delete"),r=[{title:"نام",key:"name"},{title:"نامک",key:"slug"},{title:"تصویر",key:"image",render(e){if(!e.image)return l("span",{class:"text-slate-400"},"-");const t=y().public?.apiBase||"/api/v1",r=new URL(t,""),s=new URL(`/uploads/${String(e.image).replace(/^\/+/,"")}`,r).toString();return l("img",{src:s,class:"h-10 w-10 object-cover rounded-lg ring-1 ring-slate-200"})}},{title:"وضعیت",key:"isActive",render:e=>e.isActive?"فعال":"غیرفعال"}];return(e||t)&&r.push({title:"اقدامات",key:"actions",render(r){const s=[];return e&&s.push(l(b,{size:"small",onClick:()=>function(e){z("brand.update")&&j(`/admin/brands/${e.id}`)}(r)},{default:()=>"ویرایش"})),t&&s.push(l(b,{size:"small",type:"error",secondary:!0,onClick:()=>async function(e){if(z("brand.delete"))try{await h(`/brands/${e.id}`),p.success("حذف شد"),fetchList()}catch(e){p.error(e?.data?.message||"حذف انجام نشد")}}(r)},{default:()=>"حذف"})),s.length?l("div",{class:"flex items-center gap-2"},s):null}}),r});return(r,s,a,i)=>{const l=e,p=t;s(`<section${c(n({class:"container mx-auto px-4 py-8",dir:"rtl"},i))}><div class="mb-5 flex items-center justify-between gap-3"><h1 class="text-xl font-bold">برندها</h1>`),o(z)("brand.create")?s(v(l,{to:"/admin/brands/create",class:"inline-flex items-center gap-2 rounded-xl bg-sky-600 text-white px-3 py-2 text-sm"},{default:m((e,t,r,s)=>{if(!t)return[u(p,{name:"ph:plus"}),d(" افزودن برند ")];t(v(p,{name:"ph:plus"},null,r,s)),t(" افزودن برند ")}),_:1},a)):s("\x3c!----\x3e"),s("</div>"),s(v(o(x),{class:"rounded-2xl ring-1 ring-slate-200/80 shadow-sm mb-4",bordered:!1},{default:m((e,t,r,s)=>{if(!t)return[u("div",{class:"flex flex-wrap items-center gap-3"},[u(o(k),{value:B.value,"onUpdate:value":e=>B.value=e,placeholder:"جستجو...",class:"w-64",clearable:"",size:"large"},{prefix:m(()=>[u(p,{name:"ph:magnifying-glass-duotone"})]),_:1},8,["value","onUpdate:value"])])];t(`<div class="flex flex-wrap items-center gap-3"${s}>`),t(v(o(k),{value:B.value,"onUpdate:value":e=>B.value=e,placeholder:"جستجو...",class:"w-64",clearable:"",size:"large"},{prefix:m((e,t,r,s)=>{if(!t)return[u(p,{name:"ph:magnifying-glass-duotone"})];t(v(p,{name:"ph:magnifying-glass-duotone"},null,r,s))}),_:1},r,s)),t("</div>")}),_:1},a)),s(v(o(C),{columns:R.value,data:L.value,loading:$.value,bordered:!1,class:"rounded-2xl ring-1 ring-slate-200 overflow-hidden"},null,a)),s(`<div class="mt-4 flex items-center justify-between"><div class="text-sm text-slate-600">تعداد کل: ${f(U.value)}</div><div class="flex items-center gap-2">`),s(v(o(b),{size:"small",disabled:0===D.value,onClick:prev},{default:m((e,t,r,s)=>{if(!t)return[d("قبلی")];t("قبلی")}),_:1},a)),s(v(o(b),{size:"small",disabled:D.value+A.value>=U.value,onClick:next},{default:m((e,t,r,s)=>{if(!t)return[d("بعدی")];t("بعدی")}),_:1},a)),s("</div></div></section>")}}}),B=z.setup;z.setup=(e,t)=>{const r=p();return(r.modules||(r.modules=new Set)).add("pages/admin/brands/index.vue"),B?B(e,t):void 0};export{z as default};
//# sourceMappingURL=index-P8zLcLOI.mjs.map
