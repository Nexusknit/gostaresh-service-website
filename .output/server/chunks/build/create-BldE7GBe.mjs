import{_ as e}from"./nuxt-link-DlD_4d-2.mjs";import{defineComponent as a,ref as l,computed as u,mergeProps as t,withCtx as n,createTextVNode as r,unref as o,createVNode as i,useSSRContext as s}from"vue";import{ssrRenderAttrs as v,ssrRenderComponent as p}from"vue/server-renderer";import{d as m}from"./api-qvnChiK5.mjs";import{N as d,C as c,F as f}from"./server.mjs";import{u as g}from"./use-message-DH0YWJK4.mjs";import{N as b,a as U}from"./FormItem-Ds_MAETL.mjs";import{N as h}from"./Input-DBNoyZOz.mjs";import{N as _}from"./Select-C0U9uRTf.mjs";import{N as y}from"./Switch-DTUH-ntq.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:url";import"@iconify/utils";import"node:crypto";import"consola";import"node:path";import"pinia";import"vue-router";import"@iconify/vue";import"@css-render/vue3-ssr";import"seemly";import"@css-render/plugin-bem";import"css-render";import"lodash-es";import"evtd";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/plugins";import"unhead/utils";import"async-validator";import"date-fns/locale";import"treemate";import"./Tag-BJGgCXYj.mjs";import"@juggle/resize-observer";const D=a({__name:"create",__ssrInlineRender:!0,setup(a){const s=g(),D=l(null),I=l({name:"",slug:"",parentID:null,isActive:!0}),j=l(!1),S=l([]),A={name:{required:!0,message:"نام الزامی است",trigger:"blur"}},w=u(()=>S.value.map(e=>({label:e.name||e.slug||e.id,value:e.id})));async function ensureSlug(){if(I.value.name&&!I.value.slug)try{const{slug:e}=await $apiFetch("/utils/slug/preview",{method:"POST",body:{model:"category",source:I.value.name}});e&&(I.value.slug=e)}catch{}}async function onSubmit(){try{await(D.value?.validate())}catch{return}j.value=!0;try{await m("categories",{name:I.value.name,parentID:I.value.parentID||void 0,slug:I.value.slug||void 0,isActive:I.value.isActive}),s.success("دسته‌بندی افزوده شد"),f("/admin/categories")}catch(e){s.error(e?.data?.message||"خطا در ثبت")}finally{j.value=!1}}return(a,l,u,s)=>{const m=e;l(`<section${v(t({class:"container mx-auto px-4 py-8",dir:"rtl"},s))}><div class="mb-5 flex items-center justify-between gap-3"><h1 class="text-xl font-bold">افزودن دسته‌بندی</h1>`),l(p(m,{to:"/admin/categories",class:"text-sky-600 hover:underline text-sm"},{default:n((e,a,l,u)=>{if(!a)return[r("بازگشت")];a("بازگشت")}),_:1},u)),l("</div>"),l(p(o(d),{class:"rounded-2xl ring-1 ring-slate-200/80 shadow-sm",bordered:!1},{default:n((e,a,l,u)=>{if(!a)return[i(o(b),{model:I.value,rules:A,ref_key:"formRef",ref:D,"label-placement":"left","label-width":"120"},{default:n(()=>[i(o(U),{label:"نام",path:"name"},{default:n(()=>[i(o(h),{value:I.value.name,"onUpdate:value":e=>I.value.name=e,onBlur:ensureSlug},null,8,["value","onUpdate:value"])]),_:1}),i(o(U),{label:"اسلاگ",path:"slug"},{default:n(()=>[i(o(h),{value:I.value.slug,"onUpdate:value":e=>I.value.slug=e},null,8,["value","onUpdate:value"])]),_:1}),i(o(U),{label:"والد",path:"parentID"},{default:n(()=>[i(o(_),{value:I.value.parentID,"onUpdate:value":e=>I.value.parentID=e,options:w.value,clearable:""},null,8,["value","onUpdate:value","options"])]),_:1}),i(o(U),{label:"فعال"},{default:n(()=>[i(o(y),{value:I.value.isActive,"onUpdate:value":e=>I.value.isActive=e},null,8,["value","onUpdate:value"])]),_:1}),i("div",{class:"pt-2"},[i(o(c),{type:"primary",loading:j.value,onClick:onSubmit},{default:n(()=>[r("ثبت")]),_:1},8,["loading"])])]),_:1},8,["model"])];a(p(o(b),{model:I.value,rules:A,ref_key:"formRef",ref:D,"label-placement":"left","label-width":"120"},{default:n((e,a,l,u)=>{if(!a)return[i(o(U),{label:"نام",path:"name"},{default:n(()=>[i(o(h),{value:I.value.name,"onUpdate:value":e=>I.value.name=e,onBlur:ensureSlug},null,8,["value","onUpdate:value"])]),_:1}),i(o(U),{label:"اسلاگ",path:"slug"},{default:n(()=>[i(o(h),{value:I.value.slug,"onUpdate:value":e=>I.value.slug=e},null,8,["value","onUpdate:value"])]),_:1}),i(o(U),{label:"والد",path:"parentID"},{default:n(()=>[i(o(_),{value:I.value.parentID,"onUpdate:value":e=>I.value.parentID=e,options:w.value,clearable:""},null,8,["value","onUpdate:value","options"])]),_:1}),i(o(U),{label:"فعال"},{default:n(()=>[i(o(y),{value:I.value.isActive,"onUpdate:value":e=>I.value.isActive=e},null,8,["value","onUpdate:value"])]),_:1}),i("div",{class:"pt-2"},[i(o(c),{type:"primary",loading:j.value,onClick:onSubmit},{default:n(()=>[r("ثبت")]),_:1},8,["loading"])])];a(p(o(U),{label:"نام",path:"name"},{default:n((e,a,l,u)=>{if(!a)return[i(o(h),{value:I.value.name,"onUpdate:value":e=>I.value.name=e,onBlur:ensureSlug},null,8,["value","onUpdate:value"])];a(p(o(h),{value:I.value.name,"onUpdate:value":e=>I.value.name=e,onBlur:ensureSlug},null,l,u))}),_:1},l,u)),a(p(o(U),{label:"اسلاگ",path:"slug"},{default:n((e,a,l,u)=>{if(!a)return[i(o(h),{value:I.value.slug,"onUpdate:value":e=>I.value.slug=e},null,8,["value","onUpdate:value"])];a(p(o(h),{value:I.value.slug,"onUpdate:value":e=>I.value.slug=e},null,l,u))}),_:1},l,u)),a(p(o(U),{label:"والد",path:"parentID"},{default:n((e,a,l,u)=>{if(!a)return[i(o(_),{value:I.value.parentID,"onUpdate:value":e=>I.value.parentID=e,options:w.value,clearable:""},null,8,["value","onUpdate:value","options"])];a(p(o(_),{value:I.value.parentID,"onUpdate:value":e=>I.value.parentID=e,options:w.value,clearable:""},null,l,u))}),_:1},l,u)),a(p(o(U),{label:"فعال"},{default:n((e,a,l,u)=>{if(!a)return[i(o(y),{value:I.value.isActive,"onUpdate:value":e=>I.value.isActive=e},null,8,["value","onUpdate:value"])];a(p(o(y),{value:I.value.isActive,"onUpdate:value":e=>I.value.isActive=e},null,l,u))}),_:1},l,u)),a(`<div class="pt-2"${u}>`),a(p(o(c),{type:"primary",loading:j.value,onClick:onSubmit},{default:n((e,a,l,u)=>{if(!a)return[r("ثبت")];a("ثبت")}),_:1},l,u)),a("</div>")}),_:1},l,u))}),_:1},u)),l("</section>")}}}),I=D.setup;D.setup=(e,a)=>{const l=s();return(l.modules||(l.modules=new Set)).add("pages/admin/categories/create.vue"),I?I(e,a):void 0};export{D as default};
//# sourceMappingURL=create-BldE7GBe.mjs.map
