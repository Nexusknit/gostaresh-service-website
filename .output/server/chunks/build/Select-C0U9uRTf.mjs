import{getPadding as e,depx as t,happensIn as n,getPreciseEventTarget as o,pxfy as r,changeColor as l,beforeNextFrameOnce as i}from"seemly";import{createTreeMate as a,createIndexGetter as s}from"treemate";import{defineComponent as d,h as u,Transition as c,withDirectives as p,vShow as h,ref as v,toRef as f,computed as g,watch as b,provide as m,getCurrentInstance as w,inject as y,Fragment as x,nextTick as S,renderSlot as C,cloneVNode as T,Text as M,watchEffect as z,mergeProps as $}from"vue";import{ag as O,u as R,b as F,a1 as B,j as P,am as I,q as k,f as A,s as E,y as L,d as j,c as N,k as W,aa as D,ab as H,an as _,ae as V,e as U,ac as K,ad as Y,a6 as X,a7 as G,a8 as q,a9 as Z,R as J,r as Q,a0 as ee,a4 as te,p as ne,o as oe,ao as re,a as le,ak as ie,al as ae,H as se,n as de,a5 as ue,a2 as ce,t as pe,ah as he,ai as ve,af as fe,aj as ge}from"./server.mjs";import{off as be,on as me}from"evtd";import{u as we,a as ye,b as xe,f as Se}from"./Input-DBNoyZOz.mjs";import{N as Ce}from"./Tag-BJGgCXYj.mjs";import{useSsrAdapter as Te}from"@css-render/vue3-ssr";import{CssRender as Me}from"css-render";import{map as ze}from"lodash-es";import{ResizeObserver as $e}from"@juggle/resize-observer";const Oe=J("n-internal-select-menu"),Re=J("n-internal-select-menu-body"),Fe="__disabled__";function useAdjustedTo(e){const t=y(G,null),n=y(q,null),o=y(Z,null),r=y(Re,null),l=v();return X(()=>{var i;const{to:a}=e;return void 0!==a?!1===a?Fe:!0===a?l.value||"body":a:(null==t?void 0:t.value)?null!==(i=t.value.$el)&&void 0!==i?i:t.value:(null==n?void 0:n.value)?n.value:(null==o?void 0:o.value)?o.value:(null==r?void 0:r.value)?r.value:null!=a?a:l.value||"body"})}useAdjustedTo.tdkey=Fe,useAdjustedTo.propTo={type:[String,Object,Boolean],default:void 0};let Be=null;function ensureViewBoundingRect(){if(null===Be&&(Be=(void 0).getElementById("v-binder-view-measurer"),null===Be)){Be=(void 0).createElement("div"),Be.id="v-binder-view-measurer";const{style:e}=Be;e.position="fixed",e.left="0",e.right="0",e.top="0",e.bottom="0",e.pointerEvents="none",e.visibility="hidden",(void 0).body.appendChild(Be)}return Be.getBoundingClientRect()}function getRect(e){const t=e.getBoundingClientRect(),n=ensureViewBoundingRect();return{left:t.left-n.left,top:t.top-n.top,bottom:n.height+n.top-t.bottom,right:n.width+n.left-t.right,width:t.width,height:t.height}}function getScrollParent(e){if(null===e)return null;const t=function(e){return 9===e.nodeType?null:e.parentNode}(e);if(null===t)return null;if(9!==t.nodeType){if(1===t.nodeType){const{overflow:e,overflowX:n,overflowY:o}=getComputedStyle(t);if(/(auto|scroll|overlay)/.test(e+o+n))return t}return getScrollParent(t)}}const Pe=d({name:"Binder",props:{syncTargetWithParent:Boolean,syncTarget:{type:Boolean,default:!0}},setup(e){var t;m("VBinder",null===(t=w())||void 0===t?void 0:t.proxy);const n=y("VBinder",null),o=v(null);let r=[];const l=new Set,onScroll=()=>{i(onScrollRaf)},onScrollRaf=()=>{l.forEach(e=>e())},a=new Set,onResize=()=>{a.forEach(e=>e())};return{targetRef:o,setTargetRef:t=>{o.value=t,n&&e.syncTargetWithParent&&n.setTargetRef(t)},addScrollListener:e=>{0===l.size&&(()=>{let e=o.value;for(;e=getScrollParent(e),null!==e;)r.push(e);for(const e of r)me("scroll",e,onScroll,!0)})(),l.has(e)||l.add(e)},removeScrollListener:e=>{l.has(e)&&l.delete(e),0===l.size&&(()=>{for(const e of r)be("scroll",e,onScroll,!0);r=[]})()},addResizeListener:e=>{0===a.size&&me("resize",void 0,onResize),a.has(e)||a.add(e)},removeResizeListener:e=>{a.has(e)&&a.delete(e),0===a.size&&be("resize",void 0,onResize)}}},render(){return D("binder",this.$slots)}}),Ie=d({name:"Target",setup(){const{setTargetRef:e,syncTarget:t}=y("VBinder");return{syncTarget:t,setTargetDirective:{mounted:e,updated:e}}},render(){const{syncTarget:e,setTargetDirective:t}=this;return e?p(H("follower",this.$slots),[[t]]):H("follower",this.$slots)}}),ke="@@mmoContext",Ae={mounted(e,{value:t}){e[ke]={handler:void 0},"function"==typeof t&&(e[ke].handler=t,me("mousemoveoutside",e,t))},updated(e,{value:t}){const n=e[ke];"function"==typeof t?n.handler?n.handler!==t&&(be("mousemoveoutside",e,n.handler),n.handler=t,me("mousemoveoutside",e,t)):(e[ke].handler=t,me("mousemoveoutside",e,t)):n.handler&&(be("mousemoveoutside",e,n.handler),n.handler=void 0)},unmounted(e){const{handler:t}=e[ke];t&&be("mousemoveoutside",e,t),e[ke].handler=void 0}},{c:Ee}=Me(),Le="vueuc-style";function lowBit(e){return e&-e}class FinweckTree{constructor(e,t){this.l=e,this.min=t;const n=new Array(e+1);for(let t=0;t<e+1;++t)n[t]=0;this.ft=n}add(e,t){if(0===t)return;const{l:n,ft:o}=this;for(e+=1;e<=n;)o[e]+=t,e+=lowBit(e)}get(e){return this.sum(e+1)-this.sum(e)}sum(e){if(void 0===e&&(e=this.l),e<=0)return 0;const{ft:t,min:n,l:o}=this;if(e>o)throw new Error("[FinweckTree.sum]: `i` is larger than length.");let r=e*n;for(;e>0;)r+=t[e],e-=lowBit(e);return r}getBound(e){let t=0,n=this.l;for(;n>t;){const o=Math.floor((t+n)/2),r=this.sum(o);if(r>e)n=o;else{if(!(r<e))return o;if(t===o)return this.sum(t+1)<=e?t+1:o;t=o}}return t}}const je={top:"bottom",bottom:"top",left:"right",right:"left"},Ne={start:"end",center:"center",end:"start"},We={top:"height",bottom:"height",left:"width",right:"width"},De={"bottom-start":"top left",bottom:"top center","bottom-end":"top right","top-start":"bottom left",top:"bottom center","top-end":"bottom right","right-start":"top left",right:"center left","right-end":"bottom left","left-start":"top right",left:"center right","left-end":"bottom right"},He={"bottom-start":"bottom left",bottom:"bottom center","bottom-end":"bottom right","top-start":"top left",top:"top center","top-end":"top right","right-start":"top right",right:"center right","right-end":"bottom right","left-start":"top left",left:"center left","left-end":"bottom left"},_e={"bottom-start":"right","bottom-end":"left","top-start":"right","top-end":"left","right-start":"bottom","right-end":"top","left-start":"bottom","left-end":"top"},Ve={top:!0,bottom:!1,left:!0,right:!1},Ue={top:"end",bottom:"start",left:"end",right:"start"};const Ke=Ee([Ee(".v-binder-follower-container",{position:"absolute",left:"0",right:"0",top:"0",height:"0",pointerEvents:"none",zIndex:"auto"}),Ee(".v-binder-follower-content",{position:"absolute",zIndex:"auto"},[Ee("> *",{pointerEvents:"all"})])]),Ye=d({name:"Follower",inheritAttrs:!1,props:{show:Boolean,enabled:{type:Boolean,default:void 0},placement:{type:String,default:"bottom"},syncTrigger:{type:Array,default:["resize","scroll"]},to:[String,Object],flip:{type:Boolean,default:!0},internalShift:Boolean,x:Number,y:Number,width:String,minWidth:String,containerClass:String,teleportDisabled:Boolean,zindexable:{type:Boolean,default:!0},zIndex:Number,overlap:Boolean},setup(e){const t=y("VBinder"),n=X(()=>void 0!==e.enabled?e.enabled:e.show),o=v(null),r=v(null),l=Te();Ke.mount({id:"vueuc/binder",head:!0,anchorMetaName:Le,ssr:l});const syncPosition=()=>{if(!n.value)return;const l=o.value;if(null===l)return;const i=t.targetRef,{x:a,y:s,overlap:d}=e,u=void 0!==a&&void 0!==s?function(e,t){const n=ensureViewBoundingRect();return{top:t,left:e,height:0,width:0,right:n.width-e,bottom:n.height-t}}(a,s):getRect(i);l.style.setProperty("--v-target-width",`${Math.round(u.width)}px`),l.style.setProperty("--v-target-height",`${Math.round(u.height)}px`);const{width:c,minWidth:p,placement:h,internalShift:v,flip:f}=e;l.setAttribute("v-placement",h),d?l.setAttribute("v-overlap",""):l.removeAttribute("v-overlap");const{style:g}=l;g.width="target"===c?`${u.width}px`:void 0!==c?c:"",g.minWidth="target"===p?`${u.width}px`:void 0!==p?p:"";const b=getRect(l),m=getRect(r.value),{left:w,top:y,placement:x}=function(e,t,n,o,r,l){if(!r||l)return{placement:e,top:0,left:0};const[i,a]=e.split("-");let s=null!=a?a:"center",d={top:0,left:0};const deriveOffset=(e,r,l)=>{let i=0,a=0;const s=n[e]-t[r]-t[e];return s>0&&o&&(l?a=Ve[r]?s:-s:i=Ve[r]?s:-s),{left:i,top:a}},u="left"===i||"right"===i;if("center"!==s){const o=_e[e],r=je[o],l=We[o];if(n[l]>t[l]){if(t[o]+t[l]<n[l]){const e=(n[l]-t[l])/2;t[o]<e||t[r]<e?t[o]<t[r]?(s=Ne[a],d=deriveOffset(l,r,u)):d=deriveOffset(l,o,u):s="center"}}else n[l]<t[l]&&t[r]<0&&t[o]>t[r]&&(s=Ne[a])}else{const e="bottom"===i||"top"===i?"left":"top",o=je[e],r=We[e],l=(n[r]-t[r])/2;(t[e]<l||t[o]<l)&&(t[e]>t[o]?(s=Ue[e],d=deriveOffset(r,e,u)):(s=Ue[o],d=deriveOffset(r,o,u)))}let c=i;return t[i]<n[We[i]]&&t[i]<t[je[i]]&&(c=je[i]),{placement:"center"!==s?`${c}-${s}`:c,left:d.left,top:d.top}}(h,u,b,v,f,d),S=function(e,t){return t?He[e]:De[e]}(x,d),{left:C,top:T,transform:M}=function(e,t,n,o,r,l){if(l)switch(e){case"bottom-start":case"left-end":return{top:`${Math.round(n.top-t.top+n.height)}px`,left:`${Math.round(n.left-t.left)}px`,transform:"translateY(-100%)"};case"bottom-end":case"right-end":return{top:`${Math.round(n.top-t.top+n.height)}px`,left:`${Math.round(n.left-t.left+n.width)}px`,transform:"translateX(-100%) translateY(-100%)"};case"top-start":case"left-start":return{top:`${Math.round(n.top-t.top)}px`,left:`${Math.round(n.left-t.left)}px`,transform:""};case"top-end":case"right-start":return{top:`${Math.round(n.top-t.top)}px`,left:`${Math.round(n.left-t.left+n.width)}px`,transform:"translateX(-100%)"};case"top":return{top:`${Math.round(n.top-t.top)}px`,left:`${Math.round(n.left-t.left+n.width/2)}px`,transform:"translateX(-50%)"};case"right":return{top:`${Math.round(n.top-t.top+n.height/2)}px`,left:`${Math.round(n.left-t.left+n.width)}px`,transform:"translateX(-100%) translateY(-50%)"};case"left":return{top:`${Math.round(n.top-t.top+n.height/2)}px`,left:`${Math.round(n.left-t.left)}px`,transform:"translateY(-50%)"};default:return{top:`${Math.round(n.top-t.top+n.height)}px`,left:`${Math.round(n.left-t.left+n.width/2)}px`,transform:"translateX(-50%) translateY(-100%)"}}switch(e){case"bottom-start":return{top:`${Math.round(n.top-t.top+n.height+o)}px`,left:`${Math.round(n.left-t.left+r)}px`,transform:""};case"bottom-end":return{top:`${Math.round(n.top-t.top+n.height+o)}px`,left:`${Math.round(n.left-t.left+n.width+r)}px`,transform:"translateX(-100%)"};case"top-start":return{top:`${Math.round(n.top-t.top+o)}px`,left:`${Math.round(n.left-t.left+r)}px`,transform:"translateY(-100%)"};case"top-end":return{top:`${Math.round(n.top-t.top+o)}px`,left:`${Math.round(n.left-t.left+n.width+r)}px`,transform:"translateX(-100%) translateY(-100%)"};case"right-start":return{top:`${Math.round(n.top-t.top+o)}px`,left:`${Math.round(n.left-t.left+n.width+r)}px`,transform:""};case"right-end":return{top:`${Math.round(n.top-t.top+n.height+o)}px`,left:`${Math.round(n.left-t.left+n.width+r)}px`,transform:"translateY(-100%)"};case"left-start":return{top:`${Math.round(n.top-t.top+o)}px`,left:`${Math.round(n.left-t.left+r)}px`,transform:"translateX(-100%)"};case"left-end":return{top:`${Math.round(n.top-t.top+n.height+o)}px`,left:`${Math.round(n.left-t.left+r)}px`,transform:"translateX(-100%) translateY(-100%)"};case"top":return{top:`${Math.round(n.top-t.top+o)}px`,left:`${Math.round(n.left-t.left+n.width/2+r)}px`,transform:"translateY(-100%) translateX(-50%)"};case"right":return{top:`${Math.round(n.top-t.top+n.height/2+o)}px`,left:`${Math.round(n.left-t.left+n.width+r)}px`,transform:"translateY(-50%)"};case"left":return{top:`${Math.round(n.top-t.top+n.height/2+o)}px`,left:`${Math.round(n.left-t.left+r)}px`,transform:"translateY(-50%) translateX(-100%)"};default:return{top:`${Math.round(n.top-t.top+n.height+o)}px`,left:`${Math.round(n.left-t.left+n.width/2+r)}px`,transform:"translateX(-50%)"}}}(x,m,u,y,w,d);l.setAttribute("v-placement",x),l.style.setProperty("--v-offset-left",`${Math.round(w)}px`),l.style.setProperty("--v-offset-top",`${Math.round(y)}px`),l.style.transform=`translateX(${C}) translateY(${T}) ${M}`,l.style.setProperty("--v-transform-origin",S),l.style.transformOrigin=S};b(n,n=>{n?((()=>{const{syncTrigger:n}=e;n.includes("scroll")&&t.addScrollListener(syncPosition),n.includes("resize")&&t.addResizeListener(syncPosition)})(),syncOnNextTick()):(t.removeScrollListener(syncPosition),t.removeResizeListener(syncPosition))});const syncOnNextTick=()=>{S().then(syncPosition).catch(e=>console.error(e))};["placement","x","y","internalShift","flip","width","overlap","minWidth"].forEach(t=>{b(f(e,t),syncPosition)}),["teleportDisabled"].forEach(t=>{b(f(e,t),syncOnNextTick)}),b(f(e,"syncTrigger"),e=>{e.includes("resize")?t.addResizeListener(syncPosition):t.removeResizeListener(syncPosition),e.includes("scroll")?t.addScrollListener(syncPosition):t.removeScrollListener(syncPosition)});const i=E(),a=X(()=>{const{to:t}=e;if(void 0!==t)return t;i.value});return{VBinder:t,mergedEnabled:n,offsetContainerRef:r,followerRef:o,mergedTo:a,syncPosition:syncPosition}},render(){return u(K,{show:this.show,to:this.mergedTo,disabled:this.teleportDisabled},{default:()=>{var e,t;const n=u("div",{class:["v-binder-follower-container",this.containerClass],ref:"offsetContainerRef"},[u("div",{class:"v-binder-follower-content",ref:"followerRef"},null===(t=(e=this.$slots).default)||void 0===t?void 0:t.call(e))]);return this.zindexable?p(n,[[Y,{enabled:this.mergedEnabled,zIndex:this.zIndex}]]):n}})}});const Xe=new class{constructor(){this.handleResize=this.handleResize.bind(this),this.observer=new $e(this.handleResize),this.elHandlersMap=new Map}handleResize(e){for(const t of e){const e=this.elHandlersMap.get(t.target);void 0!==e&&e(t)}}registerHandler(e,t){this.elHandlersMap.set(e,t),this.observer.observe(e)}unregisterHandler(e){this.elHandlersMap.has(e)&&(this.elHandlersMap.delete(e),this.observer.unobserve(e))}};const Ge="VVirtualListXScroll";const qe=d({name:"VirtualListRow",props:{index:{type:Number,required:!0},item:{type:Object,required:!0}},setup(){const{startIndexRef:e,endIndexRef:t,columnsRef:n,getLeft:o,renderColRef:r,renderItemWithColsRef:l}=y(Ge);return{startIndex:e,endIndex:t,columns:n,renderCol:r,renderItemWithCols:l,getLeft:o}},render(){const{startIndex:e,endIndex:t,columns:n,renderCol:o,renderItemWithCols:r,getLeft:l,item:i}=this;if(null!=r)return r({itemIndex:this.index,startColIndex:e,endColIndex:t,allColumns:n,item:i,getLeft:l});if(null!=o){const r=[];for(let a=e;a<=t;++a){const e=n[a];r.push(o({column:e,left:l(a),item:i}))}return r}return null}}),Ze=Ee(".v-vl",{maxHeight:"inherit",height:"100%",overflow:"auto",minWidth:"1px"},[Ee("&:not(.v-vl--show-scrollbar)",{scrollbarWidth:"none"},[Ee("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",{width:0,height:0,display:"none"})])]),Je=d({name:"VirtualList",inheritAttrs:!1,props:{showScrollbar:{type:Boolean,default:!0},columns:{type:Array,default:()=>[]},renderCol:Function,renderItemWithCols:Function,items:{type:Array,default:()=>[]},itemSize:{type:Number,required:!0},itemResizable:Boolean,itemsStyle:[String,Object],visibleItemsTag:{type:[String,Object],default:"div"},visibleItemsProps:Object,ignoreItemResize:Boolean,onScroll:Function,onWheel:Function,onResize:Function,defaultScrollKey:[Number,String],defaultScrollIndex:Number,keyField:{type:String,default:"key"},paddingTop:{type:[Number,String],default:0},paddingBottom:{type:[Number,String],default:0}},setup(e){const n=Te();Ze.mount({id:"vueuc/virtual-list",head:!0,anchorMetaName:Le,ssr:n});const o=X(()=>{if(null==e.renderCol&&null==e.renderItemWithCols)return;if(0===e.columns.length)return;let t=0;return e.columns.forEach(e=>{t+=e.width}),t}),l=g(()=>{const t=new Map,{keyField:n}=e;return e.items.forEach((e,o)=>{t.set(e[n],o)}),t}),{scrollLeftRef:a,listWidthRef:s}=function({columnsRef:e,renderColRef:t,renderItemWithColsRef:n}){const o=v(0),r=v(0),l=g(()=>{const t=e.value;if(0===t.length)return null;const n=new FinweckTree(t.length,0);return t.forEach((e,t)=>{n.add(t,e.width)}),n}),i=X(()=>{const e=l.value;return null!==e?Math.max(e.getBound(r.value)-1,0):0}),a=X(()=>{const t=l.value;return null!==t?Math.min(t.getBound(r.value+o.value)+1,e.value.length-1):0});return m(Ge,{startIndexRef:i,endIndexRef:a,columnsRef:e,renderColRef:t,renderItemWithColsRef:n,getLeft:e=>{const t=l.value;return null!==t?t.sum(e):0}}),{listWidthRef:o,scrollLeftRef:r}}({columnsRef:f(e,"columns"),renderColRef:f(e,"renderCol"),renderItemWithColsRef:f(e,"renderItemWithCols")}),d=v(null),u=v(void 0),c=new Map,p=g(()=>{const{items:t,itemSize:n,keyField:o}=e,r=new FinweckTree(t.length,n);return t.forEach((e,t)=>{const n=e[o],l=c.get(n);void 0!==l&&r.add(t,l)}),r}),h=v(0),b=v(0),w=X(()=>Math.max(p.value.getBound(b.value-t(e.paddingTop))-1,0)),y=g(()=>{const{value:t}=u;if(void 0===t)return[];const{items:n,itemSize:o}=e,r=w.value,l=Math.min(r+Math.ceil(t/o+1),n.length-1),i=[];for(let e=r;e<=l;++e)i.push(n[e]);return i});let x,S=null;function scrollToIndex(n,o,r){const{value:l}=p,i=l.sum(n)+t(e.paddingTop);if(r){x=n,null!==S&&(void 0).clearTimeout(S),S=(void 0).setTimeout(()=>{x=void 0,S=null},16);const{scrollTop:e,offsetHeight:t}=d.value;if(i>e){const r=l.get(n);i+r<=e+t||d.value.scrollTo({left:0,top:i+r-t,behavior:o})}else d.value.scrollTo({left:0,top:i,behavior:o})}else d.value.scrollTo({left:0,top:i,behavior:o})}function scrollToPosition(e,t,n){d.value.scrollTo({left:e,top:t,behavior:n})}let C=!1;function syncViewport(){const{value:e}=d;null!=e&&(b.value=e.scrollTop,a.value=e.scrollLeft)}function isHideByVShow(e){let t=e;for(;null!==t;){if("none"===t.style.display)return!0;t=t.parentElement}return!1}return{listHeight:u,listStyle:{overflow:"auto"},keyToIndex:l,itemsStyle:g(()=>{const{itemResizable:t}=e,n=r(p.value.sum());return h.value,[e.itemsStyle,{boxSizing:"content-box",width:r(o.value),height:t?"":n,minHeight:t?n:"",paddingTop:r(e.paddingTop),paddingBottom:r(e.paddingBottom)}]}),visibleItemsStyle:g(()=>(h.value,{transform:`translateY(${r(p.value.sum(w.value))})`})),viewportItems:y,listElRef:d,itemsElRef:v(null),scrollTo:(e,t)=>{if("number"==typeof e)return void scrollToPosition(e,t,"auto");const{left:n,top:o,index:r,key:i,position:a,behavior:s,debounce:d=!0}=e;if(void 0!==n||void 0!==o)scrollToPosition(n,o,s);else if(void 0!==r)scrollToIndex(r,s,d);else if(void 0!==i){const e=l.value.get(i);void 0!==e&&scrollToIndex(e,s,d)}else"bottom"===a?scrollToPosition(0,Number.MAX_SAFE_INTEGER,s):"top"===a&&scrollToPosition(0,0,s)},handleListResize:function(t){if(isHideByVShow(t.target))return;if(null==e.renderCol&&null==e.renderItemWithCols){if(t.contentRect.height===u.value)return}else if(t.contentRect.height===u.value&&t.contentRect.width===s.value)return;u.value=t.contentRect.height,s.value=t.contentRect.width;const{onResize:n}=e;void 0!==n&&n(t)},handleListScroll:function(t){var n;null===(n=e.onScroll)||void 0===n||n.call(e,t),C||syncViewport()},handleListWheel:function(t){var n;null===(n=e.onWheel)||void 0===n||n.call(e,t);{const e=d.value;if(null!=e){if(0===t.deltaX){if(0===e.scrollTop&&t.deltaY<=0)return;if(e.scrollTop+e.offsetHeight>=e.scrollHeight&&t.deltaY>=0)return}t.preventDefault(),e.scrollTop+=t.deltaY/1,e.scrollLeft+=t.deltaX/1,syncViewport(),C=!0,i(()=>{C=!1})}}},handleItemResize:function(t,n){var o,r,i;if(e.ignoreItemResize)return;if(isHideByVShow(n.target))return;const{value:a}=p,s=l.value.get(t),u=a.get(s),v=null!==(i=null===(r=null===(o=n.borderBoxSize)||void 0===o?void 0:o[0])||void 0===r?void 0:r.blockSize)&&void 0!==i?i:n.contentRect.height;if(v===u)return;0===v-e.itemSize?c.delete(t):c.set(t,v-e.itemSize);const f=v-u;if(0===f)return;a.add(s,f);const g=d.value;if(null!=g){if(void 0===x){const e=a.sum(s);g.scrollTop>e&&g.scrollBy(0,f)}else if(s<x)g.scrollBy(0,f);else if(s===x){v+a.sum(s)>g.scrollTop+g.offsetHeight&&g.scrollBy(0,f)}syncViewport()}h.value++}}},render(){const{itemResizable:e,keyField:t,keyToIndex:n,visibleItemsTag:o}=this;return u(ue,{onResize:this.handleListResize},{default:()=>{var r,l;return u("div",$(this.$attrs,{class:["v-vl",this.showScrollbar&&"v-vl--show-scrollbar"],onScroll:this.handleListScroll,onWheel:this.handleListWheel,ref:"listElRef"}),[0!==this.items.length?u("div",{ref:"itemsElRef",class:"v-vl-items",style:this.itemsStyle},[u(o,Object.assign({class:"v-vl-visible-items",style:this.visibleItemsStyle},this.visibleItemsProps),{default:()=>{const{renderCol:o,renderItemWithCols:r}=this;return this.viewportItems.map(l=>{const i=l[t],a=n.get(i),s=null!=o?u(qe,{index:a,item:l}):void 0,d=null!=r?u(qe,{index:a,item:l}):void 0,c=this.$slots.default({item:l,renderedCols:s,renderedItemWithCols:d,index:a})[0];return e?u(ue,{key:i,onResize:e=>this.handleItemResize(i,e)},{default:()=>c}):(c.key=i,c)})}})]):null===(l=(r=this.$slots).empty)||void 0===l?void 0:l.call(r)])}})}}),Qe="v-hidden",et=Ee("[v-hidden]",{display:"none!important"}),tt=d({name:"Overflow",props:{getCounter:Function,getTail:Function,updateCounter:Function,onUpdateCount:Function,onUpdateOverflow:Function},setup(e,{slots:t}){const n=v(null),o=v(null);const r=Te();return et.mount({id:"vueuc/overflow",head:!0,anchorMetaName:Le,ssr:r}),{selfRef:n,counterRef:o,sync:function(r){const{value:l}=n,{getCounter:i,getTail:a}=e;let s;if(s=void 0!==i?i():o.value,!l||!s)return;s.hasAttribute(Qe)&&s.removeAttribute(Qe);const{children:d}=l;if(r.showAllItemsBeforeCalculate)for(const e of d)e.hasAttribute(Qe)&&e.removeAttribute(Qe);const u=l.offsetWidth,c=[],p=t.tail?null==a?void 0:a():null;let h=p?p.offsetWidth:0,v=!1;const f=l.children.length-(t.tail?1:0);for(let t=0;t<f-1;++t){if(t<0)continue;const n=d[t];if(v){n.hasAttribute(Qe)||n.setAttribute(Qe,"");continue}n.hasAttribute(Qe)&&n.removeAttribute(Qe);const o=n.offsetWidth;if(h+=o,c[t]=o,h>u){const{updateCounter:n}=e;for(let o=t;o>=0;--o){const r=f-1-o;void 0!==n?n(r):s.textContent=`${r}`;const l=s.offsetWidth;if(h-=c[o],h+l<=u||0===o){v=!0,t=o-1,p&&(-1===t?(p.style.maxWidth=u-l+"px",p.style.boxSizing="border-box"):p.style.maxWidth="");const{onUpdateCount:n}=e;n&&n(r);break}}}}const{onUpdateOverflow:g}=e;v?void 0!==g&&g(!0):(void 0!==g&&g(!1),s.setAttribute(Qe,""))}}},render(){const{$slots:e}=this;return S(()=>this.sync({showAllItemsBeforeCalculate:!1})),u("div",{class:"v-overflow",ref:"selfRef"},[C(e,"default"),e.counter?e.counter():u("span",{style:{display:"inline-block"},ref:"counterRef"}),e.tail?e.tail():null])}});function useOnResize(e,t){t&&b(e,(e,t)=>{t&&Xe.unregisterHandler(t)},{deep:!1})}let nt;function getTitleAttribute(e){switch(typeof e){case"string":return e||void 0;case"number":return String(e);default:return}}function mergeEventHandlers(e){const t=e.filter(e=>void 0!==e);if(0!==t.length)return 1===t.length?t[0]:t=>{e.forEach(e=>{e&&e(t)})}}const ot=d({name:"Checkmark",render:()=>u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},u("g",{fill:"none"},u("path",{d:"M14.046 3.486a.75.75 0 0 1-.032 1.06l-7.93 7.474a.85.85 0 0 1-1.188-.022l-2.68-2.72a.75.75 0 1 1 1.068-1.053l2.234 2.267l7.468-7.038a.75.75 0 0 1 1.06.032z",fill:"currentColor"})))}),rt=d({name:"Empty",render:()=>u("svg",{viewBox:"0 0 28 28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},u("path",{d:"M26 7.5C26 11.0899 23.0899 14 19.5 14C15.9101 14 13 11.0899 13 7.5C13 3.91015 15.9101 1 19.5 1C23.0899 1 26 3.91015 26 7.5ZM16.8536 4.14645C16.6583 3.95118 16.3417 3.95118 16.1464 4.14645C15.9512 4.34171 15.9512 4.65829 16.1464 4.85355L18.7929 7.5L16.1464 10.1464C15.9512 10.3417 15.9512 10.6583 16.1464 10.8536C16.3417 11.0488 16.6583 11.0488 16.8536 10.8536L19.5 8.20711L22.1464 10.8536C22.3417 11.0488 22.6583 11.0488 22.8536 10.8536C23.0488 10.6583 23.0488 10.3417 22.8536 10.1464L20.2071 7.5L22.8536 4.85355C23.0488 4.65829 23.0488 4.34171 22.8536 4.14645C22.6583 3.95118 22.3417 3.95118 22.1464 4.14645L19.5 6.79289L16.8536 4.14645Z",fill:"currentColor"}),u("path",{d:"M25 22.75V12.5991C24.5572 13.0765 24.053 13.4961 23.5 13.8454V16H17.5L17.3982 16.0068C17.0322 16.0565 16.75 16.3703 16.75 16.75C16.75 18.2688 15.5188 19.5 14 19.5C12.4812 19.5 11.25 18.2688 11.25 16.75L11.2432 16.6482C11.1935 16.2822 10.8797 16 10.5 16H4.5V7.25C4.5 6.2835 5.2835 5.5 6.25 5.5H12.2696C12.4146 4.97463 12.6153 4.47237 12.865 4H6.25C4.45507 4 3 5.45507 3 7.25V22.75C3 24.5449 4.45507 26 6.25 26H21.75C23.5449 26 25 24.5449 25 22.75ZM4.5 22.75V17.5H9.81597L9.85751 17.7041C10.2905 19.5919 11.9808 21 14 21L14.215 20.9947C16.2095 20.8953 17.842 19.4209 18.184 17.5H23.5V22.75C23.5 23.7165 22.7165 24.5 21.75 24.5H6.25C5.2835 24.5 4.5 23.7165 4.5 22.75Z",fill:"currentColor"}))}),lt=d({props:{onFocus:Function,onBlur:Function},setup:e=>()=>u("div",{style:"width: 0; height: 0",tabindex:0,onFocus:e.onFocus,onBlur:e.onBlur})}),it={iconSizeTiny:"28px",iconSizeSmall:"34px",iconSizeMedium:"40px",iconSizeLarge:"46px",iconSizeHuge:"52px"};const at={name:"Empty",common:j,self:function(e){const{textColorDisabled:t,iconColor:n,textColor2:o,fontSizeTiny:r,fontSizeSmall:l,fontSizeMedium:i,fontSizeLarge:a,fontSizeHuge:s}=e;return Object.assign(Object.assign({},it),{fontSizeTiny:r,fontSizeSmall:l,fontSizeMedium:i,fontSizeLarge:a,fontSizeHuge:s,textColor:t,iconColor:n,extraTextColor:o})}},st=N("empty","\n display: flex;\n flex-direction: column;\n align-items: center;\n font-size: var(--n-font-size);\n",[le("icon","\n width: var(--n-icon-size);\n height: var(--n-icon-size);\n font-size: var(--n-icon-size);\n line-height: var(--n-icon-size);\n color: var(--n-icon-color);\n transition:\n color .3s var(--n-bezier);\n ",[P("+",[le("description","\n margin-top: 8px;\n ")])]),le("description","\n transition: color .3s var(--n-bezier);\n color: var(--n-text-color);\n "),le("extra","\n text-align: center;\n transition: color .3s var(--n-bezier);\n margin-top: 12px;\n color: var(--n-extra-text-color);\n ")]),dt=d({name:"Empty",props:Object.assign(Object.assign({},F.props),{description:String,showDescription:{type:Boolean,default:!0},showIcon:{type:Boolean,default:!0},size:{type:String,default:"medium"},renderIcon:Function}),slots:Object,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:n,mergedComponentPropsRef:o}=R(e),r=F("Empty","-empty",st,at,e,t),{localeRef:l}=ye("Empty"),i=g(()=>{var t,n,r;return null!==(t=e.description)&&void 0!==t?t:null===(r=null===(n=null==o?void 0:o.value)||void 0===n?void 0:n.Empty)||void 0===r?void 0:r.description}),a=g(()=>{var e,t;return(null===(t=null===(e=null==o?void 0:o.value)||void 0===e?void 0:e.Empty)||void 0===t?void 0:t.renderIcon)||(()=>u(rt,null))}),s=g(()=>{const{size:t}=e,{common:{cubicBezierEaseInOut:n},self:{[W("iconSize",t)]:o,[W("fontSize",t)]:l,textColor:i,iconColor:a,extraTextColor:s}}=r.value;return{"--n-icon-size":o,"--n-font-size":l,"--n-bezier":n,"--n-text-color":i,"--n-icon-color":a,"--n-extra-text-color":s}}),d=n?A("empty",g(()=>{let t="";const{size:n}=e;return t+=n[0],t}),s,e):void 0;return{mergedClsPrefix:t,mergedRenderIcon:a,localizedDescription:g(()=>i.value||l.value.description),cssVars:n?void 0:s,themeClass:null==d?void 0:d.themeClass,onRender:null==d?void 0:d.onRender}},render(){const{$slots:e,mergedClsPrefix:t,onRender:n}=this;return null==n||n(),u("div",{class:[`${t}-empty`,this.themeClass],style:this.cssVars},this.showIcon?u("div",{class:`${t}-empty__icon`},e.icon?e.icon():u(L,{clsPrefix:t},{default:this.mergedRenderIcon})):null,this.showDescription?u("div",{class:`${t}-empty__description`},e.default?e.default():this.localizedDescription):null,e.extra?u("div",{class:`${t}-empty__extra`},e.extra()):null)}}),ut={height:"calc(var(--n-option-height) * 7.6)",paddingTiny:"4px 0",paddingSmall:"4px 0",paddingMedium:"4px 0",paddingLarge:"4px 0",paddingHuge:"4px 0",optionPaddingTiny:"0 12px",optionPaddingSmall:"0 12px",optionPaddingMedium:"0 12px",optionPaddingLarge:"0 12px",optionPaddingHuge:"0 12px",loadingSize:"18px"};const ct=B({name:"InternalSelectMenu",common:j,peers:{Scrollbar:ce,Empty:at},self:function(e){const{borderRadius:t,popoverColor:n,textColor3:o,dividerColor:r,textColor2:l,primaryColorPressed:i,textColorDisabled:a,primaryColor:s,opacityDisabled:d,hoverColor:u,fontSizeTiny:c,fontSizeSmall:p,fontSizeMedium:h,fontSizeLarge:v,fontSizeHuge:f,heightTiny:g,heightSmall:b,heightMedium:m,heightLarge:w,heightHuge:y}=e;return Object.assign(Object.assign({},ut),{optionFontSizeTiny:c,optionFontSizeSmall:p,optionFontSizeMedium:h,optionFontSizeLarge:v,optionFontSizeHuge:f,optionHeightTiny:g,optionHeightSmall:b,optionHeightMedium:m,optionHeightLarge:w,optionHeightHuge:y,borderRadius:t,color:n,groupHeaderTextColor:o,actionDividerColor:r,optionTextColor:l,optionTextColorPressed:i,optionTextColorDisabled:a,optionTextColorActive:s,optionOpacityDisabled:d,optionCheckColor:s,optionColorPending:u,optionColorActive:"rgba(0, 0, 0, 0)",optionColorActivePending:u,actionTextColor:l,loadingColor:s})}}),pt=d({name:"NBaseSelectGroupHeader",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(){const{renderLabelRef:e,renderOptionRef:t,labelFieldRef:n,nodePropsRef:o}=y(Oe);return{labelField:n,nodeProps:o,renderLabel:e,renderOption:t}},render(){const{clsPrefix:e,renderLabel:t,renderOption:n,nodeProps:o,tmNode:{rawNode:r}}=this,l=null==o?void 0:o(r),i=t?t(r,!1):V(r[this.labelField],r,!1),a=u("div",Object.assign({},l,{class:[`${e}-base-select-group-header`,null==l?void 0:l.class]}),i);return r.render?r.render({node:a,option:r}):n?n({node:a,option:r,selected:!1}):a}});const ht=d({name:"NBaseSelectOption",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const{valueRef:t,pendingTmNodeRef:n,multipleRef:o,valueSetRef:r,renderLabelRef:l,renderOptionRef:i,labelFieldRef:a,valueFieldRef:s,showCheckmarkRef:d,nodePropsRef:u,handleOptionClick:c,handleOptionMouseEnter:p}=y(Oe),h=X(()=>{const{value:t}=n;return!!t&&e.tmNode.key===t.key});return{multiple:o,isGrouped:X(()=>{const{tmNode:t}=e,{parent:n}=t;return n&&"group"===n.rawNode.type}),showCheckmark:d,nodeProps:u,isPending:h,isSelected:X(()=>{const{value:n}=t,{value:l}=o;if(null===n)return!1;const i=e.tmNode.rawNode[s.value];if(l){const{value:e}=r;return e.has(i)}return n===i}),labelField:a,renderLabel:l,renderOption:i,handleMouseMove:function(t){const{tmNode:n}=e,{value:o}=h;n.disabled||o||p(t,n)},handleMouseEnter:function(t){const{tmNode:n}=e;n.disabled||p(t,n)},handleClick:function(t){const{tmNode:n}=e;n.disabled||c(t,n)}}},render(){const{clsPrefix:e,tmNode:{rawNode:t},isSelected:n,isPending:o,isGrouped:r,showCheckmark:l,nodeProps:i,renderOption:a,renderLabel:s,handleClick:d,handleMouseEnter:p,handleMouseMove:h}=this,v=function(e,t){return u(c,{name:"fade-in-scale-up-transition"},{default:()=>e?u(L,{clsPrefix:t,class:`${t}-base-select-option__check`},{default:()=>u(ot)}):null})}(n,e),f=s?[s(t,n),l&&v]:[V(t[this.labelField],t,n),l&&v],g=null==i?void 0:i(t),b=u("div",Object.assign({},g,{class:[`${e}-base-select-option`,t.class,null==g?void 0:g.class,{[`${e}-base-select-option--disabled`]:t.disabled,[`${e}-base-select-option--selected`]:n,[`${e}-base-select-option--grouped`]:r,[`${e}-base-select-option--pending`]:o,[`${e}-base-select-option--show-checkmark`]:l}],style:[(null==g?void 0:g.style)||"",t.style||""],onClick:mergeEventHandlers([d,null==g?void 0:g.onClick]),onMouseenter:mergeEventHandlers([p,null==g?void 0:g.onMouseenter]),onMousemove:mergeEventHandlers([h,null==g?void 0:g.onMousemove])}),u("div",{class:`${e}-base-select-option__content`},f));return t.render?t.render({node:b,option:t,selected:n}):a?a({node:b,option:t,selected:n}):b}}),vt=N("base-select-menu","\n line-height: 1.5;\n outline: none;\n z-index: 0;\n position: relative;\n border-radius: var(--n-border-radius);\n transition:\n background-color .3s var(--n-bezier),\n box-shadow .3s var(--n-bezier);\n background-color: var(--n-color);\n",[N("scrollbar","\n max-height: var(--n-height);\n "),N("virtual-list","\n max-height: var(--n-height);\n "),N("base-select-option","\n min-height: var(--n-option-height);\n font-size: var(--n-option-font-size);\n display: flex;\n align-items: center;\n ",[le("content","\n z-index: 1;\n white-space: nowrap;\n text-overflow: ellipsis;\n overflow: hidden;\n ")]),N("base-select-group-header","\n min-height: var(--n-option-height);\n font-size: .93em;\n display: flex;\n align-items: center;\n "),N("base-select-menu-option-wrapper","\n position: relative;\n width: 100%;\n "),le("loading, empty","\n display: flex;\n padding: 12px 32px;\n flex: 1;\n justify-content: center;\n "),le("loading","\n color: var(--n-loading-color);\n font-size: var(--n-loading-size);\n "),le("header","\n padding: 8px var(--n-option-padding-left);\n font-size: var(--n-option-font-size);\n transition: \n color .3s var(--n-bezier),\n border-color .3s var(--n-bezier);\n border-bottom: 1px solid var(--n-action-divider-color);\n color: var(--n-action-text-color);\n "),le("action","\n padding: 8px var(--n-option-padding-left);\n font-size: var(--n-option-font-size);\n transition: \n color .3s var(--n-bezier),\n border-color .3s var(--n-bezier);\n border-top: 1px solid var(--n-action-divider-color);\n color: var(--n-action-text-color);\n "),N("base-select-group-header","\n position: relative;\n cursor: default;\n padding: var(--n-option-padding);\n color: var(--n-group-header-text-color);\n "),N("base-select-option","\n cursor: pointer;\n position: relative;\n padding: var(--n-option-padding);\n transition:\n color .3s var(--n-bezier),\n opacity .3s var(--n-bezier);\n box-sizing: border-box;\n color: var(--n-option-text-color);\n opacity: 1;\n ",[de("show-checkmark","\n padding-right: calc(var(--n-option-padding-right) + 20px);\n "),P("&::before",'\n content: "";\n position: absolute;\n left: 4px;\n right: 4px;\n top: 0;\n bottom: 0;\n border-radius: var(--n-border-radius);\n transition: background-color .3s var(--n-bezier);\n '),P("&:active","\n color: var(--n-option-text-color-pressed);\n "),de("grouped","\n padding-left: calc(var(--n-option-padding-left) * 1.5);\n "),de("pending",[P("&::before","\n background-color: var(--n-option-color-pending);\n ")]),de("selected","\n color: var(--n-option-text-color-active);\n ",[P("&::before","\n background-color: var(--n-option-color-active);\n "),de("pending",[P("&::before","\n background-color: var(--n-option-color-active-pending);\n ")])]),de("disabled","\n cursor: not-allowed;\n ",[se("selected","\n color: var(--n-option-text-color-disabled);\n "),de("selected","\n opacity: var(--n-option-opacity-disabled);\n ")]),le("check","\n font-size: 16px;\n position: absolute;\n right: calc(var(--n-option-padding-right) - 4px);\n top: calc(50% - 7px);\n color: var(--n-option-check-color);\n transition: color .3s var(--n-bezier);\n ",[oe({enterScale:"0.5"})])])]),ft=d({name:"InternalSelectMenu",props:Object.assign(Object.assign({},F.props),{clsPrefix:{type:String,required:!0},scrollable:{type:Boolean,default:!0},treeMate:{type:Object,required:!0},multiple:Boolean,size:{type:String,default:"medium"},value:{type:[String,Number,Array],default:null},autoPending:Boolean,virtualScroll:{type:Boolean,default:!0},show:{type:Boolean,default:!0},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},loading:Boolean,focusable:Boolean,renderLabel:Function,renderOption:Function,nodeProps:Function,showCheckmark:{type:Boolean,default:!0},onMousedown:Function,onScroll:Function,onFocus:Function,onBlur:Function,onKeyup:Function,onKeydown:Function,onTabOut:Function,onMouseenter:Function,onMouseleave:Function,onResize:Function,resetMenuOnOptionsChange:{type:Boolean,default:!0},inlineThemeDisabled:Boolean,onToggle:Function}),setup(o){const{mergedClsPrefixRef:r,mergedRtlRef:l}=R(o),i=U("InternalSelectMenu",l,r),a=F("InternalSelectMenu","-internal-select-menu",vt,ct,o,f(o,"clsPrefix")),d=v(null),u=v(null),c=v(null),p=g(()=>o.treeMate.getFlattenedNodes()),h=g(()=>s(p.value)),w=v(null);function clearPendingNodeIfInvalid(){const{value:e}=w;e&&!o.treeMate.getNode(e.key)&&(w.value=null)}let y;b(()=>o.show,e=>{e?y=b(()=>o.treeMate,()=>{o.resetMenuOnOptionsChange?(o.autoPending?function(){const{treeMate:e}=o;let t=null;const{value:n}=o;null===n?t=e.getFirstAvailableNode():(t=o.multiple?e.getNode((n||[])[(n||[]).length-1]):e.getNode(n),t&&!t.disabled||(t=e.getFirstAvailableNode())),setPendingTmNode(t||null)}():clearPendingNodeIfInvalid(),S(scrollToPendingNode)):clearPendingNodeIfInvalid()},{immediate:!0}):null==y||y()},{immediate:!0});const x=g(()=>t(a.value.self[W("optionHeight",o.size)])),C=g(()=>e(a.value.self[W("padding",o.size)])),T=g(()=>o.multiple&&Array.isArray(o.value)?new Set(o.value):new Set),M=g(()=>{const e=p.value;return e&&0===e.length});function doScroll(e){const{onScroll:t}=o;t&&t(e)}function setPendingTmNode(e,t=!1){w.value=e,t&&scrollToPendingNode()}function scrollToPendingNode(){var e,t;const n=w.value;if(!n)return;const r=h.value(n.key);null!==r&&(o.virtualScroll?null===(e=u.value)||void 0===e||e.scrollTo({index:r}):null===(t=c.value)||void 0===t||t.scrollTo({index:r,elSize:x.value}))}m(Oe,{handleOptionMouseEnter:function(e,t){t.disabled||setPendingTmNode(t,!1)},handleOptionClick:function(e,t){t.disabled||function(e){const{onToggle:t}=o;t&&t(e)}(t)},valueSetRef:T,pendingTmNodeRef:w,nodePropsRef:f(o,"nodeProps"),showCheckmarkRef:f(o,"showCheckmark"),multipleRef:f(o,"multiple"),valueRef:f(o,"value"),renderLabelRef:f(o,"renderLabel"),renderOptionRef:f(o,"renderOption"),labelFieldRef:f(o,"labelField"),valueFieldRef:f(o,"valueField")}),m(Re,d);const z=g(()=>{const{size:t}=o,{common:{cubicBezierEaseInOut:n},self:{height:r,borderRadius:l,color:i,groupHeaderTextColor:s,actionDividerColor:d,optionTextColorPressed:u,optionTextColor:c,optionTextColorDisabled:p,optionTextColorActive:h,optionOpacityDisabled:v,optionCheckColor:f,actionTextColor:g,optionColorPending:b,optionColorActive:m,loadingColor:w,loadingSize:y,optionColorActivePending:x,[W("optionFontSize",t)]:S,[W("optionHeight",t)]:C,[W("optionPadding",t)]:T}}=a.value;return{"--n-height":r,"--n-action-divider-color":d,"--n-action-text-color":g,"--n-bezier":n,"--n-border-radius":l,"--n-color":i,"--n-option-font-size":S,"--n-group-header-text-color":s,"--n-option-check-color":f,"--n-option-color-pending":b,"--n-option-color-active":m,"--n-option-color-active-pending":x,"--n-option-height":C,"--n-option-opacity-disabled":v,"--n-option-text-color":c,"--n-option-text-color-active":h,"--n-option-text-color-disabled":p,"--n-option-text-color-pressed":u,"--n-option-padding":T,"--n-option-padding-left":e(T,"left"),"--n-option-padding-right":e(T,"right"),"--n-loading-color":w,"--n-loading-size":y}}),{inlineThemeDisabled:$}=o,O=$?A("internal-select-menu",g(()=>o.size[0]),z,o):void 0,B={selfRef:d,next:function(){const{value:e}=w;e&&setPendingTmNode(e.getNext({loop:!0}),!0)},prev:function(){const{value:e}=w;e&&setPendingTmNode(e.getPrev({loop:!0}),!0)},getPendingTmNode:function(){const{value:e}=w;return e||null}};return useOnResize(d,o.onResize),Object.assign({mergedTheme:a,mergedClsPrefix:r,rtlEnabled:i,virtualListRef:u,scrollbarRef:c,itemSize:x,padding:C,flattenedNodes:p,empty:M,virtualListContainer(){const{value:e}=u;return null==e?void 0:e.listElRef},virtualListContent(){const{value:e}=u;return null==e?void 0:e.itemsElRef},doScroll:doScroll,handleFocusin:function(e){var t,n;(null===(t=d.value)||void 0===t?void 0:t.contains(e.target))&&(null===(n=o.onFocus)||void 0===n||n.call(o,e))},handleFocusout:function(e){var t,n;(null===(t=d.value)||void 0===t?void 0:t.contains(e.relatedTarget))||null===(n=o.onBlur)||void 0===n||n.call(o,e)},handleKeyUp:function(e){var t;n(e,"action")||null===(t=o.onKeyup)||void 0===t||t.call(o,e)},handleKeyDown:function(e){var t;n(e,"action")||null===(t=o.onKeydown)||void 0===t||t.call(o,e)},handleMouseDown:function(e){var t;null===(t=o.onMousedown)||void 0===t||t.call(o,e),o.focusable||e.preventDefault()},handleVirtualListResize:function(){var e;null===(e=c.value)||void 0===e||e.sync()},handleVirtualListScroll:function(e){var t;null===(t=c.value)||void 0===t||t.sync(),doScroll(e)},cssVars:$?void 0:z,themeClass:null==O?void 0:O.themeClass,onRender:null==O?void 0:O.onRender},B)},render(){const{$slots:e,virtualScroll:t,clsPrefix:n,mergedTheme:o,themeClass:r,onRender:l}=this;return null==l||l(),u("div",{ref:"selfRef",tabindex:this.focusable?0:-1,class:[`${n}-base-select-menu`,this.rtlEnabled&&`${n}-base-select-menu--rtl`,r,this.multiple&&`${n}-base-select-menu--multiple`],style:this.cssVars,onFocusin:this.handleFocusin,onFocusout:this.handleFocusout,onKeyup:this.handleKeyUp,onKeydown:this.handleKeyDown,onMousedown:this.handleMouseDown,onMouseenter:this.onMouseenter,onMouseleave:this.onMouseleave},Q(e.header,e=>e&&u("div",{class:`${n}-base-select-menu__header`,"data-header":!0,key:"header"},e)),this.loading?u("div",{class:`${n}-base-select-menu__loading`},u(ee,{clsPrefix:n,strokeWidth:20})):this.empty?u("div",{class:`${n}-base-select-menu__empty`,"data-empty":!0},ne(e.empty,()=>[u(dt,{theme:o.peers.Empty,themeOverrides:o.peerOverrides.Empty,size:this.size})])):u(te,{ref:"scrollbarRef",theme:o.peers.Scrollbar,themeOverrides:o.peerOverrides.Scrollbar,scrollable:this.scrollable,container:t?this.virtualListContainer:void 0,content:t?this.virtualListContent:void 0,onScroll:t?void 0:this.doScroll},{default:()=>t?u(Je,{ref:"virtualListRef",class:`${n}-virtual-list`,items:this.flattenedNodes,itemSize:this.itemSize,showScrollbar:!1,paddingTop:this.padding.top,paddingBottom:this.padding.bottom,onResize:this.handleVirtualListResize,onScroll:this.handleVirtualListScroll,itemResizable:!0},{default:({item:e})=>e.isGroup?u(pt,{key:e.key,clsPrefix:n,tmNode:e}):e.ignored?null:u(ht,{clsPrefix:n,key:e.key,tmNode:e})}):u("div",{class:`${n}-base-select-menu-option-wrapper`,style:{paddingTop:this.padding.top,paddingBottom:this.padding.bottom}},this.flattenedNodes.map(e=>e.isGroup?u(pt,{key:e.key,clsPrefix:n,tmNode:e}):u(ht,{clsPrefix:n,key:e.key,tmNode:e})))}),Q(e.action,e=>e&&[u("div",{class:`${n}-base-select-menu__action`,"data-action":!0,key:"action"},e),u(lt,{onFocus:this.onTabOut,key:"focus-detector"})]))}}),gt={space:"6px",spaceArrow:"10px",arrowOffset:"10px",arrowOffsetVertical:"10px",arrowHeight:"6px",padding:"8px 14px"};const bt=B({name:"Popover",common:j,peers:{Scrollbar:ce},self:function(e){const{boxShadow2:t,popoverColor:n,textColor2:o,borderRadius:r,fontSize:l,dividerColor:i}=e;return Object.assign(Object.assign({},gt),{fontSize:l,borderRadius:r,color:n,dividerColor:i,textColor:o,boxShadow:t})}}),mt={top:"bottom",bottom:"top",left:"right",right:"left"},wt="var(--n-arrow-height) * 1.414",yt=P([N("popover","\n transition:\n box-shadow .3s var(--n-bezier),\n background-color .3s var(--n-bezier),\n color .3s var(--n-bezier);\n position: relative;\n font-size: var(--n-font-size);\n color: var(--n-text-color);\n box-shadow: var(--n-box-shadow);\n word-break: break-word;\n ",[P(">",[N("scrollbar","\n height: inherit;\n max-height: inherit;\n ")]),se("raw","\n background-color: var(--n-color);\n border-radius: var(--n-border-radius);\n ",[se("scrollable",[se("show-header-or-footer","padding: var(--n-padding);")])]),le("header","\n padding: var(--n-padding);\n border-bottom: 1px solid var(--n-divider-color);\n transition: border-color .3s var(--n-bezier);\n "),le("footer","\n padding: var(--n-padding);\n border-top: 1px solid var(--n-divider-color);\n transition: border-color .3s var(--n-bezier);\n "),de("scrollable, show-header-or-footer",[le("content","\n padding: var(--n-padding);\n ")])]),N("popover-shared","\n transform-origin: inherit;\n ",[N("popover-arrow-wrapper","\n position: absolute;\n overflow: hidden;\n pointer-events: none;\n ",[N("popover-arrow",`\n transition: background-color .3s var(--n-bezier);\n position: absolute;\n display: block;\n width: calc(${wt});\n height: calc(${wt});\n box-shadow: 0 0 8px 0 rgba(0, 0, 0, .12);\n transform: rotate(45deg);\n background-color: var(--n-color);\n pointer-events: all;\n `)]),P("&.popover-transition-enter-from, &.popover-transition-leave-to","\n opacity: 0;\n transform: scale(.85);\n "),P("&.popover-transition-enter-to, &.popover-transition-leave-from","\n transform: scale(1);\n opacity: 1;\n "),P("&.popover-transition-enter-active","\n transition:\n box-shadow .3s var(--n-bezier),\n background-color .3s var(--n-bezier),\n color .3s var(--n-bezier),\n opacity .15s var(--n-bezier-ease-out),\n transform .15s var(--n-bezier-ease-out);\n "),P("&.popover-transition-leave-active","\n transition:\n box-shadow .3s var(--n-bezier),\n background-color .3s var(--n-bezier),\n color .3s var(--n-bezier),\n opacity .15s var(--n-bezier-ease-in),\n transform .15s var(--n-bezier-ease-in);\n ")]),placementStyle("top-start",`\n top: calc(${wt} / -2);\n left: calc(${getArrowOffset("top-start")} - var(--v-offset-left));\n `),placementStyle("top",`\n top: calc(${wt} / -2);\n transform: translateX(calc(${wt} / -2)) rotate(45deg);\n left: 50%;\n `),placementStyle("top-end",`\n top: calc(${wt} / -2);\n right: calc(${getArrowOffset("top-end")} + var(--v-offset-left));\n `),placementStyle("bottom-start",`\n bottom: calc(${wt} / -2);\n left: calc(${getArrowOffset("bottom-start")} - var(--v-offset-left));\n `),placementStyle("bottom",`\n bottom: calc(${wt} / -2);\n transform: translateX(calc(${wt} / -2)) rotate(45deg);\n left: 50%;\n `),placementStyle("bottom-end",`\n bottom: calc(${wt} / -2);\n right: calc(${getArrowOffset("bottom-end")} + var(--v-offset-left));\n `),placementStyle("left-start",`\n left: calc(${wt} / -2);\n top: calc(${getArrowOffset("left-start")} - var(--v-offset-top));\n `),placementStyle("left",`\n left: calc(${wt} / -2);\n transform: translateY(calc(${wt} / -2)) rotate(45deg);\n top: 50%;\n `),placementStyle("left-end",`\n left: calc(${wt} / -2);\n bottom: calc(${getArrowOffset("left-end")} + var(--v-offset-top));\n `),placementStyle("right-start",`\n right: calc(${wt} / -2);\n top: calc(${getArrowOffset("right-start")} - var(--v-offset-top));\n `),placementStyle("right",`\n right: calc(${wt} / -2);\n transform: translateY(calc(${wt} / -2)) rotate(45deg);\n top: 50%;\n `),placementStyle("right-end",`\n right: calc(${wt} / -2);\n bottom: calc(${getArrowOffset("right-end")} + var(--v-offset-top));\n `),...ze({top:["right-start","left-start"],right:["top-end","bottom-end"],bottom:["right-end","left-end"],left:["top-start","bottom-start"]},(e,t)=>{const n=["right","left"].includes(t),o=n?"width":"height";return e.map(e=>{const r="end"===e.split("-")[1],l=`calc((${`var(--v-target-${o}, 0px)`} - ${wt}) / 2)`,i=getArrowOffset(e);return P(`[v-placement="${e}"] >`,[N("popover-shared",[de("center-arrow",[N("popover-arrow",`${t}: calc(max(${l}, ${i}) ${r?"+":"-"} var(--v-offset-${n?"left":"top"}));`)])])])})})]);function getArrowOffset(e){return["top","bottom"].includes(e.split("-")[0])?"var(--n-arrow-offset)":"var(--n-arrow-offset-vertical)"}function placementStyle(e,t){const n=e.split("-")[0],o=["top","bottom"].includes(n)?"height: var(--n-space-arrow);":"width: var(--n-space-arrow);";return P(`[v-placement="${e}"] >`,[N("popover-shared",`\n margin-${mt[n]}: var(--n-space);\n `,[de("show-arrow",`\n margin-${mt[n]}: var(--n-space-arrow);\n `),de("overlap","\n margin: 0;\n "),fe("popover-arrow-wrapper",`\n right: 0;\n left: 0;\n top: 0;\n bottom: 0;\n ${n}: 100%;\n ${mt[n]}: auto;\n ${o}\n `,[N("popover-arrow",t)])])])}const xt=Object.assign(Object.assign({},F.props),{to:useAdjustedTo.propTo,show:Boolean,trigger:String,showArrow:Boolean,delay:Number,duration:Number,raw:Boolean,arrowPointToCenter:Boolean,arrowClass:String,arrowStyle:[String,Object],arrowWrapperClass:String,arrowWrapperStyle:[String,Object],displayDirective:String,x:Number,y:Number,flip:Boolean,overlap:Boolean,placement:String,width:[Number,String],keepAliveOnHover:Boolean,scrollable:Boolean,contentClass:String,contentStyle:[Object,String],headerClass:String,headerStyle:[Object,String],footerClass:String,footerStyle:[Object,String],internalDeactivateImmediately:Boolean,animated:Boolean,onClickoutside:Function,internalTrapFocus:Boolean,internalOnAfterLeave:Function,minWidth:Number,maxWidth:Number});function renderArrow({arrowClass:e,arrowStyle:t,arrowWrapperClass:n,arrowWrapperStyle:o,clsPrefix:r}){return u("div",{key:"__popover-arrow__",style:o,class:[`${r}-popover-arrow-wrapper`,n]},u("div",{class:[`${r}-popover-arrow`,e],style:t}))}const St=d({name:"PopoverBody",inheritAttrs:!1,props:xt,setup(e,{slots:t,attrs:n}){const{namespaceRef:r,mergedClsPrefixRef:l,inlineThemeDisabled:i,mergedRtlRef:a}=R(e),s=F("Popover","-popover",yt,bt,e,l),d=U("Popover",a,l),c=v(null),w=y("NPopover"),S=v(null),C=v(e.show),T=v(!1);z(()=>{const{show:t}=e;!t||(void 0===nt&&(nt=(void 0).userAgent.includes("Node.js")||(void 0).userAgent.includes("jsdom")),nt)||e.internalDeactivateImmediately||(T.value=!0)});const M=g(()=>{const{trigger:t,onClickoutside:n}=e,o=[],{positionManuallyRef:{value:r}}=w;return r||("click"!==t||n||o.push([O,handleClickOutside,void 0,{capture:!0}]),"hover"===t&&o.push([Ae,handleMouseMoveOutside])),n&&o.push([O,handleClickOutside,void 0,{capture:!0}]),("show"===e.displayDirective||e.animated&&T.value)&&o.push([h,e.show]),o}),B=g(()=>{const{common:{cubicBezierEaseInOut:e,cubicBezierEaseIn:t,cubicBezierEaseOut:n},self:{space:o,spaceArrow:r,padding:l,fontSize:i,textColor:a,dividerColor:d,color:u,boxShadow:c,borderRadius:p,arrowHeight:h,arrowOffset:v,arrowOffsetVertical:f}}=s.value;return{"--n-box-shadow":c,"--n-bezier":e,"--n-bezier-ease-in":t,"--n-bezier-ease-out":n,"--n-font-size":i,"--n-text-color":a,"--n-color":u,"--n-divider-color":d,"--n-border-radius":p,"--n-arrow-height":h,"--n-arrow-offset":v,"--n-arrow-offset-vertical":f,"--n-padding":l,"--n-space":o,"--n-space-arrow":r}}),P=g(()=>{const t="trigger"===e.width?void 0:Se(e.width),n=[];t&&n.push({width:t});const{maxWidth:o,minWidth:r}=e;return o&&n.push({maxWidth:Se(o)}),r&&n.push({maxWidth:Se(r)}),i||n.push(B.value),n}),I=i?A("popover",void 0,B,e):void 0;function handleMouseEnter(t){"hover"===e.trigger&&e.keepAliveOnHover&&e.show&&w.handleMouseEnter(t)}function handleMouseLeave(t){"hover"===e.trigger&&e.keepAliveOnHover&&w.handleMouseLeave(t)}function handleMouseMoveOutside(t){"hover"!==e.trigger||getTriggerElement().contains(o(t))||w.handleMouseMoveOutside(t)}function handleClickOutside(t){("click"===e.trigger&&!getTriggerElement().contains(o(t))||e.onClickoutside)&&w.handleClickOutside(t)}function getTriggerElement(){return w.getTriggerElement()}return w.setBodyInstance({syncPosition:function(){var e;null===(e=c.value)||void 0===e||e.syncPosition()}}),b(f(e,"show"),t=>{e.animated||(C.value=!!t)}),m(Z,S),m(q,null),m(G,null),{displayed:T,namespace:r,isMounted:w.isMountedRef,zIndex:w.zIndexRef,followerRef:c,adjustedTo:useAdjustedTo(e),followerEnabled:C,renderContentNode:function(){if(null==I||I.onRender(),!("show"===e.displayDirective||e.show||e.animated&&T.value))return null;let o;const r=w.internalRenderBodyRef.value,{value:i}=l;if(r)o=r([`${i}-popover-shared`,(null==d?void 0:d.value)&&`${i}-popover--rtl`,null==I?void 0:I.themeClass.value,e.overlap&&`${i}-popover-shared--overlap`,e.showArrow&&`${i}-popover-shared--show-arrow`,e.arrowPointToCenter&&`${i}-popover-shared--center-arrow`],S,P.value,handleMouseEnter,handleMouseLeave);else{const{value:r}=w.extraClassRef,{internalTrapFocus:l}=e,a=!he(t.header)||!he(t.footer),renderContentInnerNode=()=>{var n,o;const r=a?u(x,null,Q(t.header,t=>t?u("div",{class:[`${i}-popover__header`,e.headerClass],style:e.headerStyle},t):null),Q(t.default,n=>n?u("div",{class:[`${i}-popover__content`,e.contentClass],style:e.contentStyle},t):null),Q(t.footer,t=>t?u("div",{class:[`${i}-popover__footer`,e.footerClass],style:e.footerStyle},t):null)):e.scrollable?null===(n=t.default)||void 0===n?void 0:n.call(t):u("div",{class:[`${i}-popover__content`,e.contentClass],style:e.contentStyle},t);return[e.scrollable?u(ge,{themeOverrides:s.value.peerOverrides.Scrollbar,theme:s.value.peers.Scrollbar,contentClass:a?void 0:`${i}-popover__content ${null!==(o=e.contentClass)&&void 0!==o?o:""}`,contentStyle:a?void 0:e.contentStyle},{default:()=>r}):r,e.showArrow?renderArrow({arrowClass:e.arrowClass,arrowStyle:e.arrowStyle,arrowWrapperClass:e.arrowWrapperClass,arrowWrapperStyle:e.arrowWrapperStyle,clsPrefix:i}):null]};o=u("div",$({class:[`${i}-popover`,`${i}-popover-shared`,(null==d?void 0:d.value)&&`${i}-popover--rtl`,null==I?void 0:I.themeClass.value,r.map(e=>`${i}-${e}`),{[`${i}-popover--scrollable`]:e.scrollable,[`${i}-popover--show-header-or-footer`]:a,[`${i}-popover--raw`]:e.raw,[`${i}-popover-shared--overlap`]:e.overlap,[`${i}-popover-shared--show-arrow`]:e.showArrow,[`${i}-popover-shared--center-arrow`]:e.arrowPointToCenter}],ref:S,style:P.value,onKeydown:w.handleKeydown,onMouseenter:handleMouseEnter,onMouseleave:handleMouseLeave},n),l?u(ve,{active:e.show,autoFocus:!0},{default:renderContentInnerNode}):renderContentInnerNode())}return p(o,M.value)}}},render(){return u(Ye,{ref:"followerRef",zIndex:this.zIndex,show:this.show,enabled:this.followerEnabled,to:this.adjustedTo,x:this.x,y:this.y,flip:this.flip,placement:this.placement,containerClass:this.namespace,overlap:this.overlap,width:"trigger"===this.width?"target":void 0,teleportDisabled:this.adjustedTo===useAdjustedTo.tdkey},{default:()=>this.animated?u(c,{name:"popover-transition",appear:this.isMounted,onEnter:()=>{this.followerEnabled=!0},onAfterLeave:()=>{var e;null===(e=this.internalOnAfterLeave)||void 0===e||e.call(this),this.followerEnabled=!1,this.displayed=!1}},{default:this.renderContentNode}):this.renderContentNode()})}}),Ct=Object.keys(xt),Tt={focus:["onFocus","onBlur"],click:["onClick"],hover:["onMouseenter","onMouseleave"],manual:[],nested:["onFocus","onBlur","onMouseenter","onMouseleave","onClick"]};const Mt={show:{type:Boolean,default:void 0},defaultShow:Boolean,showArrow:{type:Boolean,default:!0},trigger:{type:String,default:"hover"},delay:{type:Number,default:100},duration:{type:Number,default:100},raw:Boolean,placement:{type:String,default:"top"},x:Number,y:Number,arrowPointToCenter:Boolean,disabled:Boolean,getDisabled:Function,displayDirective:{type:String,default:"if"},arrowClass:String,arrowStyle:[String,Object],arrowWrapperClass:String,arrowWrapperStyle:[String,Object],flip:{type:Boolean,default:!0},animated:{type:Boolean,default:!0},width:{type:[Number,String],default:void 0},overlap:Boolean,keepAliveOnHover:{type:Boolean,default:!0},zIndex:Number,to:useAdjustedTo.propTo,scrollable:Boolean,contentClass:String,contentStyle:[Object,String],headerClass:String,headerStyle:[Object,String],footerClass:String,footerStyle:[Object,String],onClickoutside:Function,"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],internalDeactivateImmediately:Boolean,internalSyncTargetWithParent:Boolean,internalInheritedEventHandlers:{type:Array,default:()=>[]},internalTrapFocus:Boolean,internalExtraClass:{type:Array,default:()=>[]},onShow:[Function,Array],onHide:[Function,Array],arrow:{type:Boolean,default:void 0},minWidth:Number,maxWidth:Number},zt=d({name:"Popover",inheritAttrs:!1,props:Object.assign(Object.assign(Object.assign({},F.props),Mt),{internalOnAfterLeave:Function,internalRenderBody:Function}),slots:Object,__popover__:!0,setup(e){const t=E(),n=v(null),o=g(()=>e.show),r=v(e.defaultShow),l=we(o,r),i=X(()=>!e.disabled&&l.value),getMergedDisabled=()=>{if(e.disabled)return!0;const{getDisabled:t}=e;return!!(null==t?void 0:t())},getMergedShow=()=>!getMergedDisabled()&&l.value,a=I(e,["arrow","showArrow"]),s=g(()=>!e.overlap&&a.value);let d=null;const u=v(null),c=v(null),p=X(()=>void 0!==e.x&&void 0!==e.y);function doUpdateShow(t){const{"onUpdate:show":n,onUpdateShow:o,onShow:l,onHide:i}=e;r.value=t,n&&pe(n,t),o&&pe(o,t),t&&l&&pe(l,!0),t&&i&&pe(i,!1)}function clearShowTimer(){const{value:e}=u;e&&((void 0).clearTimeout(e),u.value=null)}function clearHideTimer(){const{value:e}=c;e&&((void 0).clearTimeout(e),c.value=null)}function handleMouseEnter(){const t=getMergedDisabled();if("hover"===e.trigger&&!t){if(clearHideTimer(),null!==u.value)return;if(getMergedShow())return;const delayCallback=()=>{doUpdateShow(!0),u.value=null},{delay:t}=e;0===t?delayCallback():u.value=(void 0).setTimeout(delayCallback,t)}}function handleMouseLeave(){const t=getMergedDisabled();if("hover"===e.trigger&&!t){if(clearShowTimer(),null!==c.value)return;if(!getMergedShow())return;const delayedCallback=()=>{doUpdateShow(!1),c.value=null},{duration:t}=e;0===t?delayedCallback():c.value=(void 0).setTimeout(delayedCallback,t)}}m("NPopover",{getTriggerElement:function(){var e;return null===(e=n.value)||void 0===e?void 0:e.targetRef},handleKeydown:function(t){e.internalTrapFocus&&"Escape"===t.key&&(clearShowTimer(),clearHideTimer(),doUpdateShow(!1))},handleMouseEnter:handleMouseEnter,handleMouseLeave:handleMouseLeave,handleClickOutside:function(t){var n;getMergedShow()&&("click"===e.trigger&&(clearShowTimer(),clearHideTimer(),doUpdateShow(!1)),null===(n=e.onClickoutside)||void 0===n||n.call(e,t))},handleMouseMoveOutside:function(){handleMouseLeave()},setBodyInstance:function(e){d=e},positionManuallyRef:p,isMountedRef:t,zIndexRef:f(e,"zIndex"),extraClassRef:f(e,"internalExtraClass"),internalRenderBodyRef:f(e,"internalRenderBody")}),z(()=>{l.value&&getMergedDisabled()&&doUpdateShow(!1)});return{binderInstRef:n,positionManually:p,mergedShowConsideringDisabledProp:i,uncontrolledShow:r,mergedShowArrow:s,getMergedShow:getMergedShow,setShow:function(e){r.value=e},handleClick:function(){if("click"===e.trigger&&!getMergedDisabled()){clearShowTimer(),clearHideTimer();doUpdateShow(!getMergedShow())}},handleMouseEnter:handleMouseEnter,handleMouseLeave:handleMouseLeave,handleFocus:function(){const t=getMergedDisabled();if("focus"===e.trigger&&!t){if(getMergedShow())return;doUpdateShow(!0)}},handleBlur:function(){const t=getMergedDisabled();if("focus"===e.trigger&&!t){if(!getMergedShow())return;doUpdateShow(!1)}},syncPosition:function(){d&&d.syncPosition()}}},render(){var e;const{positionManually:t,$slots:n}=this;let o,r=!1;if(!t&&(o=ie(n,"trigger"),o)){o=T(o),o=o.type===M?u("span",[o]):o;const n={onClick:this.handleClick,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onFocus:this.handleFocus,onBlur:this.handleBlur};if(null===(e=o.type)||void 0===e?void 0:e.__popover__)r=!0,o.props||(o.props={internalSyncTargetWithParent:!0,internalInheritedEventHandlers:[]}),o.props.internalSyncTargetWithParent=!0,o.props.internalInheritedEventHandlers?o.props.internalInheritedEventHandlers=[n,...o.props.internalInheritedEventHandlers]:o.props.internalInheritedEventHandlers=[n];else{const{internalInheritedEventHandlers:e}=this,r=[n,...e],s={onBlur:e=>{r.forEach(t=>{t.onBlur(e)})},onFocus:e=>{r.forEach(t=>{t.onFocus(e)})},onClick:e=>{r.forEach(t=>{t.onClick(e)})},onMouseenter:e=>{r.forEach(t=>{t.onMouseenter(e)})},onMouseleave:e=>{r.forEach(t=>{t.onMouseleave(e)})}};l=o,i=e?"nested":t?"manual":this.trigger,a=s,Tt[i].forEach(e=>{l.props?l.props=Object.assign({},l.props):l.props={};const t=l.props[e],n=a[e];l.props[e]=t?(...e)=>{t(...e),n(...e)}:n})}}var l,i,a;return u(Pe,{ref:"binderInstRef",syncTarget:!r,syncTargetWithParent:this.internalSyncTargetWithParent},{default:()=>{this.mergedShowConsideringDisabledProp;const e=this.getMergedShow();return[this.internalTrapFocus&&e?p(u("div",{style:{position:"fixed",top:0,right:0,bottom:0,left:0}}),[[Y,{enabled:e,zIndex:this.zIndex}]]):null,t?null:u(Ie,null,{default:()=>o}),u(St,ae(this.$props,Ct,Object.assign(Object.assign({},this.$attrs),{showArrow:this.mergedShowArrow,show:e})),{default:()=>{var e,t;return null===(t=(e=this.$slots).default)||void 0===t?void 0:t.call(e)},header:()=>{var e,t;return null===(t=(e=this.$slots).header)||void 0===t?void 0:t.call(e)},footer:()=>{var e,t;return null===(t=(e=this.$slots).footer)||void 0===t?void 0:t.call(e)}})]}})}}),$t={paddingSingle:"0 26px 0 12px",paddingMultiple:"3px 26px 0 12px",clearSize:"16px",arrowSize:"16px"};const Ot=B({name:"InternalSelection",common:j,peers:{Popover:bt},self:function(e){const{borderRadius:t,textColor2:n,textColorDisabled:o,inputColor:r,inputColorDisabled:i,primaryColor:a,primaryColorHover:s,warningColor:d,warningColorHover:u,errorColor:c,errorColorHover:p,borderColor:h,iconColor:v,iconColorDisabled:f,clearColor:g,clearColorHover:b,clearColorPressed:m,placeholderColor:w,placeholderColorDisabled:y,fontSizeTiny:x,fontSizeSmall:S,fontSizeMedium:C,fontSizeLarge:T,heightTiny:M,heightSmall:z,heightMedium:$,heightLarge:O,fontWeight:R}=e;return Object.assign(Object.assign({},$t),{fontSizeTiny:x,fontSizeSmall:S,fontSizeMedium:C,fontSizeLarge:T,heightTiny:M,heightSmall:z,heightMedium:$,heightLarge:O,borderRadius:t,fontWeight:R,textColor:n,textColorDisabled:o,placeholderColor:w,placeholderColorDisabled:y,color:r,colorDisabled:i,colorActive:r,border:`1px solid ${h}`,borderHover:`1px solid ${s}`,borderActive:`1px solid ${a}`,borderFocus:`1px solid ${s}`,boxShadowHover:"none",boxShadowActive:`0 0 0 2px ${l(a,{alpha:.2})}`,boxShadowFocus:`0 0 0 2px ${l(a,{alpha:.2})}`,caretColor:a,arrowColor:v,arrowColorDisabled:f,loadingColor:a,borderWarning:`1px solid ${d}`,borderHoverWarning:`1px solid ${u}`,borderActiveWarning:`1px solid ${d}`,borderFocusWarning:`1px solid ${u}`,boxShadowHoverWarning:"none",boxShadowActiveWarning:`0 0 0 2px ${l(d,{alpha:.2})}`,boxShadowFocusWarning:`0 0 0 2px ${l(d,{alpha:.2})}`,colorActiveWarning:r,caretColorWarning:d,borderError:`1px solid ${c}`,borderHoverError:`1px solid ${p}`,borderActiveError:`1px solid ${c}`,borderFocusError:`1px solid ${p}`,boxShadowHoverError:"none",boxShadowActiveError:`0 0 0 2px ${l(c,{alpha:.2})}`,boxShadowFocusError:`0 0 0 2px ${l(c,{alpha:.2})}`,colorActiveError:r,caretColorError:c,clearColor:g,clearColorHover:b,clearColorPressed:m})}}),Rt=P([N("base-selection","\n --n-padding-single: var(--n-padding-single-top) var(--n-padding-single-right) var(--n-padding-single-bottom) var(--n-padding-single-left);\n --n-padding-multiple: var(--n-padding-multiple-top) var(--n-padding-multiple-right) var(--n-padding-multiple-bottom) var(--n-padding-multiple-left);\n position: relative;\n z-index: auto;\n box-shadow: none;\n width: 100%;\n max-width: 100%;\n display: inline-block;\n vertical-align: bottom;\n border-radius: var(--n-border-radius);\n min-height: var(--n-height);\n line-height: 1.5;\n font-size: var(--n-font-size);\n ",[N("base-loading","\n color: var(--n-loading-color);\n "),N("base-selection-tags","min-height: var(--n-height);"),le("border, state-border","\n position: absolute;\n left: 0;\n right: 0;\n top: 0;\n bottom: 0;\n pointer-events: none;\n border: var(--n-border);\n border-radius: inherit;\n transition:\n box-shadow .3s var(--n-bezier),\n border-color .3s var(--n-bezier);\n "),le("state-border","\n z-index: 1;\n border-color: #0000;\n "),N("base-suffix","\n cursor: pointer;\n position: absolute;\n top: 50%;\n transform: translateY(-50%);\n right: 10px;\n ",[le("arrow","\n font-size: var(--n-arrow-size);\n color: var(--n-arrow-color);\n transition: color .3s var(--n-bezier);\n ")]),N("base-selection-overlay","\n display: flex;\n align-items: center;\n white-space: nowrap;\n pointer-events: none;\n position: absolute;\n top: 0;\n right: 0;\n bottom: 0;\n left: 0;\n padding: var(--n-padding-single);\n transition: color .3s var(--n-bezier);\n ",[le("wrapper","\n flex-basis: 0;\n flex-grow: 1;\n overflow: hidden;\n text-overflow: ellipsis;\n ")]),N("base-selection-placeholder","\n color: var(--n-placeholder-color);\n ",[le("inner","\n max-width: 100%;\n overflow: hidden;\n ")]),N("base-selection-tags","\n cursor: pointer;\n outline: none;\n box-sizing: border-box;\n position: relative;\n z-index: auto;\n display: flex;\n padding: var(--n-padding-multiple);\n flex-wrap: wrap;\n align-items: center;\n width: 100%;\n vertical-align: bottom;\n background-color: var(--n-color);\n border-radius: inherit;\n transition:\n color .3s var(--n-bezier),\n box-shadow .3s var(--n-bezier),\n background-color .3s var(--n-bezier);\n "),N("base-selection-label","\n height: var(--n-height);\n display: inline-flex;\n width: 100%;\n vertical-align: bottom;\n cursor: pointer;\n outline: none;\n z-index: auto;\n box-sizing: border-box;\n position: relative;\n transition:\n color .3s var(--n-bezier),\n box-shadow .3s var(--n-bezier),\n background-color .3s var(--n-bezier);\n border-radius: inherit;\n background-color: var(--n-color);\n align-items: center;\n ",[N("base-selection-input","\n font-size: inherit;\n line-height: inherit;\n outline: none;\n cursor: pointer;\n box-sizing: border-box;\n border:none;\n width: 100%;\n padding: var(--n-padding-single);\n background-color: #0000;\n color: var(--n-text-color);\n transition: color .3s var(--n-bezier);\n caret-color: var(--n-caret-color);\n ",[le("content","\n text-overflow: ellipsis;\n overflow: hidden;\n white-space: nowrap; \n ")]),le("render-label","\n color: var(--n-text-color);\n ")]),se("disabled",[P("&:hover",[le("state-border","\n box-shadow: var(--n-box-shadow-hover);\n border: var(--n-border-hover);\n ")]),de("focus",[le("state-border","\n box-shadow: var(--n-box-shadow-focus);\n border: var(--n-border-focus);\n ")]),de("active",[le("state-border","\n box-shadow: var(--n-box-shadow-active);\n border: var(--n-border-active);\n "),N("base-selection-label","background-color: var(--n-color-active);"),N("base-selection-tags","background-color: var(--n-color-active);")])]),de("disabled","cursor: not-allowed;",[le("arrow","\n color: var(--n-arrow-color-disabled);\n "),N("base-selection-label","\n cursor: not-allowed;\n background-color: var(--n-color-disabled);\n ",[N("base-selection-input","\n cursor: not-allowed;\n color: var(--n-text-color-disabled);\n "),le("render-label","\n color: var(--n-text-color-disabled);\n ")]),N("base-selection-tags","\n cursor: not-allowed;\n background-color: var(--n-color-disabled);\n "),N("base-selection-placeholder","\n cursor: not-allowed;\n color: var(--n-placeholder-color-disabled);\n ")]),N("base-selection-input-tag","\n height: calc(var(--n-height) - 6px);\n line-height: calc(var(--n-height) - 6px);\n outline: none;\n display: none;\n position: relative;\n margin-bottom: 3px;\n max-width: 100%;\n vertical-align: bottom;\n ",[le("input","\n font-size: inherit;\n font-family: inherit;\n min-width: 1px;\n padding: 0;\n background-color: #0000;\n outline: none;\n border: none;\n max-width: 100%;\n overflow: hidden;\n width: 1em;\n line-height: inherit;\n cursor: pointer;\n color: var(--n-text-color);\n caret-color: var(--n-caret-color);\n "),le("mirror","\n position: absolute;\n left: 0;\n top: 0;\n white-space: pre;\n visibility: hidden;\n user-select: none;\n -webkit-user-select: none;\n opacity: 0;\n ")]),["warning","error"].map(e=>de(`${e}-status`,[le("state-border",`border: var(--n-border-${e});`),se("disabled",[P("&:hover",[le("state-border",`\n box-shadow: var(--n-box-shadow-hover-${e});\n border: var(--n-border-hover-${e});\n `)]),de("active",[le("state-border",`\n box-shadow: var(--n-box-shadow-active-${e});\n border: var(--n-border-active-${e});\n `),N("base-selection-label",`background-color: var(--n-color-active-${e});`),N("base-selection-tags",`background-color: var(--n-color-active-${e});`)]),de("focus",[le("state-border",`\n box-shadow: var(--n-box-shadow-focus-${e});\n border: var(--n-border-focus-${e});\n `)])])]))]),N("base-selection-popover","\n margin-bottom: -3px;\n display: flex;\n flex-wrap: wrap;\n margin-right: -8px;\n "),N("base-selection-tag-wrapper","\n max-width: 100%;\n display: inline-flex;\n padding: 0 7px 3px 0;\n ",[P("&:last-child","padding-right: 0;"),N("tag","\n font-size: 14px;\n max-width: 100%;\n ",[le("content","\n line-height: 1.25;\n text-overflow: ellipsis;\n overflow: hidden;\n ")])])]),Ft=d({name:"InternalSelection",props:Object.assign(Object.assign({},F.props),{clsPrefix:{type:String,required:!0},bordered:{type:Boolean,default:void 0},active:Boolean,pattern:{type:String,default:""},placeholder:String,selectedOption:{type:Object,default:null},selectedOptions:{type:Array,default:null},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},multiple:Boolean,filterable:Boolean,clearable:Boolean,disabled:Boolean,size:{type:String,default:"medium"},loading:Boolean,autofocus:Boolean,showArrow:{type:Boolean,default:!0},inputProps:Object,focused:Boolean,renderTag:Function,onKeydown:Function,onClick:Function,onBlur:Function,onFocus:Function,onDeleteOption:Function,maxTagCount:[String,Number],ellipsisTagPopoverProps:Object,onClear:Function,onPatternInput:Function,onPatternFocus:Function,onPatternBlur:Function,renderLabel:Function,status:String,inlineThemeDisabled:Boolean,ignoreComposition:{type:Boolean,default:!0},onResize:Function}),setup(t){const{mergedClsPrefixRef:n,mergedRtlRef:o}=R(t),r=U("InternalSelection",o,n),l=v(null),i=v(null),a=v(null),s=v(null),d=v(null),u=v(null),c=v(null),p=v(null),h=v(null),m=v(null),w=v(!1),y=v(!1),x=v(!1),C=F("InternalSelection","-internal-selection",Rt,Ot,t,f(t,"clsPrefix")),T=g(()=>t.clearable&&!t.disabled&&(x.value||t.active)),M=g(()=>t.selectedOption?t.renderTag?t.renderTag({option:t.selectedOption,handleClose:()=>{}}):t.renderLabel?t.renderLabel(t.selectedOption,!0):V(t.selectedOption[t.labelField],t.selectedOption,!0):t.placeholder),z=g(()=>{const e=t.selectedOption;if(e)return e[t.labelField]}),$=g(()=>t.multiple?!(!Array.isArray(t.selectedOptions)||!t.selectedOptions.length):null!==t.selectedOption);function syncMirrorWidth(){var e;const{value:n}=l;if(n){const{value:o}=i;o&&(o.style.width=`${n.offsetWidth}px`,"responsive"!==t.maxTagCount&&(null===(e=h.value)||void 0===e||e.sync({showAllItemsBeforeCalculate:!1})))}}function doPatternInput(e){const{onPatternInput:n}=t;n&&n(e)}function handleDeleteOption(e){!function(e){const{onDeleteOption:n}=t;n&&n(e)}(e)}b(f(t,"active"),e=>{e||function(){const{value:e}=m;e&&(e.style.display="none")}()}),b(f(t,"pattern"),()=>{t.multiple&&S(syncMirrorWidth)});const O=v(!1);let B=null;let P=null;function clearEnterTimer(){null!==P&&(void 0).clearTimeout(P)}b($,e=>{e||(w.value=!1)}),useOnResize(a,t.onResize);const{inlineThemeDisabled:I}=t,k=g(()=>{const{size:n}=t,{common:{cubicBezierEaseInOut:o},self:{fontWeight:r,borderRadius:l,color:i,placeholderColor:a,textColor:s,paddingSingle:d,paddingMultiple:u,caretColor:c,colorDisabled:p,textColorDisabled:h,placeholderColorDisabled:v,colorActive:f,boxShadowFocus:g,boxShadowActive:b,boxShadowHover:m,border:w,borderFocus:y,borderHover:x,borderActive:S,arrowColor:T,arrowColorDisabled:M,loadingColor:z,colorActiveWarning:$,boxShadowFocusWarning:O,boxShadowActiveWarning:R,boxShadowHoverWarning:F,borderWarning:B,borderFocusWarning:P,borderHoverWarning:I,borderActiveWarning:k,colorActiveError:A,boxShadowFocusError:E,boxShadowActiveError:L,boxShadowHoverError:j,borderError:N,borderFocusError:D,borderHoverError:H,borderActiveError:_,clearColor:V,clearColorHover:U,clearColorPressed:K,clearSize:Y,arrowSize:X,[W("height",n)]:G,[W("fontSize",n)]:q}}=C.value,Z=e(d),J=e(u);return{"--n-bezier":o,"--n-border":w,"--n-border-active":S,"--n-border-focus":y,"--n-border-hover":x,"--n-border-radius":l,"--n-box-shadow-active":b,"--n-box-shadow-focus":g,"--n-box-shadow-hover":m,"--n-caret-color":c,"--n-color":i,"--n-color-active":f,"--n-color-disabled":p,"--n-font-size":q,"--n-height":G,"--n-padding-single-top":Z.top,"--n-padding-multiple-top":J.top,"--n-padding-single-right":Z.right,"--n-padding-multiple-right":J.right,"--n-padding-single-left":Z.left,"--n-padding-multiple-left":J.left,"--n-padding-single-bottom":Z.bottom,"--n-padding-multiple-bottom":J.bottom,"--n-placeholder-color":a,"--n-placeholder-color-disabled":v,"--n-text-color":s,"--n-text-color-disabled":h,"--n-arrow-color":T,"--n-arrow-color-disabled":M,"--n-loading-color":z,"--n-color-active-warning":$,"--n-box-shadow-focus-warning":O,"--n-box-shadow-active-warning":R,"--n-box-shadow-hover-warning":F,"--n-border-warning":B,"--n-border-focus-warning":P,"--n-border-hover-warning":I,"--n-border-active-warning":k,"--n-color-active-error":A,"--n-box-shadow-focus-error":E,"--n-box-shadow-active-error":L,"--n-box-shadow-hover-error":j,"--n-border-error":N,"--n-border-focus-error":D,"--n-border-hover-error":H,"--n-border-active-error":_,"--n-clear-size":Y,"--n-clear-color":V,"--n-clear-color-hover":U,"--n-clear-color-pressed":K,"--n-arrow-size":X,"--n-font-weight":r}}),E=I?A("internal-selection",g(()=>t.size[0]),k,t):void 0;return{mergedTheme:C,mergedClearable:T,mergedClsPrefix:n,rtlEnabled:r,patternInputFocused:y,filterablePlaceholder:M,label:z,selected:$,showTagsPanel:w,isComposing:O,counterRef:c,counterWrapperRef:p,patternInputMirrorRef:l,patternInputRef:i,selfRef:a,multipleElRef:s,singleElRef:d,patternInputWrapperRef:u,overflowRef:h,inputTagElRef:m,handleMouseDown:function(e){t.active&&t.filterable&&e.target!==i.value&&e.preventDefault()},handleFocusin:function(e){var n;e.relatedTarget&&(null===(n=a.value)||void 0===n?void 0:n.contains(e.relatedTarget))||function(e){const{onFocus:n}=t;n&&n(e)}(e)},handleClear:function(e){!function(e){const{onClear:n}=t;n&&n(e)}(e)},handleMouseEnter:function(){x.value=!0},handleMouseLeave:function(){x.value=!1},handleDeleteOption:handleDeleteOption,handlePatternKeyDown:function(e){if("Backspace"===e.key&&!O.value&&!t.pattern.length){const{selectedOptions:e}=t;(null==e?void 0:e.length)&&handleDeleteOption(e[e.length-1])}},handlePatternInputInput:function(e){const{value:n}=l;if(n){const t=e.target.value;n.textContent=t,syncMirrorWidth()}t.ignoreComposition&&O.value?B=e:doPatternInput(e)},handlePatternInputBlur:function(e){var n;y.value=!1,null===(n=t.onPatternBlur)||void 0===n||n.call(t,e)},handlePatternInputFocus:function(e){var n;y.value=!0,null===(n=t.onPatternFocus)||void 0===n||n.call(t,e)},handleMouseEnterCounter:function(){t.active||(clearEnterTimer(),P=(void 0).setTimeout(()=>{$.value&&(w.value=!0)},100))},handleMouseLeaveCounter:function(){clearEnterTimer()},handleFocusout:function(e){var n;(null===(n=a.value)||void 0===n?void 0:n.contains(e.relatedTarget))||function(e){const{onBlur:n}=t;n&&n(e)}(e)},handleCompositionEnd:function(){O.value=!1,t.ignoreComposition&&doPatternInput(B),B=null},handleCompositionStart:function(){O.value=!0},onPopoverUpdateShow:function(e){e||(clearEnterTimer(),w.value=!1)},focus:function(){var e,n,o;t.filterable?(y.value=!1,null===(e=u.value)||void 0===e||e.focus()):t.multiple?null===(n=s.value)||void 0===n||n.focus():null===(o=d.value)||void 0===o||o.focus()},focusInput:function(){const{value:e}=i;e&&(!function(){const{value:e}=m;e&&(e.style.display="inline-block")}(),e.focus())},blur:function(){var e,n;if(t.filterable)y.value=!1,null===(e=u.value)||void 0===e||e.blur(),null===(n=i.value)||void 0===n||n.blur();else if(t.multiple){const{value:e}=s;null==e||e.blur()}else{const{value:e}=d;null==e||e.blur()}},blurInput:function(){const{value:e}=i;e&&e.blur()},updateCounter:function(e){const{value:t}=c;t&&t.setTextContent(`+${e}`)},getCounter:function(){const{value:e}=p;return e},getTail:function(){return i.value},renderLabel:t.renderLabel,cssVars:I?void 0:k,themeClass:null==E?void 0:E.themeClass,onRender:null==E?void 0:E.onRender}},render(){const{status:e,multiple:t,size:n,disabled:o,filterable:r,maxTagCount:l,bordered:i,clsPrefix:a,ellipsisTagPopoverProps:s,onRender:d,renderTag:c,renderLabel:p}=this;null==d||d();const h="responsive"===l,v="number"==typeof l,f=h||v,g=u(_,null,{default:()=>u(xe,{clsPrefix:a,loading:this.loading,showArrow:this.showArrow,showClear:this.mergedClearable&&this.selected,onClear:this.handleClear},{default:()=>{var e,t;return null===(t=(e=this.$slots).arrow)||void 0===t?void 0:t.call(e)}})});let b;if(t){const{labelField:e}=this,createTag=t=>u("div",{class:`${a}-base-selection-tag-wrapper`,key:t.value},c?c({option:t,handleClose:()=>{this.handleDeleteOption(t)}}):u(Ce,{size:n,closable:!t.disabled,disabled:o,onClose:()=>{this.handleDeleteOption(t)},internalCloseIsButtonTag:!1,internalCloseFocusable:!1},{default:()=>p?p(t,!0):V(t[e],t,!0)})),createOriginalTagNodes=()=>(v?this.selectedOptions.slice(0,l):this.selectedOptions).map(createTag),t=r?u("div",{class:`${a}-base-selection-input-tag`,ref:"inputTagElRef",key:"__input-tag__"},u("input",Object.assign({},this.inputProps,{ref:"patternInputRef",tabindex:-1,disabled:o,value:this.pattern,autofocus:this.autofocus,class:`${a}-base-selection-input-tag__input`,onBlur:this.handlePatternInputBlur,onFocus:this.handlePatternInputFocus,onKeydown:this.handlePatternKeyDown,onInput:this.handlePatternInputInput,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd})),u("span",{ref:"patternInputMirrorRef",class:`${a}-base-selection-input-tag__mirror`},this.pattern)):null,i=h?()=>u("div",{class:`${a}-base-selection-tag-wrapper`,ref:"counterWrapperRef"},u(Ce,{size:n,ref:"counterRef",onMouseenter:this.handleMouseEnterCounter,onMouseleave:this.handleMouseLeaveCounter,disabled:o})):void 0;let d;if(v){const e=this.selectedOptions.length-l;e>0&&(d=u("div",{class:`${a}-base-selection-tag-wrapper`,key:"__counter__"},u(Ce,{size:n,ref:"counterRef",onMouseenter:this.handleMouseEnterCounter,disabled:o},{default:()=>`+${e}`})))}const m=h?r?u(tt,{ref:"overflowRef",updateCounter:this.updateCounter,getCounter:this.getCounter,getTail:this.getTail,style:{width:"100%",display:"flex",overflow:"hidden"}},{default:createOriginalTagNodes,counter:i,tail:()=>t}):u(tt,{ref:"overflowRef",updateCounter:this.updateCounter,getCounter:this.getCounter,style:{width:"100%",display:"flex",overflow:"hidden"}},{default:createOriginalTagNodes,counter:i}):v&&d?createOriginalTagNodes().concat(d):createOriginalTagNodes(),w=f?()=>u("div",{class:`${a}-base-selection-popover`},h?createOriginalTagNodes():this.selectedOptions.map(createTag)):void 0,y=f?Object.assign({show:this.showTagsPanel,trigger:"hover",overlap:!0,placement:"top",width:"trigger",onUpdateShow:this.onPopoverUpdateShow,theme:this.mergedTheme.peers.Popover,themeOverrides:this.mergedTheme.peerOverrides.Popover},s):null,S=!this.selected&&(!this.active||!this.pattern&&!this.isComposing)?u("div",{class:`${a}-base-selection-placeholder ${a}-base-selection-overlay`},u("div",{class:`${a}-base-selection-placeholder__inner`},this.placeholder)):null,C=r?u("div",{ref:"patternInputWrapperRef",class:`${a}-base-selection-tags`},m,h?null:t,g):u("div",{ref:"multipleElRef",class:`${a}-base-selection-tags`,tabindex:o?void 0:0},m,g);b=u(x,null,f?u(zt,Object.assign({},y,{scrollable:!0,style:"max-height: calc(var(--v-target-height) * 6.6);"}),{trigger:()=>C,default:w}):C,S)}else if(r){const e=this.pattern||this.isComposing,t=this.active?!e:!this.selected,n=!this.active&&this.selected;b=u("div",{ref:"patternInputWrapperRef",class:`${a}-base-selection-label`,title:this.patternInputFocused?void 0:getTitleAttribute(this.label)},u("input",Object.assign({},this.inputProps,{ref:"patternInputRef",class:`${a}-base-selection-input`,value:this.active?this.pattern:"",placeholder:"",readonly:o,disabled:o,tabindex:-1,autofocus:this.autofocus,onFocus:this.handlePatternInputFocus,onBlur:this.handlePatternInputBlur,onInput:this.handlePatternInputInput,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd})),n?u("div",{class:`${a}-base-selection-label__render-label ${a}-base-selection-overlay`,key:"input"},u("div",{class:`${a}-base-selection-overlay__wrapper`},c?c({option:this.selectedOption,handleClose:()=>{}}):p?p(this.selectedOption,!0):V(this.label,this.selectedOption,!0))):null,t?u("div",{class:`${a}-base-selection-placeholder ${a}-base-selection-overlay`,key:"placeholder"},u("div",{class:`${a}-base-selection-overlay__wrapper`},this.filterablePlaceholder)):null,g)}else b=u("div",{ref:"singleElRef",class:`${a}-base-selection-label`,tabindex:this.disabled?void 0:0},void 0!==this.label?u("div",{class:`${a}-base-selection-input`,title:getTitleAttribute(this.label),key:"input"},u("div",{class:`${a}-base-selection-input__content`},c?c({option:this.selectedOption,handleClose:()=>{}}):p?p(this.selectedOption,!0):V(this.label,this.selectedOption,!0))):u("div",{class:`${a}-base-selection-placeholder ${a}-base-selection-overlay`,key:"placeholder"},u("div",{class:`${a}-base-selection-placeholder__inner`},this.placeholder)),g);return u("div",{ref:"selfRef",class:[`${a}-base-selection`,this.rtlEnabled&&`${a}-base-selection--rtl`,this.themeClass,e&&`${a}-base-selection--${e}-status`,{[`${a}-base-selection--active`]:this.active,[`${a}-base-selection--selected`]:this.selected||this.active&&this.pattern,[`${a}-base-selection--disabled`]:this.disabled,[`${a}-base-selection--multiple`]:this.multiple,[`${a}-base-selection--focus`]:this.focused}],style:this.cssVars,onClick:this.onClick,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onKeydown:this.onKeydown,onFocusin:this.handleFocusin,onFocusout:this.handleFocusout,onMousedown:this.handleMouseDown},b,i?u("div",{class:`${a}-base-selection__border`}):null,i?u("div",{class:`${a}-base-selection__state-border`}):null)}});function getIsGroup(e){return"group"===e.type}function getIgnored(e){return"ignored"===e.type}function patternMatched(e,t){try{return!!(1+t.toString().toLowerCase().indexOf(e.trim().toLowerCase()))}catch(e){return!1}}function createTmOptions(e,t){return{getIsGroup:getIsGroup,getIgnored:getIgnored,getKey:t=>getIsGroup(t)?t.name||t.key||"key-required":t[e],getChildren:e=>e[t]}}const Bt=B({name:"Select",common:j,peers:{InternalSelection:Ot,InternalSelectMenu:ct},self:function(e){const{boxShadow2:t}=e;return{menuBoxShadow:t}}}),Pt=P([N("select","\n z-index: auto;\n outline: none;\n width: 100%;\n position: relative;\n font-weight: var(--n-font-weight);\n "),N("select-menu","\n margin: 4px 0;\n box-shadow: var(--n-menu-box-shadow);\n ",[oe({originalTransition:"background-color .3s var(--n-bezier), box-shadow .3s var(--n-bezier)"})])]),It=d({name:"Select",props:Object.assign(Object.assign({},F.props),{to:useAdjustedTo.propTo,bordered:{type:Boolean,default:void 0},clearable:Boolean,clearFilterAfterSelect:{type:Boolean,default:!0},options:{type:Array,default:()=>[]},defaultValue:{type:[String,Number,Array],default:null},keyboard:{type:Boolean,default:!0},value:[String,Number,Array],placeholder:String,menuProps:Object,multiple:Boolean,size:String,menuSize:{type:String},filterable:Boolean,disabled:{type:Boolean,default:void 0},remote:Boolean,loading:Boolean,filter:Function,placement:{type:String,default:"bottom-start"},widthMode:{type:String,default:"trigger"},tag:Boolean,onCreate:Function,fallbackOption:{type:[Function,Boolean],default:void 0},show:{type:Boolean,default:void 0},showArrow:{type:Boolean,default:!0},maxTagCount:[Number,String],ellipsisTagPopoverProps:Object,consistentMenuWidth:{type:Boolean,default:!0},virtualScroll:{type:Boolean,default:!0},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},childrenField:{type:String,default:"children"},renderLabel:Function,renderOption:Function,renderTag:Function,"onUpdate:value":[Function,Array],inputProps:Object,nodeProps:Function,ignoreComposition:{type:Boolean,default:!0},showOnFocus:Boolean,onUpdateValue:[Function,Array],onBlur:[Function,Array],onClear:[Function,Array],onFocus:[Function,Array],onScroll:[Function,Array],onSearch:[Function,Array],onUpdateShow:[Function,Array],"onUpdate:show":[Function,Array],displayDirective:{type:String,default:"show"},resetMenuOnOptionsChange:{type:Boolean,default:!0},status:String,showCheckmark:{type:Boolean,default:!0},onChange:[Function,Array],items:Array}),slots:Object,setup(e){const{mergedClsPrefixRef:t,mergedBorderedRef:r,namespaceRef:l,inlineThemeDisabled:i}=R(e),s=F("Select","-select",Pt,Bt,e,t),d=v(e.defaultValue),u=f(e,"value"),c=we(u,d),p=v(!1),h=v(""),m=I(e,["items","options"]),w=v([]),y=v([]),x=g(()=>y.value.concat(w.value).concat(m.value)),S=g(()=>{const{filter:t}=e;if(t)return t;const{labelField:n,valueField:o}=e;return(e,t)=>{if(!t)return!1;const r=t[n];if("string"==typeof r)return patternMatched(e,r);const l=t[o];return"string"==typeof l?patternMatched(e,l):"number"==typeof l&&patternMatched(e,String(l))}}),C=g(()=>{if(e.remote)return m.value;{const{value:t}=x,{value:n}=h;return n.length&&e.filterable?function(e,t,n,o){return t?function traverse(e){if(!Array.isArray(e))return[];const r=[];for(const l of e)if(getIsGroup(l)){const e=traverse(l[o]);e.length&&r.push(Object.assign({},l,{[o]:e}))}else{if(getIgnored(l))continue;t(n,l)&&r.push(l)}return r}(e):e}(t,S.value,n,e.childrenField):t}}),T=g(()=>{const{valueField:t,childrenField:n}=e,o=createTmOptions(t,n);return a(C.value,o)}),M=g(()=>function(e,t,n){const o=new Map;return e.forEach(e=>{getIsGroup(e)?e[n].forEach(e=>{o.set(e[t],e)}):o.set(e[t],e)}),o}(x.value,e.valueField,e.childrenField)),z=v(!1),$=we(f(e,"show"),z),O=v(null),B=v(null),P=v(null),{localeRef:L}=ye("Select"),j=g(()=>{var t;return null!==(t=e.placeholder)&&void 0!==t?t:L.value.placeholder}),N=[],W=v(new Map),D=g(()=>{const{fallbackOption:t}=e;if(void 0===t){const{labelField:t,valueField:n}=e;return e=>({[t]:String(e),[n]:e})}return!1!==t&&(e=>Object.assign(t(e),{value:e}))});function getMergedOptions(t){const n=e.remote,{value:o}=W,{value:r}=M,{value:l}=D,i=[];return t.forEach(e=>{if(r.has(e))i.push(r.get(e));else if(n&&o.has(e))i.push(o.get(e));else if(l){const t=l(e);t&&i.push(t)}}),i}const H=g(()=>{if(e.multiple){const{value:e}=c;return Array.isArray(e)?getMergedOptions(e):[]}return null}),_=g(()=>{const{value:t}=c;return e.multiple||Array.isArray(t)||null===t?null:getMergedOptions([t])[0]||null}),V=k(e),{mergedSizeRef:U,mergedDisabledRef:K,mergedStatusRef:Y}=V;function doUpdateValue(t,n){const{onChange:o,"onUpdate:value":r,onUpdateValue:l}=e,{nTriggerFormChange:i,nTriggerFormInput:a}=V;o&&pe(o,t,n),l&&pe(l,t,n),r&&pe(r,t,n),d.value=t,i(),a()}function doBlur(t){const{onBlur:n}=e,{nTriggerFormBlur:o}=V;n&&pe(n,t),o()}function updateMemorizedOptions(){var t;const{remote:n,multiple:o}=e;if(n){const{value:n}=W;if(o){const{valueField:o}=e;null===(t=H.value)||void 0===t||t.forEach(e=>{n.set(e[o],e)})}else{const t=_.value;t&&n.set(t[e.valueField],t)}}}function doUpdateShow(t){const{onUpdateShow:n,"onUpdate:show":o}=e;n&&pe(n,t),o&&pe(o,t),z.value=t}function openMenu(){K.value||(doUpdateShow(!0),z.value=!0,e.filterable&&focusSelectionInput())}function closeMenu(){doUpdateShow(!1)}function handleMenuAfterLeave(){h.value="",y.value=N}const X=v(!1);function handleToggleByTmNode(e){handleToggleByOption(e.rawNode)}function handleToggleByOption(t){if(K.value)return;const{tag:n,remote:o,clearFilterAfterSelect:r,valueField:l}=e;if(n&&!o){const{value:e}=y,t=e[0]||null;if(t){const e=w.value;e.length?e.push(t):w.value=[t],y.value=N}}if(o&&W.value.set(t[l],t),e.multiple){const i=function(t){if(!Array.isArray(t))return[];if(D.value)return Array.from(t);{const{remote:n}=e,{value:o}=M;if(n){const{value:e}=W;return t.filter(t=>o.has(t)||e.has(t))}return t.filter(e=>o.has(e))}}(c.value),a=i.findIndex(e=>e===t[l]);if(~a){if(i.splice(a,1),n&&!o){const e=getCreatedOptionIndex(t[l]);~e&&(w.value.splice(e,1),r&&(h.value=""))}}else i.push(t[l]),r&&(h.value="");doUpdateValue(i,getMergedOptions(i))}else{if(n&&!o){const e=getCreatedOptionIndex(t[l]);w.value=~e?[w.value[e]]:N}focusSelection(),closeMenu(),doUpdateValue(t[l],t)}}function getCreatedOptionIndex(t){return w.value.findIndex(n=>n[e.valueField]===t)}function handleKeydown(t){var n,o,r,l,i;if(e.keyboard)switch(t.key){case" ":if(e.filterable)break;t.preventDefault();case"Enter":if(!(null===(n=O.value)||void 0===n?void 0:n.isComposing))if($.value){const t=null===(o=P.value)||void 0===o?void 0:o.getPendingTmNode();t?handleToggleByTmNode(t):e.filterable||(closeMenu(),focusSelection())}else if(openMenu(),e.tag&&X.value){const t=y.value[0];if(t){const n=t[e.valueField],{value:o}=c;e.multiple&&Array.isArray(o)&&o.includes(n)||handleToggleByOption(t)}}t.preventDefault();break;case"ArrowUp":if(t.preventDefault(),e.loading)return;$.value&&(null===(r=P.value)||void 0===r||r.prev());break;case"ArrowDown":if(t.preventDefault(),e.loading)return;$.value?null===(l=P.value)||void 0===l||l.next():openMenu();break;case"Escape":$.value&&(re(t),closeMenu()),null===(i=O.value)||void 0===i||i.focus()}else t.preventDefault()}function focusSelection(){var e;null===(e=O.value)||void 0===e||e.focus()}function focusSelectionInput(){var e;null===(e=O.value)||void 0===e||e.focusInput()}updateMemorizedOptions(),b(f(e,"options"),updateMemorizedOptions);const G={focus:()=>{var e;null===(e=O.value)||void 0===e||e.focus()},focusInput:()=>{var e;null===(e=O.value)||void 0===e||e.focusInput()},blur:()=>{var e;null===(e=O.value)||void 0===e||e.blur()},blurInput:()=>{var e;null===(e=O.value)||void 0===e||e.blurInput()}},q=g(()=>{const{self:{menuBoxShadow:e}}=s.value;return{"--n-menu-box-shadow":e}}),Z=i?A("select",void 0,q,e):void 0;return Object.assign(Object.assign({},G),{mergedStatus:Y,mergedClsPrefix:t,mergedBordered:r,namespace:l,treeMate:T,isMounted:E(),triggerRef:O,menuRef:P,pattern:h,uncontrolledShow:z,mergedShow:$,adjustedTo:useAdjustedTo(e),uncontrolledValue:d,mergedValue:c,followerRef:B,localizedPlaceholder:j,selectedOption:_,selectedOptions:H,mergedSize:U,mergedDisabled:K,focused:p,activeWithoutMenuOpen:X,inlineThemeDisabled:i,onTriggerInputFocus:function(){e.filterable&&(X.value=!0)},onTriggerInputBlur:function(){e.filterable&&(X.value=!1,$.value||handleMenuAfterLeave())},handleTriggerOrMenuResize:function(){var e;$.value&&(null===(e=B.value)||void 0===e||e.syncPosition())},handleMenuFocus:function(){p.value=!0},handleMenuBlur:function(e){var t;(null===(t=O.value)||void 0===t?void 0:t.$el.contains(e.relatedTarget))||(p.value=!1,doBlur(e),closeMenu())},handleMenuTabOut:function(){var e;null===(e=O.value)||void 0===e||e.focus(),closeMenu()},handleTriggerClick:function(){K.value||($.value?e.filterable?focusSelectionInput():closeMenu():openMenu())},handleToggle:handleToggleByTmNode,handleDeleteOption:handleToggleByOption,handlePatternInput:function(t){$.value||openMenu();const{value:n}=t.target;h.value=n;const{tag:o,remote:r}=e;if(function(t){const{onSearch:n}=e;n&&pe(n,t)}(n),o&&!r){if(!n)return void(y.value=N);const{onCreate:t}=e,o=t?t(n):{[e.labelField]:n,[e.valueField]:n},{valueField:r,labelField:l}=e;m.value.some(e=>e[r]===o[r]||e[l]===o[l])||w.value.some(e=>e[r]===o[r]||e[l]===o[l])?y.value=N:y.value=[o]}},handleClear:function(t){t.stopPropagation();const{multiple:n}=e;!n&&e.filterable&&closeMenu(),function(){const{onClear:t}=e;t&&pe(t)}(),n?doUpdateValue([],[]):doUpdateValue(null,null)},handleTriggerBlur:function(e){var t,n;(null===(n=null===(t=P.value)||void 0===t?void 0:t.selfRef)||void 0===n?void 0:n.contains(e.relatedTarget))||(p.value=!1,doBlur(e),closeMenu())},handleTriggerFocus:function(t){!function(t){const{onFocus:n,showOnFocus:o}=e,{nTriggerFormFocus:r}=V;n&&pe(n,t),r(),o&&openMenu()}(t),p.value=!0},handleKeydown:handleKeydown,handleMenuAfterLeave:handleMenuAfterLeave,handleMenuClickOutside:function(e){var t;$.value&&((null===(t=O.value)||void 0===t?void 0:t.$el.contains(o(e)))||closeMenu())},handleMenuScroll:function(t){!function(t){const{onScroll:n}=e;n&&pe(n,t)}(t)},handleMenuKeydown:handleKeydown,handleMenuMousedown:function(e){n(e,"action")||n(e,"empty")||n(e,"header")||e.preventDefault()},mergedTheme:s,cssVars:i?void 0:q,themeClass:null==Z?void 0:Z.themeClass,onRender:null==Z?void 0:Z.onRender})},render(){return u("div",{class:`${this.mergedClsPrefix}-select`},u(Pe,null,{default:()=>[u(Ie,null,{default:()=>u(Ft,{ref:"triggerRef",inlineThemeDisabled:this.inlineThemeDisabled,status:this.mergedStatus,inputProps:this.inputProps,clsPrefix:this.mergedClsPrefix,showArrow:this.showArrow,maxTagCount:this.maxTagCount,ellipsisTagPopoverProps:this.ellipsisTagPopoverProps,bordered:this.mergedBordered,active:this.activeWithoutMenuOpen||this.mergedShow,pattern:this.pattern,placeholder:this.localizedPlaceholder,selectedOption:this.selectedOption,selectedOptions:this.selectedOptions,multiple:this.multiple,renderTag:this.renderTag,renderLabel:this.renderLabel,filterable:this.filterable,clearable:this.clearable,disabled:this.mergedDisabled,size:this.mergedSize,theme:this.mergedTheme.peers.InternalSelection,labelField:this.labelField,valueField:this.valueField,themeOverrides:this.mergedTheme.peerOverrides.InternalSelection,loading:this.loading,focused:this.focused,onClick:this.handleTriggerClick,onDeleteOption:this.handleDeleteOption,onPatternInput:this.handlePatternInput,onClear:this.handleClear,onBlur:this.handleTriggerBlur,onFocus:this.handleTriggerFocus,onKeydown:this.handleKeydown,onPatternBlur:this.onTriggerInputBlur,onPatternFocus:this.onTriggerInputFocus,onResize:this.handleTriggerOrMenuResize,ignoreComposition:this.ignoreComposition},{arrow:()=>{var e,t;return[null===(t=(e=this.$slots).arrow)||void 0===t?void 0:t.call(e)]}})}),u(Ye,{ref:"followerRef",show:this.mergedShow,to:this.adjustedTo,teleportDisabled:this.adjustedTo===useAdjustedTo.tdkey,containerClass:this.namespace,width:this.consistentMenuWidth?"target":void 0,minWidth:"target",placement:this.placement},{default:()=>u(c,{name:"fade-in-scale-up-transition",appear:this.isMounted,onAfterLeave:this.handleMenuAfterLeave},{default:()=>{var e,t,n;return this.mergedShow||"show"===this.displayDirective?(null===(e=this.onRender)||void 0===e||e.call(this),p(u(ft,Object.assign({},this.menuProps,{ref:"menuRef",onResize:this.handleTriggerOrMenuResize,inlineThemeDisabled:this.inlineThemeDisabled,virtualScroll:this.consistentMenuWidth&&this.virtualScroll,class:[`${this.mergedClsPrefix}-select-menu`,this.themeClass,null===(t=this.menuProps)||void 0===t?void 0:t.class],clsPrefix:this.mergedClsPrefix,focusable:!0,labelField:this.labelField,valueField:this.valueField,autoPending:!0,nodeProps:this.nodeProps,theme:this.mergedTheme.peers.InternalSelectMenu,themeOverrides:this.mergedTheme.peerOverrides.InternalSelectMenu,treeMate:this.treeMate,multiple:this.multiple,size:this.menuSize,renderOption:this.renderOption,renderLabel:this.renderLabel,value:this.mergedValue,style:[null===(n=this.menuProps)||void 0===n?void 0:n.style,this.cssVars],onToggle:this.handleToggle,onScroll:this.handleMenuScroll,onFocus:this.handleMenuFocus,onBlur:this.handleMenuBlur,onKeydown:this.handleMenuKeydown,onTabOut:this.handleMenuTabOut,onMousedown:this.handleMenuMousedown,show:this.mergedShow,showCheckmark:this.showCheckmark,resetMenuOnOptionsChange:this.resetMenuOnOptionsChange}),{empty:()=>{var e,t;return[null===(t=(e=this.$slots).empty)||void 0===t?void 0:t.call(e)]},header:()=>{var e,t;return[null===(t=(e=this.$slots).header)||void 0===t?void 0:t.call(e)]},action:()=>{var e,t;return[null===(t=(e=this.$slots).action)||void 0===t?void 0:t.call(e)]}}),"show"===this.displayDirective?[[h,this.mergedShow],[O,this.handleMenuClickOutside,void 0,{capture:!0}]]:[[O,this.handleMenuClickOutside,void 0,{capture:!0}]])):null}})})]}))}});export{Pe as B,It as N,Ie as V,Ye as a,dt as b,Je as c,zt as d,at as e,Mt as f,ft as g,createTmOptions as h,ct as i,mergeEventHandlers as m,bt as p,renderArrow as r,Bt as s,useAdjustedTo as u};
//# sourceMappingURL=Select-C0U9uRTf.mjs.map
