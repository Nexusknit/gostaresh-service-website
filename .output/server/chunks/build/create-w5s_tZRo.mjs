import{_ as e}from"./nuxt-link-DlD_4d-2.mjs";import{defineComponent as a,ref as l,computed as u,mergeProps as t,withCtx as o,createTextVNode as n,unref as r,createVNode as v,useSSRContext as i}from"vue";import{ssrRenderAttrs as p,ssrRenderComponent as s}from"vue/server-renderer";import{d}from"./api-qvnChiK5.mjs";import{N as c,C as m,F as f}from"./server.mjs";import{u as b}from"./use-message-DH0YWJK4.mjs";import{N as g,a as D}from"./FormItem-Ds_MAETL.mjs";import{N as U}from"./Input-DBNoyZOz.mjs";import{N as h}from"./Select-C0U9uRTf.mjs";import{N as y}from"./Switch-DTUH-ntq.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:url";import"@iconify/utils";import"node:crypto";import"consola";import"node:path";import"pinia";import"vue-router";import"@iconify/vue";import"@css-render/vue3-ssr";import"seemly";import"@css-render/plugin-bem";import"css-render";import"lodash-es";import"evtd";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/plugins";import"unhead/utils";import"async-validator";import"date-fns/locale";import"treemate";import"./Tag-BJGgCXYj.mjs";import"@juggle/resize-observer";const I=a({__name:"create",__ssrInlineRender:!0,setup(a){const i=b(),I=l(null),_=l({name:"",slug:"",shortDescription:"",longDescription:"",price:0,brandID:"",categoryID:"",statusID:"",isActive:!0}),x=l(!1),S=l([]),j=l([]),A=l([]),w=u(()=>S.value.map(e=>({label:e.name||e.slug||e.id,value:e.id}))),k=u(()=>j.value.map(e=>({label:e.name||e.slug||e.id,value:e.id}))),C=u(()=>A.value.map(e=>({label:e.name||e.title||e.id||String(e),value:e.id||e.value||String(e)}))),N=u({get:()=>_.value.price?String(_.value.price):"",set:e=>_.value.price=Number(e.replace(/[^\d]/g,""))||0}),B={name:{required:!0,message:"نام الزامی است",trigger:"blur"},price:{required:!0,message:"قیمت الزامی است",trigger:"blur"}};async function ensureSlug(){if(_.value.name&&!_.value.slug)try{const{slug:e}=await $apiFetch("/utils/slug/preview",{method:"POST",body:{model:"product",source:_.value.name}});e&&(_.value.slug=e)}catch{}}async function onSubmit(){try{await(I.value?.validate())}catch{return}x.value=!0;try{await d("products",{name:_.value.name,shortDescription:_.value.shortDescription||void 0,longDescription:_.value.longDescription||void 0,price:_.value.price,statusID:_.value.statusID||void 0,brandID:_.value.brandID||void 0,categoryID:_.value.categoryID||void 0,slug:_.value.slug||void 0,isActive:_.value.isActive}),i.success("محصول افزوده شد"),f("/admin/products")}catch(e){i.error(e?.data?.message||"خطا در ثبت")}finally{x.value=!1}}return(a,l,u,i)=>{const d=e;l(`<section${p(t({class:"container mx-auto px-4 py-8",dir:"rtl"},i))}><div class="mb-5 flex items-center justify-between gap-3"><h1 class="text-xl font-bold">افزودن محصول</h1>`),l(s(d,{to:"/admin/products",class:"text-sky-600 hover:underline text-sm"},{default:o((e,a,l,u)=>{if(!a)return[n("بازگشت")];a("بازگشت")}),_:1},u)),l("</div>"),l(s(r(c),{class:"rounded-2xl ring-1 ring-slate-200/80 shadow-sm",bordered:!1},{default:o((e,a,l,u)=>{if(!a)return[v(r(g),{model:_.value,rules:B,ref_key:"formRef",ref:I,"label-placement":"left","label-width":"140"},{default:o(()=>[v(r(D),{label:"نام",path:"name"},{default:o(()=>[v(r(U),{value:_.value.name,"onUpdate:value":e=>_.value.name=e,onBlur:ensureSlug},null,8,["value","onUpdate:value"])]),_:1}),v(r(D),{label:"اسلاگ",path:"slug"},{default:o(()=>[v(r(U),{value:_.value.slug,"onUpdate:value":e=>_.value.slug=e},null,8,["value","onUpdate:value"])]),_:1}),v(r(D),{label:"خلاصه",path:"shortDescription"},{default:o(()=>[v(r(U),{value:_.value.shortDescription,"onUpdate:value":e=>_.value.shortDescription=e,type:"textarea"},null,8,["value","onUpdate:value"])]),_:1}),v(r(D),{label:"توضیح کامل",path:"longDescription"},{default:o(()=>[v(r(U),{value:_.value.longDescription,"onUpdate:value":e=>_.value.longDescription=e,type:"textarea"},null,8,["value","onUpdate:value"])]),_:1}),v(r(D),{label:"قیمت (تومان)",path:"price"},{default:o(()=>[v(r(U),{value:N.value,"onUpdate:value":e=>N.value=e,placeholder:"مثلاً 1200000"},null,8,["value","onUpdate:value"])]),_:1}),v(r(D),{label:"برند",path:"brandID"},{default:o(()=>[v(r(h),{value:_.value.brandID,"onUpdate:value":e=>_.value.brandID=e,options:w.value,filterable:"",clearable:""},null,8,["value","onUpdate:value","options"])]),_:1}),v(r(D),{label:"دسته‌بندی",path:"categoryID"},{default:o(()=>[v(r(h),{value:_.value.categoryID,"onUpdate:value":e=>_.value.categoryID=e,options:k.value,filterable:"",clearable:""},null,8,["value","onUpdate:value","options"])]),_:1}),v(r(D),{label:"وضعیت",path:"statusID"},{default:o(()=>[v(r(h),{value:_.value.statusID,"onUpdate:value":e=>_.value.statusID=e,options:C.value,filterable:"",clearable:""},null,8,["value","onUpdate:value","options"])]),_:1}),v(r(D),{label:"فعال"},{default:o(()=>[v(r(y),{value:_.value.isActive,"onUpdate:value":e=>_.value.isActive=e},null,8,["value","onUpdate:value"])]),_:1}),v("div",{class:"pt-2"},[v(r(m),{type:"primary",loading:x.value,onClick:onSubmit},{default:o(()=>[n("ثبت")]),_:1},8,["loading"])])]),_:1},8,["model"])];a(s(r(g),{model:_.value,rules:B,ref_key:"formRef",ref:I,"label-placement":"left","label-width":"140"},{default:o((e,a,l,u)=>{if(!a)return[v(r(D),{label:"نام",path:"name"},{default:o(()=>[v(r(U),{value:_.value.name,"onUpdate:value":e=>_.value.name=e,onBlur:ensureSlug},null,8,["value","onUpdate:value"])]),_:1}),v(r(D),{label:"اسلاگ",path:"slug"},{default:o(()=>[v(r(U),{value:_.value.slug,"onUpdate:value":e=>_.value.slug=e},null,8,["value","onUpdate:value"])]),_:1}),v(r(D),{label:"خلاصه",path:"shortDescription"},{default:o(()=>[v(r(U),{value:_.value.shortDescription,"onUpdate:value":e=>_.value.shortDescription=e,type:"textarea"},null,8,["value","onUpdate:value"])]),_:1}),v(r(D),{label:"توضیح کامل",path:"longDescription"},{default:o(()=>[v(r(U),{value:_.value.longDescription,"onUpdate:value":e=>_.value.longDescription=e,type:"textarea"},null,8,["value","onUpdate:value"])]),_:1}),v(r(D),{label:"قیمت (تومان)",path:"price"},{default:o(()=>[v(r(U),{value:N.value,"onUpdate:value":e=>N.value=e,placeholder:"مثلاً 1200000"},null,8,["value","onUpdate:value"])]),_:1}),v(r(D),{label:"برند",path:"brandID"},{default:o(()=>[v(r(h),{value:_.value.brandID,"onUpdate:value":e=>_.value.brandID=e,options:w.value,filterable:"",clearable:""},null,8,["value","onUpdate:value","options"])]),_:1}),v(r(D),{label:"دسته‌بندی",path:"categoryID"},{default:o(()=>[v(r(h),{value:_.value.categoryID,"onUpdate:value":e=>_.value.categoryID=e,options:k.value,filterable:"",clearable:""},null,8,["value","onUpdate:value","options"])]),_:1}),v(r(D),{label:"وضعیت",path:"statusID"},{default:o(()=>[v(r(h),{value:_.value.statusID,"onUpdate:value":e=>_.value.statusID=e,options:C.value,filterable:"",clearable:""},null,8,["value","onUpdate:value","options"])]),_:1}),v(r(D),{label:"فعال"},{default:o(()=>[v(r(y),{value:_.value.isActive,"onUpdate:value":e=>_.value.isActive=e},null,8,["value","onUpdate:value"])]),_:1}),v("div",{class:"pt-2"},[v(r(m),{type:"primary",loading:x.value,onClick:onSubmit},{default:o(()=>[n("ثبت")]),_:1},8,["loading"])])];a(s(r(D),{label:"نام",path:"name"},{default:o((e,a,l,u)=>{if(!a)return[v(r(U),{value:_.value.name,"onUpdate:value":e=>_.value.name=e,onBlur:ensureSlug},null,8,["value","onUpdate:value"])];a(s(r(U),{value:_.value.name,"onUpdate:value":e=>_.value.name=e,onBlur:ensureSlug},null,l,u))}),_:1},l,u)),a(s(r(D),{label:"اسلاگ",path:"slug"},{default:o((e,a,l,u)=>{if(!a)return[v(r(U),{value:_.value.slug,"onUpdate:value":e=>_.value.slug=e},null,8,["value","onUpdate:value"])];a(s(r(U),{value:_.value.slug,"onUpdate:value":e=>_.value.slug=e},null,l,u))}),_:1},l,u)),a(s(r(D),{label:"خلاصه",path:"shortDescription"},{default:o((e,a,l,u)=>{if(!a)return[v(r(U),{value:_.value.shortDescription,"onUpdate:value":e=>_.value.shortDescription=e,type:"textarea"},null,8,["value","onUpdate:value"])];a(s(r(U),{value:_.value.shortDescription,"onUpdate:value":e=>_.value.shortDescription=e,type:"textarea"},null,l,u))}),_:1},l,u)),a(s(r(D),{label:"توضیح کامل",path:"longDescription"},{default:o((e,a,l,u)=>{if(!a)return[v(r(U),{value:_.value.longDescription,"onUpdate:value":e=>_.value.longDescription=e,type:"textarea"},null,8,["value","onUpdate:value"])];a(s(r(U),{value:_.value.longDescription,"onUpdate:value":e=>_.value.longDescription=e,type:"textarea"},null,l,u))}),_:1},l,u)),a(s(r(D),{label:"قیمت (تومان)",path:"price"},{default:o((e,a,l,u)=>{if(!a)return[v(r(U),{value:N.value,"onUpdate:value":e=>N.value=e,placeholder:"مثلاً 1200000"},null,8,["value","onUpdate:value"])];a(s(r(U),{value:N.value,"onUpdate:value":e=>N.value=e,placeholder:"مثلاً 1200000"},null,l,u))}),_:1},l,u)),a(s(r(D),{label:"برند",path:"brandID"},{default:o((e,a,l,u)=>{if(!a)return[v(r(h),{value:_.value.brandID,"onUpdate:value":e=>_.value.brandID=e,options:w.value,filterable:"",clearable:""},null,8,["value","onUpdate:value","options"])];a(s(r(h),{value:_.value.brandID,"onUpdate:value":e=>_.value.brandID=e,options:w.value,filterable:"",clearable:""},null,l,u))}),_:1},l,u)),a(s(r(D),{label:"دسته‌بندی",path:"categoryID"},{default:o((e,a,l,u)=>{if(!a)return[v(r(h),{value:_.value.categoryID,"onUpdate:value":e=>_.value.categoryID=e,options:k.value,filterable:"",clearable:""},null,8,["value","onUpdate:value","options"])];a(s(r(h),{value:_.value.categoryID,"onUpdate:value":e=>_.value.categoryID=e,options:k.value,filterable:"",clearable:""},null,l,u))}),_:1},l,u)),a(s(r(D),{label:"وضعیت",path:"statusID"},{default:o((e,a,l,u)=>{if(!a)return[v(r(h),{value:_.value.statusID,"onUpdate:value":e=>_.value.statusID=e,options:C.value,filterable:"",clearable:""},null,8,["value","onUpdate:value","options"])];a(s(r(h),{value:_.value.statusID,"onUpdate:value":e=>_.value.statusID=e,options:C.value,filterable:"",clearable:""},null,l,u))}),_:1},l,u)),a(s(r(D),{label:"فعال"},{default:o((e,a,l,u)=>{if(!a)return[v(r(y),{value:_.value.isActive,"onUpdate:value":e=>_.value.isActive=e},null,8,["value","onUpdate:value"])];a(s(r(y),{value:_.value.isActive,"onUpdate:value":e=>_.value.isActive=e},null,l,u))}),_:1},l,u)),a(`<div class="pt-2"${u}>`),a(s(r(m),{type:"primary",loading:x.value,onClick:onSubmit},{default:o((e,a,l,u)=>{if(!a)return[n("ثبت")];a("ثبت")}),_:1},l,u)),a("</div>")}),_:1},l,u))}),_:1},u)),l("</section>")}}}),_=I.setup;I.setup=(e,a)=>{const l=i();return(l.modules||(l.modules=new Set)).add("pages/admin/products/create.vue"),_?_(e,a):void 0};export{I as default};
//# sourceMappingURL=create-w5s_tZRo.mjs.map
