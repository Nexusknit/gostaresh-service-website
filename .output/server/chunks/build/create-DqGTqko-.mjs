import{_ as e}from"./nuxt-link-DlD_4d-2.mjs";import{defineComponent as l,ref as t,computed as a,mergeProps as u,withCtx as n,createTextVNode as o,unref as r,createVNode as v,useSSRContext as i}from"vue";import{ssrRenderAttrs as s,ssrRenderComponent as p}from"vue/server-renderer";import{d}from"./api-qvnChiK5.mjs";import{N as m,C as c,F as f}from"./server.mjs";import{u as g}from"./use-message-DH0YWJK4.mjs";import{N as h,a as y}from"./FormItem-Ds_MAETL.mjs";import{N as b}from"./Input-DBNoyZOz.mjs";import{N as U}from"./Select-C0U9uRTf.mjs";import{N as C}from"./Switch-DTUH-ntq.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:url";import"@iconify/utils";import"node:crypto";import"consola";import"node:path";import"pinia";import"vue-router";import"@iconify/vue";import"@css-render/vue3-ssr";import"seemly";import"@css-render/plugin-bem";import"css-render";import"lodash-es";import"evtd";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/plugins";import"unhead/utils";import"async-validator";import"date-fns/locale";import"treemate";import"./Tag-BJGgCXYj.mjs";import"@juggle/resize-observer";const _=l({__name:"create",__ssrInlineRender:!0,setup(l){const i=g(),_=t(null),D=t({title:"",slug:"",articleTypeID:"",shortContent:"",longContent:"",isActive:!0}),T=t(!1),x=t([]),I=a(()=>x.value.map(e=>({label:e.name||e.id,value:e.id}))),j={title:{required:!0,message:"عنوان الزامی است",trigger:"blur"}};async function ensureSlug(){if(D.value.title&&!D.value.slug)try{const{slug:e}=await $apiFetch("/utils/slug/preview",{method:"POST",body:{model:"article",source:D.value.title}});e&&(D.value.slug=e)}catch{}}async function onSubmit(){try{await(_.value?.validate())}catch{return}T.value=!0;try{await d("articles",{title:D.value.title,articleTypeID:D.value.articleTypeID||void 0,shortContent:D.value.shortContent||void 0,longContent:D.value.longContent||void 0,slug:D.value.slug||void 0,isActive:D.value.isActive}),i.success("مقاله افزوده شد"),f("/admin/articles")}catch(e){i.error(e?.data?.message||"خطا در ثبت")}finally{T.value=!1}}return(l,t,a,i)=>{const d=e;t(`<section${s(u({class:"container mx-auto px-4 py-8",dir:"rtl"},i))}><div class="mb-5 flex items-center justify-between gap-3"><h1 class="text-xl font-bold">افزودن مقاله</h1>`),t(p(d,{to:"/admin/articles",class:"text-sky-600 hover:underline text-sm"},{default:n((e,l,t,a)=>{if(!l)return[o("بازگشت")];l("بازگشت")}),_:1},a)),t("</div>"),t(p(r(m),{class:"rounded-2xl ring-1 ring-slate-200/80 shadow-sm",bordered:!1},{default:n((e,l,t,a)=>{if(!l)return[v(r(h),{model:D.value,rules:j,ref_key:"formRef",ref:_,"label-placement":"left","label-width":"140"},{default:n(()=>[v(r(y),{label:"عنوان",path:"title"},{default:n(()=>[v(r(b),{value:D.value.title,"onUpdate:value":e=>D.value.title=e,onBlur:ensureSlug},null,8,["value","onUpdate:value"])]),_:1}),v(r(y),{label:"اسلاگ",path:"slug"},{default:n(()=>[v(r(b),{value:D.value.slug,"onUpdate:value":e=>D.value.slug=e},null,8,["value","onUpdate:value"])]),_:1}),v(r(y),{label:"نوع",path:"articleTypeID"},{default:n(()=>[v(r(U),{value:D.value.articleTypeID,"onUpdate:value":e=>D.value.articleTypeID=e,options:I.value,filterable:"",clearable:""},null,8,["value","onUpdate:value","options"])]),_:1}),v(r(y),{label:"خلاصه",path:"shortContent"},{default:n(()=>[v(r(b),{value:D.value.shortContent,"onUpdate:value":e=>D.value.shortContent=e,type:"textarea"},null,8,["value","onUpdate:value"])]),_:1}),v(r(y),{label:"متن کامل",path:"longContent"},{default:n(()=>[v(r(b),{value:D.value.longContent,"onUpdate:value":e=>D.value.longContent=e,type:"textarea"},null,8,["value","onUpdate:value"])]),_:1}),v(r(y),{label:"فعال"},{default:n(()=>[v(r(C),{value:D.value.isActive,"onUpdate:value":e=>D.value.isActive=e},null,8,["value","onUpdate:value"])]),_:1}),v("div",{class:"pt-2"},[v(r(c),{type:"primary",loading:T.value,onClick:onSubmit},{default:n(()=>[o("ثبت")]),_:1},8,["loading"])])]),_:1},8,["model"])];l(p(r(h),{model:D.value,rules:j,ref_key:"formRef",ref:_,"label-placement":"left","label-width":"140"},{default:n((e,l,t,a)=>{if(!l)return[v(r(y),{label:"عنوان",path:"title"},{default:n(()=>[v(r(b),{value:D.value.title,"onUpdate:value":e=>D.value.title=e,onBlur:ensureSlug},null,8,["value","onUpdate:value"])]),_:1}),v(r(y),{label:"اسلاگ",path:"slug"},{default:n(()=>[v(r(b),{value:D.value.slug,"onUpdate:value":e=>D.value.slug=e},null,8,["value","onUpdate:value"])]),_:1}),v(r(y),{label:"نوع",path:"articleTypeID"},{default:n(()=>[v(r(U),{value:D.value.articleTypeID,"onUpdate:value":e=>D.value.articleTypeID=e,options:I.value,filterable:"",clearable:""},null,8,["value","onUpdate:value","options"])]),_:1}),v(r(y),{label:"خلاصه",path:"shortContent"},{default:n(()=>[v(r(b),{value:D.value.shortContent,"onUpdate:value":e=>D.value.shortContent=e,type:"textarea"},null,8,["value","onUpdate:value"])]),_:1}),v(r(y),{label:"متن کامل",path:"longContent"},{default:n(()=>[v(r(b),{value:D.value.longContent,"onUpdate:value":e=>D.value.longContent=e,type:"textarea"},null,8,["value","onUpdate:value"])]),_:1}),v(r(y),{label:"فعال"},{default:n(()=>[v(r(C),{value:D.value.isActive,"onUpdate:value":e=>D.value.isActive=e},null,8,["value","onUpdate:value"])]),_:1}),v("div",{class:"pt-2"},[v(r(c),{type:"primary",loading:T.value,onClick:onSubmit},{default:n(()=>[o("ثبت")]),_:1},8,["loading"])])];l(p(r(y),{label:"عنوان",path:"title"},{default:n((e,l,t,a)=>{if(!l)return[v(r(b),{value:D.value.title,"onUpdate:value":e=>D.value.title=e,onBlur:ensureSlug},null,8,["value","onUpdate:value"])];l(p(r(b),{value:D.value.title,"onUpdate:value":e=>D.value.title=e,onBlur:ensureSlug},null,t,a))}),_:1},t,a)),l(p(r(y),{label:"اسلاگ",path:"slug"},{default:n((e,l,t,a)=>{if(!l)return[v(r(b),{value:D.value.slug,"onUpdate:value":e=>D.value.slug=e},null,8,["value","onUpdate:value"])];l(p(r(b),{value:D.value.slug,"onUpdate:value":e=>D.value.slug=e},null,t,a))}),_:1},t,a)),l(p(r(y),{label:"نوع",path:"articleTypeID"},{default:n((e,l,t,a)=>{if(!l)return[v(r(U),{value:D.value.articleTypeID,"onUpdate:value":e=>D.value.articleTypeID=e,options:I.value,filterable:"",clearable:""},null,8,["value","onUpdate:value","options"])];l(p(r(U),{value:D.value.articleTypeID,"onUpdate:value":e=>D.value.articleTypeID=e,options:I.value,filterable:"",clearable:""},null,t,a))}),_:1},t,a)),l(p(r(y),{label:"خلاصه",path:"shortContent"},{default:n((e,l,t,a)=>{if(!l)return[v(r(b),{value:D.value.shortContent,"onUpdate:value":e=>D.value.shortContent=e,type:"textarea"},null,8,["value","onUpdate:value"])];l(p(r(b),{value:D.value.shortContent,"onUpdate:value":e=>D.value.shortContent=e,type:"textarea"},null,t,a))}),_:1},t,a)),l(p(r(y),{label:"متن کامل",path:"longContent"},{default:n((e,l,t,a)=>{if(!l)return[v(r(b),{value:D.value.longContent,"onUpdate:value":e=>D.value.longContent=e,type:"textarea"},null,8,["value","onUpdate:value"])];l(p(r(b),{value:D.value.longContent,"onUpdate:value":e=>D.value.longContent=e,type:"textarea"},null,t,a))}),_:1},t,a)),l(p(r(y),{label:"فعال"},{default:n((e,l,t,a)=>{if(!l)return[v(r(C),{value:D.value.isActive,"onUpdate:value":e=>D.value.isActive=e},null,8,["value","onUpdate:value"])];l(p(r(C),{value:D.value.isActive,"onUpdate:value":e=>D.value.isActive=e},null,t,a))}),_:1},t,a)),l(`<div class="pt-2"${a}>`),l(p(r(c),{type:"primary",loading:T.value,onClick:onSubmit},{default:n((e,l,t,a)=>{if(!l)return[o("ثبت")];l("ثبت")}),_:1},t,a)),l("</div>")}),_:1},t,a))}),_:1},a)),t("</section>")}}}),D=_.setup;_.setup=(e,l)=>{const t=i();return(t.modules||(t.modules=new Set)).add("pages/admin/articles/create.vue"),D?D(e,l):void 0};export{_ as default};
//# sourceMappingURL=create-DqGTqko-.mjs.map
